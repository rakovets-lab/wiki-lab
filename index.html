<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Wiki for lab</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Wiki for lab</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_architecture">1. Architecture</a>
<ul class="sectlevel2">
<li><a href="#_консольное_приложение">1.1. Консольное приложение</a></li>
<li><a href="#_client_server_architecture">1.2. Client-Server Architecture</a></li>
<li><a href="#_n_tier_architecture">1.3. N-tier Architecture</a></li>
</ul>
</li>
<li><a href="#_java">2. Java</a>
<ul class="sectlevel2">
<li><a href="#_generics">2.1. Generics</a></li>
<li><a href="#_java_tools">2.2. Java: Tools</a></li>
</ul>
</li>
<li><a href="#_sql">3. SQL</a>
<ul class="sectlevel2">
<li><a href="#_основные_понятия_sql">3.1. Основные понятия SQL</a></li>
<li><a href="#_манипуляция_данными">3.2. Манипуляция данными</a></li>
<li><a href="#_многотабличные_базы_данных">3.3. Многотабличные базы данных</a></li>
<li><a href="#_агрегатные_функции_и_группировка">3.4. Агрегатные функции и группировка</a></li>
<li><a href="#_проектирование_баз_данных">3.5. Проектирование баз данных</a></li>
<li><a href="#_продвинутый_sql">3.6. Продвинутый SQL</a></li>
<li><a href="#_объекты_бд">3.7. Объекты БД</a></li>
</ul>
</li>
<li><a href="#_java_2">4. Java</a>
<ul class="sectlevel2">
<li><a href="#_github_keys">4.1. GitHub keys</a></li>
<li><a href="#_liquibase">4.2. Liquibase</a></li>
<li><a href="#_тестирование">4.3. Тестирование</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Wiki for lab.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">1. Architecture</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_консольное_приложение">1.1. Консольное приложение</h3>
<div class="paragraph">
<p><strong>Консольное приложение</strong> - это компьютерное приложение без графического интерфейса пользователя (<strong>GUI</strong>), предназначенное для работы исключительно с командами клавиатуры через текстовый компьютерный интерфейс. Многие ранние операционные системы работали исключительно в таких режимах, и только позже компании начали разрабатывать операционные системы с графическим интерфейсом для простоты использования. Можно запустить консольное приложение без графического интерфейса или запустить операционную систему в режиме консоли по диагностическим и другим причинам.</p>
</div>
<div class="paragraph">
<p>В консольном приложении пользователь выдает команды через клавиатуру, в отличие от приложений с графическим интерфейсом пользователя, которые обычно требуют использования мыши или другого указывающее устройство. Можно запустить приложение, чтобы участвовать в различных действиях, и результат будет отображаться на консоли. Программа способна извлекать и редактировать файлы, печатать, передавать данные, массово удалять и выполнять другие функции. Многие приложения, работающие в фоновом режиме в операционной системе, работают в режиме консоли, поскольку пользователю не нужно взаимодействовать с ними, за исключением редких случаев.</p>
</div>
<div class="paragraph">
<p><strong>Текстовый интерфейс пользователя</strong> (англ. <strong>Text user interface</strong>, <strong>TUI</strong>; также <strong>Character User Interface</strong>, <strong>CUI</strong>) — система средств взаимодействия пользователя с компьютером, основанная на использовании текстового (буквенно-цифрового) режима дисплея или аналогичных устройств — например, командная строка. Приложения, использующие текстовый интерфейс, называют консольными программами.</p>
</div>
<div class="paragraph">
<p>В простейшем случае консольная программа использует интерфейс командной строки, однако многие из таких программ с помощью управляющих последовательностей терминалов создают более дружественный интерфейс, приближающийся к графическому.</p>
</div>
<div class="paragraph">
<p>В Windows командная строка является примером консольного приложения. Пользователь может открыть командную строку для редактирования системных файлов и для других целей. Когда он вводит команды, они прокручивают экран вверх вместе с ответами из приложения.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>терминал <strong>Linux</strong>
<span class="image"><img src="../assets/img/application-architecture/console-application/terminal-linux.png" alt="terminal linux"></span></p>
</li>
<li>
<p>командная строка <strong>Windows</strong>
<span class="image"><img src="../assets/img/application-architecture/console-application/terminal-windows.png" alt="terminal windows"></span></p>
</li>
<li>
<p>терминал <strong>macOS</strong>
<span class="image"><img src="../assets/img/application-architecture/console-application/terminal-mac-os.png" alt="terminal mac os"></span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Преимущества консольных приложений:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Более скромные требования к ресурсам по сравнению с другими видами интерфейсов.</p>
</li>
<li>
<p>При большом наборе возможных команд опытные пользователи могут работать с приложением быстрее, чем с системой меню</p>
</li>
<li>
<p><strong>Основным преимуществом</strong> является то, что <strong>консольные приложения</strong> дают возможность использовать себя в скриптах для автоматизации (рутинных) действий.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_стандартные_потоки">1.1.1. Стандартные потоки</h4>
<div class="paragraph">
<p>Говоря про <strong>консольные приложения</strong> стоит знать о <strong>стандартных потоках</strong> ввода/вывода данных.</p>
</div>
<div class="paragraph">
<p><strong>Стандартные потоки ввода/вывода</strong> в системах типа <strong>UNIX</strong> (и некоторых других) — потоки процесса, имеющие номер (<strong>дескриптор</strong>), зарезервированный для выполнения некоторых <strong>«стандартных»</strong> функций. Как правило(хотя и не обязательно), эти дескрипторы открыты уже в момент запуска задачи (исполняемого файла).</p>
</div>
<div class="paragraph">
<p>Существует три стандартных потока ввода/вывода данных:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>стандартный поток ввода <strong>standard input</strong> (<strong>stdin</strong>);</p>
</li>
<li>
<p>стандартный поток вывода <strong>standard output</strong> (<strong>stdout</strong>);</p>
</li>
<li>
<p>стандартный поток ошибок <strong>standard error</strong> (<strong>stderr</strong>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/application-architecture/console-application/type-stream.png" alt="type stream"></span></p>
</div>
<div class="paragraph">
<p>Вывод данных на экран и чтение их с клавиатуры происходит потому, что по умолчанию стандартные потоки ассоциированы с терминалом пользователя. Это не является обязательным — потоки можно подключать к чему угодно — к файлам, программам и даже устройствам.</p>
</div>
<div class="sect4">
<h5 id="_стандартный_ввод">Стандартный ввод</h5>
<div class="paragraph">
<p><strong>Поток №0</strong> (<strong>stdin</strong>) зарезервирован для чтения команд пользователя или входных данных. Номера потоков ещё называют <strong>дескрипторами</strong>. Этот поток представляет собой некую информацию, передаваемую в терминал, в частности — инструкции, переданные в оболочку для выполнения. Обычно данные в этот поток попадают в ходе ввода их пользователем с клавиатуры.</p>
</div>
</div>
<div class="sect4">
<h5 id="_стандартный_вывод">Стандартный вывод</h5>
<div class="paragraph">
<p><strong>Поток №1</strong> данных (<strong>stdout</strong>), которые оболочка выводит после выполнения каких-то действий. Обычно эти данные попадают в то же окно терминала, где была введена команда, вызвавшая их появление.</p>
</div>
</div>
<div class="sect4">
<h5 id="_стандартный_вывод_ошибок">Стандартный вывод ошибок</h5>
<div class="paragraph">
<p>Поток ошибок (<strong>stderr</strong>) имеет дескриптор 2. Этот поток похож на стандартный поток вывода, так как обычно то, что в него попадает, оказывается на экране терминала. Однако, он, по своей сути, отличается от стандартного вывода, как результат, этими потоками, при желании, можно управлять раздельно. Это полезно, например, в следующей ситуации. Есть команда, которая обрабатывает большой объём данных, выполняя сложную и подверженную ошибкам операцию. Нужно, чтобы полезные данные, которые генерирует эта команда, не смешивались с сообщениями об ошибках. Реализуется это благодаря раздельному перенаправлению потоков вывода и ошибок.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_конвейер">1.1.2. Конвейер</h4>
<div class="paragraph">
<p><strong>Конвейер</strong> - некоторое множество процессов, для которых выполнено следующее перенаправление ввода-вывода: то, что выводит на поток стандартного вывода предыдущий процесс, попадает в поток стандартного ввода следующего процесса.</p>
</div>
<div class="paragraph">
<p>Другими словами, конвейер умеет передавать выходные данные из одной программы, как входные данные для другой. Т.е. выполняется команда, мы получаем результат и передаем эти данные далее на обработку другой программе.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>|</code> - отправить следующей команде</p>
</li>
<li>
<p><code>Tee</code> - отправить в файл и на стандартный вывод</p>
</li>
<li>
<p><code>Xargs</code> – построчно передать на ввод команде</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Конвейер создаётся с помощью вызова pipe(), который возвращает два файловых дескриптора: один ссылается на вход конвейера, второй на выход и разделяются <code>|</code> (<code>stdout/stderr | stdin</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">$ ls | grep r</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/application-architecture/console-application/process-working-streams.jpg" alt="process working streams"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_перенаправление_потоков">1.1.3. Перенаправление потоков</h4>
<div class="paragraph">
<p><strong>Перенаправление ввода/вывода</strong> - изменения стандартных входных или выходных потоков и привязка к определенным условиям или файлам.</p>
</div>
<div class="paragraph">
<p><strong>Перенаправление ввода/вывода</strong> означает работу с вышеописанными потоками и перенаправление данных туда, куда нужно программисту. Делается это с использованием символов <code>&gt;</code> и <code>&lt;</code> в различных комбинациях, применение которых зависит от того, куда, в итоге, должны попасть перенаправляемые данные.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;</code> - изменение (назначение) нестандартного входного устройства (<code>&lt; файл</code> - файл в поток ввода);</p>
</li>
<li>
<p><code>&lt;&lt;</code> - считывать стандартный ввод, пока не встретится указанный текст;</p>
</li>
<li>
<p><code>&gt;</code> - переназначение стандартного вывода (<code>&gt; файл</code> - поток вывода в новый файл);</p>
</li>
<li>
<p><code>&gt;&gt;</code> - переназначение вывода, добавление вывода команды в конец существующего файла (<code>&gt;&gt; файл</code> - поток вывода в конец файла);</p>
</li>
<li>
<p><code>2&gt;</code> - переназначения стандартного потока сообщений об ошибках (<code>2&gt; файл</code> - поток ошибок в новый файл);</p>
</li>
<li>
<p><code>2&gt;&gt;</code> - переназначение вывода сообщений об ошибках, добавление сообщений об ошибках в конец существующего файла (<code>2&gt;&gt; файл</code> - поток ошибок в конец файла);</p>
</li>
<li>
<p><code>&amp;&gt;</code>, <code>&gt;&amp;</code> - направляет потоки вывода и ошибок в один файл (<code>&amp;&gt; файл</code> или <code>&gt;&amp; файл</code> - потоки вывода и ошибок в новый файл);</p>
</li>
<li>
<p><code>2&gt;&amp;1</code> - направляет поток ошибок туда, куда направлен поток вывода (<code>2&gt;&amp;1 файл</code> - потоки ошибок туда, куда и поток вывода);</p>
</li>
<li>
<p><code>1&gt;&amp;2</code> - направляет поток вывода туда, куда направлен поток ошибок (<code>1&gt;&amp;2 файл</code> - поток вывода туда, куда и поток ошибок).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/application-architecture/console-application/Stdout-redirect.jpg" alt="Stdout redirect"></span></p>
</div>
<div class="sect4">
<h5 id="_перенаправление_стандартного_потока_вывода">Перенаправление стандартного потока вывода</h5>
<div class="paragraph">
<p>Обычно команды выводят данные в стандартный поток вывода. Для того, чтобы эти данные оказались в файле, нужно добавить символ <code>&gt;</code> после команды, перед именем целевого файла. До и после <code>&gt;</code> надо поставить <code>пробел</code>. При использовании перенаправления любой файл, указанный после &gt; будет перезаписан. Если в файле нет ничего ценного и его содержимое можно потерять, в нашей конструкции допустимо использовать уже существующий файл. Обычно же лучше использовать в подобном случае имя файла, которого пока не существует. Этот файл будет создан после выполнения команды.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">$ date &gt; date.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для того, чтобы это данные добавлялись в конец файла, а не перезаписывали файл, надо использовать два символа <code>&gt;&gt;</code>, поставленные один за другим. В результате новая команда, перенаправляющая вывод в файл, но не перезаписывающая его, а добавляющая новые данные после старых, будет выглядеть так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">$ traceroute google.com &gt;&gt; date.txt</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_перенаправление_стандартного_потока_ввода">Перенаправление стандартного потока ввода</h5>
<div class="paragraph">
<p>Используя знак <code>&lt;</code> мы можем перенаправить стандартный ввод, заменив его содержимым файла.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">$ comm &lt;(sort list1.txt) &lt;(sort list2.txt)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Круглые скобки тут имеют тот же смысл, что и в математике. Оболочка сначала обрабатывает команды в скобках, а затем всё остальное. В нашем примере сначала производится сортировка строк из файлов, а потом то, что получилось, передаётся команде <code>comm</code>, которая затем выводит результат сравнения списков.</p>
</div>
</div>
<div class="sect4">
<h5 id="_перенаправление_стандартного_потока_ошибок">Перенаправление стандартного потока ошибок</h5>
<div class="paragraph">
<p>Это может понадобиться, например, для создания лог-файлов с ошибками или объединения в одном файле сообщений об ошибках и возвращённых некоей командой данных.</p>
</div>
<div class="paragraph">
<p>Обычно, когда обычный пользователь запускает команду, она выводит в терминал и полезные данные и ошибки. При этом, последних обычно больше, чем первых, что усложняет нахождение в выводе команды того, что нужно. Решить эту проблему довольно просто: достаточно перенаправить стандартный поток ошибок в файл, используя команду <code>2&gt;</code>. В результате на экран попадёт только то, что команда отправляет в стандартный вывод:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">$ find / -name wireless 2&gt; denied.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если нужно сохранить результаты работы команды в отдельный файл, не смешивая эти данные со сведениями об ошибках  можно добавить команду перенаправления стандартного потока вывода в файл:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">$ find / -name wireless 2&gt; denied.txt &gt; found.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если нужно, чтобы всё, что выведет команда, попало в один файл, можно перенаправить оба потока в одно и то же место, воспользовавшись командой <code>&amp;&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">$ find / -name wireless &amp;&gt; results.txt</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_формат_и_параметры_команд">1.1.4. Формат и параметры команд</h4>
<div class="paragraph">
<p>Наиболее общий формат команд (в квадратные скобки помещены необязательные части):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">[символ_начала_команды]имя_команды [параметр_1 [параметр_2 […]]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Символ начала команды может быть самым разным, однако чаще всего для этой цели используется косая черта <code>/</code>. Если строка вводится без этого символа, выполняется некоторая базовая команда. Если же такой базовой команды нет, символ начала команды отсутствует вообще (как, например, в <strong>DOS</strong>).</p>
</div>
<div class="paragraph">
<p>Параметры команд могут иметь самый разный формат. В основном применяются следующие правила:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>параметры разделяются пробелами (и отделяются от названия команды пробелом)</p>
</li>
<li>
<p>параметры, содержащие пробелы, обрамляются кавычками-апострофами <code>'</code> или двойными кавычками <code>"</code></p>
</li>
<li>
<p>если параметр используется для обозначения включения какой-либо опции, выключенной по умолчанию, он начинается с косой черты <code>/</code> или дефиса <code>-</code></p>
</li>
<li>
<p>если параметр используется для включения/выключения какой-либо опции, он начинается (или заканчивается) знаком плюс или минус (для включения и выключения соответственно)</p>
</li>
<li>
<p>если параметр указывает действие из группы действий, назначенных команде, он не начинается со специальных символов</p>
</li>
<li>
<p>если параметр указывает объект, к которому применяется действие команды, он не начинается со специальных символов</p>
</li>
<li>
<p>если параметр указывает дополнительный параметр какой-либо опции, то он имеет формат <code>/опция:дополнительный_параметр</code> (вместо косой черты также может употребляться дефис).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="bash">/map dm1 /skill:2</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/</code> — символ начала команды</p>
</li>
<li>
<p><code>map</code> — название команды (переход на другой уровень)</p>
</li>
<li>
<p><code>dm1</code> — обязательный параметр (название уровня)</p>
</li>
<li>
<p><code>/skill:2</code> — дополнительный параметр (задание уровня сложности)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_примеры_консольных_программ">1.1.5. Примеры консольных программ</h4>
<div class="ulist">
<ul>
<li>
<p>Любая программа, осуществляющая получение данных от пользователя путём чтения <strong>stdin</strong> и отправку данных пользователю путём записи в <strong>stdout</strong>, по определению является консольной программой. Однако, такие программы могут обходиться и безо всякого пользователя, например обрабатывая данные из файлов.</p>
</li>
<li>
<p>Unix shell, а также все утилиты, предназначенные для работы в этой среде.</p>
</li>
<li>
<p><strong>Midnight Commander</strong> (<strong>UNIX</strong>), <strong>FAR Manager</strong> (<strong>Windows</strong>) - это двухпанельный файловый менеджер для операционных систем.
<span class="image"><img src="../assets/img/application-architecture/console-application/example-midnight-commander.png" alt="example midnight commander"></span></p>
</li>
<li>
<p><strong>Alpine</strong> (клиент электронной почты)
<span class="image"><img src="../assets/img/application-architecture/console-application/example-alpine-email-client.png" alt="example alpine email client"></span></p>
</li>
<li>
<p><strong>Irssi</strong> (IRC-клиент (Internet Relay Chat))
<span class="image"><img src="../assets/img/application-architecture/console-application/example-irssi.png" alt="example irssi"></span></p>
</li>
<li>
<p><strong>Lynx</strong> (веб-браузер)
<span class="image"><img src="../assets/img/application-architecture/console-application/example-lynx.png" alt="example lynx"></span></p>
</li>
<li>
<p><strong>Music on Console</strong> (аудиоплеер)</p>
</li>
<li>
<p><strong>Mutt</strong> (клиент электронной почты)
<span class="image"><img src="../assets/img/application-architecture/console-application/example-mutt.png" alt="example mutt"></span></p>
</li>
<li>
<p><strong>VIM</strong> (текстовый редактор)
<span class="image"><img src="../assets/img/application-architecture/console-application/example-vim.png" alt="example vim"></span></p>
</li>
<li>
<p>RTORRENT (ТОРРЕНТ КЛИЕНТ)
<span class="image"><img src="../assets/img/application-architecture/console-application/example-rtorent.png" alt="example rtorent"></span></p>
</li>
<li>
<p><strong>newsbeuter</strong> (RSS-ридер)
<span class="image"><img src="../assets/img/application-architecture/console-application/example-newsbeuter.png" alt="example newsbeuter"></span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_client_server_architecture">1.2. Client-Server Architecture</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Термины и названия, которые используются в разработке программного обеспечения, для одних и тех же вещей и идей, могут отличаться друг от друга в зависимости от авторов и различных глоссариев принятых в командах и компаниях. К сожалению, согласованность в этом отсутствует и необходимо это учитывать при коммуникации с другими. Да бы не вносить еще большую несогласованность, рекомендуется использовать только термины и названия на английском языке, так как в процессе локализации может теряться смысл или очевидность, того или иного термина и названия. Что еще хуже, может появиться новый термин или название для конкретной локализации.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_что_такое_client_server_architecture">1.2.1. Что такое Client-Server Architecture?</h4>
<div class="paragraph">
<p><strong>Client-server model</strong> или <strong>client-server architecture</strong>, представляет собой структуру распределенного приложения, разделяющую задачи между <strong>серверами</strong> и <strong>клиентами</strong>, которые либо находятся в одной системе, либо обмениваются данными через компьютерную сеть или Интернет. <strong>Клиент</strong> полагается на отправку запроса в другую программу, чтобы получить доступ к услуге, предоставляемой сервером. На <strong>сервере</strong> выполняется одна или несколько программ, которые совместно используют ресурсы и распределяют работу между клиентами.</p>
</div>
<div class="paragraph">
<p>Клиент и сервер физически представляют собой программы, например, клиентом может являться <em>браузер</em>, а сервером: <em>Web server</em> или <em>Relational Database Management System</em>.</p>
</div>
<div class="paragraph">
<p>Отношения <strong>client-server</strong> взаимодействуют согласно <strong>request–response messaging pattern</strong> и должны иметь общий протокол связи, который формально определяет используемые правила, язык и шаблоны <strong>requests</strong> и <strong>response</strong>. Связь между клиентом и сервером <em>обычно</em> осуществляется по набору протоколов <strong>TCP/IP</strong>.</p>
</div>
<div class="paragraph">
<p><strong>В основе взаимодействия клиент-сервер</strong> лежит принцип того, что такое взаимодействие начинает клиент, сервер лишь отвечает клиенту и сообщает о том, может ли он предоставить услугу и, если может, то на каких условиях.</p>
</div>
<div class="paragraph">
<p><strong>Клиентское и серверное программное обеспечение</strong> обычно установлено на разных машинах, но также они могут работать и на одном компьютере. Данная концепция взаимодействия была разработана для того, чтобы разделить нагрузку между участниками процесса обмена информацией, а также для того, чтобы разделить программный код поставщика и заказчика.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../assets/img/application-architecture/client-server.jpg" alt="Простая схема взаимодействия client-server">
</div>
<div class="title">Figure 1. Простая схема взаимодействия <strong>client-server</strong></div>
</div>
<div class="paragraph">
<p>Видно, что к одному серверу может обращаться сразу несколько клиентов (на одном сайте может находиться несколько посетителей). Также стоит заметить, что количество одновременно взаимодействующих клиентов с сервером зависит от мощности сервера и от того, что хочет получить клиент от сервера.</p>
</div>
<div class="sect4">
<h5 id="_преимущества">Преимущества</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Отсутствие дублирования кода</strong> программы-сервера программами-клиентами. Это позволяет обновлять систему, без обязательной необходимости обновлять программу-клиент, так как основная логика выполнения находится на стороне программы-сервера.</p>
</li>
<li>
<p><strong>Снижаются требования к компьютерам на которые установлен клиент</strong>, так как все вычисления выполняются на сервере.</p>
</li>
<li>
<p><strong>Безопасность</strong>, так как все данные хранятся на сервере, который, как правило, защищён гораздо лучше большинства клиентов. На сервере проще организовать контроль полномочий, чтобы разрешать доступ к данным только клиентам с соответствующими правами доступа.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_недостатки">Недостатки</h5>
<div class="ulist">
<ul>
<li>
<p>Неработоспособность сервера <strong>может сделать неработоспособной всю вычислительную</strong> систему. Неработоспособным сервером следует считать сервер, производительности которого, не хватает на обслуживание всех клиентов. Неработоспособным сервером следует так же считать сервер, который физически не обслуживает клиентов, т.к находящийся на ремонте, профилактике и т.д.</p>
</li>
<li>
<p>Поддержка работы данной системы <strong>требует отдельного специалиста</strong> — системного администратора.</p>
</li>
<li>
<p><strong>Высокая стоимость оборудования</strong>, т.к. к серверу предъявляются более высокие требования к отказоустойчивости, чем к клиентам.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_тонкий_и_толстый_клиент">1.2.2. Тонкий и толстый клиент</h4>
<div class="paragraph">
<p>Все <strong>клиенты</strong> в клиент-серверной архитектуре условно делятся на два подтипа: <strong>толстые клиенты</strong> и <strong>тонкие клиенты</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Толстый клиент</strong> — клиент, выполняющий запрашиваемые со стороны пользователя манипуляции независимо от ведущего сервера. Основной сервер в такой вариации системной архитектуры может применяться как особое хранилище информации, обработка и конечное предоставление которых просто переносится на локальную машину пользователя.</p>
</div>
<div class="paragraph">
<p><strong>Толстый клиент</strong> – это рабочая машина или ПК, которые функционируют на основе своей ОС и наполнены полноценным набором ПО для требуемых задач пользователя. Если взглянуть с программной точки зрения, понятными примерами толстых клиентов можно считать программы для совместной деятельности, если они изначально установлены на определенные вычислительные устройства. Например: <em>Yahoo Messenger</em>, <em>Office 365</em>, <em>Microsoft Outlook</em>.</p>
</div>
<div class="paragraph">
<p><strong>Преимущества толстых клиентов:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Большая функциональность;</p>
</li>
<li>
<p>Наличие многопользовательского режима;</p>
</li>
<li>
<p>Возможность работы в режиме оффлайн;</p>
</li>
<li>
<p>Мгновенное быстродействие;</p>
</li>
<li>
<p>Минимальная зависимость от сложных серверов.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Недостатки толстых клиентов:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Все рабочие машины на постоянной основе нуждаются в техническом обслуживании;</p>
</li>
<li>
<p>Необходимость в индивидуальном обновлении аппаратного ПО каждого клиента до уровня программного обеспечения, которое будет использоваться;</p>
</li>
<li>
<p>Массивные объемы дистрибутивов;</p>
</li>
<li>
<p>Полная зависимость от платформ, под которую данные клиенты были созданы.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Тонкий клиент</strong> — вид клиента, который может переносить выполнение задач по обработке информации на сервер, не применяя свои мощности по вычислению для их внедрения. Все вычислительные ресурсы подобного клиента максимально ограничены, важно, чтобы их хватало для старта нужного сетевого ПО, применяя, к примеру, веб-интерфейс.</p>
</div>
<div class="paragraph">
<p>Одним из наиболее распространенных примеров такого типа клиента считается ПК с заранее установленным веб-браузером, который применяется для работы с web-сервисами.</p>
</div>
<div class="paragraph">
<p><strong>Характерная черта тонких клиентов</strong> — применение терминального режима функционирования. В такой ситуации, терминальный сервер применяется для процесса отправки и получения информации пользователя, что и является базовым отличием от процесса независимой обработки информации в толстых клиентах.</p>
</div>
<div class="paragraph">
<p><strong>Плюсы тонкого клиента:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Минимальное аппаратное обслуживание;</p>
</li>
<li>
<p>Низкий риск возникновения неисправности;</p>
</li>
<li>
<p>Минимальные технические требования к аппаратному оборудованию.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Недостатки тонкого клиента:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>При сбое на сервере «пострадают» все подключенные пользователи;</p>
</li>
<li>
<p>Нет возможности работать без активного подключения к сети;</p>
</li>
<li>
<p>При взаимодействии с большим массивом данных может снижаться объем производительности основного сервера.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Базовые отличия</strong> между ними – это варианты обработки данных. <strong>Толстые клиенты</strong> работают с информацией на основе собственных аппаратных и программных возможностей, в то же время <strong>тонкие</strong> применяют ПО центрального сервера, только чтобы обработать данные, предоставляя системе лишь требуемый графический интерфейс для выполнения работы пользователем. Это значит, что в роли тонких клиентов иногда мы можем увидеть устаревшие или не очень производительные ПК.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_n_tier_architecture">1.3. N-tier Architecture</h3>
<div class="paragraph">
<p><strong>N-tier architecture</strong> (<strong>multitier architecture</strong>, <strong>многослойная архитектура</strong>) это <strong>client-server architecture</strong>, в которой разделяются функции представления, обработки и хранения данных. Наиболее распространённой разновидностью многоуровневой архитектуры является трёхуровневая архитектура.</p>
</div>
<div class="sect3">
<h4 id="_tiers">1.3.1. Tiers</h4>
<div class="paragraph">
<p>Стоит выделить несколько <em>tiers</em> на которые обычно разделяют систему.</p>
</div>
<div class="sect4">
<h5 id="_presentation_tier">Presentation tier</h5>
<div class="paragraph">
<p><strong>Presentation tier</strong> (<strong>слой представления</strong>) - это <strong>user interface</strong> (<strong>пользовательский интерфейс</strong>) и <strong>communication layer</strong> (<strong>уровень связи приложения</strong>), где конечный пользователь взаимодействует с приложением. Его основная цель - отображать информацию и собирать информацию от пользователя. Этот <strong>top-level tier</strong> (<strong>верхне-уровневый слой</strong>) может работать, например, в веб-браузере, как настольное приложение или как <strong>graphical user interface</strong> (<strong>графический пользовательский интерфейс</strong>, <strong>GUI</strong>). <strong>Web presentation tiers</strong> обычно разрабатываются с использованием <em>HTML</em>, <em>CSS</em> и <em>JavaScript</em>. Настольные приложения могут быть написаны на разных языках в зависимости от платформы.</p>
</div>
</div>
<div class="sect4">
<h5 id="_application_tier">Application tier</h5>
<div class="paragraph">
<p><strong>Application tier</strong> (<strong>слой приложения</strong>), также известный как <strong>logic tier</strong> (<strong>слой логики</strong>) или <strong>middle tier</strong> (<strong>средний слой</strong>), является сердцем приложения. На этом уровне информация, собранная на <em>presentation tier</em>, обрабатывается, и обычно с использованием некой бизнес-логики и определенного набора бизнес-правил. <em>Application tier</em> также может добавлять, удалять или изменять данные на <em>data tier</em>.</p>
</div>
<div class="paragraph">
<p><em>Application tier</em> обычно разрабатывается с использованием Java, Python, Perl, PHP или Ruby и взаимодействует с <em>data tier</em> с помощью вызовов некоторого API.</p>
</div>
</div>
<div class="sect4">
<h5 id="_data_tier">Data tier</h5>
<div class="paragraph">
<p><strong>Data tier</strong> (<strong>слой данных</strong>), иногда называемый <strong>database tier</strong> (<strong>слоем базы данных</strong>), <strong>data access tier</strong> (<strong>слоем доступа к данным</strong>) или <strong>back-end</strong> (<strong>серверной частью</strong>), - это место, где информация, обрабатываемая приложением, хранится и управляется. Это может быть <strong>relational database management system</strong> (<strong>система управления реляционными базами данных</strong>), такая как <em>PostgreSQL</em>, <em>MariaDB</em>, <em>Oracle</em>, <em>DB2</em>, <em>Informix</em> или <em>Microsoft SQL Server</em>, или <strong>NoSQL Database server</strong> (<strong>сервером NoSQL базы данных</strong>), таким как <em>Cassandra</em>, <em>CouchDB</em> или <em>MongoDB</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_layer_против_tier">1.3.2. Layer против tier</h4>
<div class="paragraph">
<p>При обсуждении N-tier architecture, <strong>layer</strong> (<strong>уровень</strong>)  часто используется взаимозаменяемо с <strong>tier</strong> (<strong>слой</strong>), что является не совсем верно, например, <em>presentation layer</em> или <em>business logic layer</em>.</p>
</div>
<div class="paragraph">
<p>Это не одно и то же. <strong>Layer</strong> относится к функциональному разделению программного обеспечения, а <strong>tier</strong> относится к функциональному разделению программного обеспечения, которое выполняется на разных инфраструктурных единицах, независимо от других. Приложение <em>Контакты</em> на телефоне, например, представляет собой <em>three-layer application</em>, но <em>single-tier application</em>, потому что все три <em>layers</em> работают на телефоне.</p>
</div>
<div class="paragraph">
<p>Разница важна, потому что <em>layers</em> не могут предложить те же преимущества, что и <em>tiers</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_single_tier_architecture">1.3.3. Single-tier architecture</h4>
<div class="paragraph">
<p><strong>Single-tier application</strong> AKA <strong>Standalone application</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../assets/img/application-architecture/single-tier-architecture.png" alt="Single-tier architecture">
</div>
</div>
<div class="paragraph">
<p><em>Single-tier architecture</em> включает в себя все <em>tiers</em>, такие как <em>presentation tier</em>, <em>application tier</em> и <em>data tier</em>, в одном приложении. Приложения, которые включают в себя все три <em>tiers</em>, например, MP3-плеер, MS Office и т.д., являются <strong>single-tier application</strong>. Данные хранятся в локальной системе или на общем диске.</p>
</div>
</div>
<div class="sect3">
<h4 id="_two_tier_architecture">1.3.4. Two-tier architecture</h4>
<div class="imageblock">
<div class="content">
<img src="../assets/img/application-architecture/two-tier-architecture.png" alt="Two-tier architecture">
</div>
</div>
<div class="paragraph">
<p><strong>Two-tier architecture</strong> (<strong>двухзвенная архитектура</strong>, <strong>двухуровневая архитектура</strong>) - это классическая (т.е. первоначальная) <em>client-server architecture</em>, состоящая из <em>presentation tier</em> и <em>data tier</em>; бизнес-логика находится на <em>presentation tier</em>, <em>data tier</em> или на обоих <em>tiers</em>. В <em>two-tier architecture</em> <em>presentation tier</em>, а следовательно, конечный пользователь - имеет прямой доступ к <em>data tier</em>, а бизнес-логика часто ограничена. Простое приложение для управления бухгалтерией, в котором бухгалтеры могут фиксировать денежные операции в компании, является примером <em>two-tier application</em>.</p>
</div>
<div class="sect4">
<h5 id="_преимущества_2">Преимущества</h5>
<div class="ulist">
<ul>
<li>
<p>С точки зрения разработки и обслуживания:</p>
<div class="ulist">
<ul>
<li>
<p>Простая структура</p>
</li>
<li>
<p>Простота установки</p>
</li>
<li>
<p>Простота обслуживания</p>
</li>
</ul>
</div>
</li>
<li>
<p>С точки зрения производительности:</p>
<div class="ulist">
<ul>
<li>
<p>Хорошая производительность для небольших и средних объемов данных</p>
</li>
<li>
<p>Бизнес-логика и база данных физически близко, что обеспечивает более высокую производительность.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_недостатки_2">Недостатки</h5>
<div class="ulist">
<ul>
<li>
<p>С точки зрения разработки и обслуживания:</p>
<div class="ulist">
<ul>
<li>
<p>Сложную бизнес-логику приложения трудно реализовать на сервере базы данных, поэтому требуется реализовывать на клиенте</p>
</li>
<li>
<p>Сложная бизнес-логика приложения на клиенте, ведет к снижению производительности</p>
</li>
<li>
<p>Изменения в бизнес-логике, если они на клиенте, требуют нового программного обеспечения на стороне клиента, соответственно они должны быть доступны и установленны</p>
</li>
<li>
<p>Привязка к поставщику СУБД</p>
</li>
</ul>
</div>
</li>
<li>
<p>С точки зрения производительности:</p>
<div class="ulist">
<ul>
<li>
<p>Плохая производительность для больших и огромных объемов данных, так как сервер базы данных выполняет еще и бизнес-логику. Это замедляет операции в БД на сервере базы данных.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_three_tier_architecture">1.3.5. Three-tier architecture</h4>
<div class="imageblock">
<div class="content">
<img src="../assets/img/application-architecture/three-tier-architecture.png" alt="Three-tier architecture">
</div>
</div>
<div class="paragraph">
<p><strong>Three-tier architecture</strong> (<strong>трехзвенная архитектура</strong>, <strong>трехуровневая архитектура</strong>) - это хорошо зарекомендовавшая себя архитектура программных приложений, которая объединяет приложения в три логических и физических вычислительных <em>tiers</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>presentation tier</em> или пользовательский интерфейс;</p>
</li>
<li>
<p><em>application tier</em>, на котором обрабатываются данные;</p>
</li>
<li>
<p><em>data tier</em>, где хранятся и управляются данные, связанные с приложением.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>На протяжении десятилетий <em>three-tier architecture</em> была преобладающей <em>client-server architecture</em> для приложений.</p>
</div>
<div class="sect4">
<h5 id="_преимущества_3">Преимущества</h5>
<div class="ulist">
<ul>
<li>
<p>Главное преимущество <em>three-tier architecture</em> - <strong>логическое и физическое разделение функций</strong>. Каждый <em>tier</em> может работать на отдельной операционной системе и на отдельной серверной платформе - например, на веб-сервере, сервере приложений, сервере базы данных - что наилучшим образом соответствует его функциональным требованиям. И каждый уровень работает по крайней мере на одном выделенном серверном оборудовании или виртуальном сервере, поэтому службы каждого уровня могут быть настроены и оптимизированы без влияния на другие уровни.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Другие преимущества (по сравнению с <em>single-tier</em> или <em>two-tier architecture</em>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Более быстрая разработка</strong>: поскольку каждый <em>tier</em> может разрабатываться одновременно разными командами, организация может быстрее вывести приложение на рынок, а программисты могут использовать подходящие и более новые версии языков и инструментов для каждого <em>tier</em>.</p>
</li>
<li>
<p><strong>Улучшенная масштабируемость</strong>: любой <em>tier</em> можно масштабировать независимо от других по мере необходимости.</p>
</li>
<li>
<p><strong>Повышенная надежность</strong>: сбой на одном <em>tier</em> с меньшей вероятностью повлияет на доступность или производительность других <em>tiers</em>.</p>
</li>
<li>
<p><strong>Повышенная безопасность</strong>: поскольку <em>presentation tier</em> и <em>data tier</em> не могут взаимодействовать напрямую, хорошо спроектированный <em>application tier</em> может функционировать как своего рода внутренний брандмауэр, предотвращая SQL-инъекции и другие вредоносные эксплойты.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Так же можно структурировать преимущества.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>С точки зрения разработки и обслуживания:</p>
<div class="ulist">
<ul>
<li>
<p>Сложную бизнес-логику приложения легко реализовать на сервере приложений</p>
</li>
<li>
<p>Бизнес-логика отсутствует на сервере базы данных и клиенте, что улучшает производительность</p>
</li>
<li>
<p>Изменение бизнес-логики автоматически доступно клиенту после установки на <em>application server</em></p>
</li>
<li>
<p>Бизнес-логика <em>application server</em> совместима с другими серверами баз данных, после небольших изменений</p>
</li>
</ul>
</div>
</li>
<li>
<p>С точки зрения производительности:</p>
<div class="ulist">
<ul>
<li>
<p>Высокая производительность для средних и больших объемов данных</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_недостатки_3">Недостатки</h5>
<div class="ulist">
<ul>
<li>
<p>С точки зрения разработки и обслуживания:</p>
<div class="ulist">
<ul>
<li>
<p>Более сложная структура</p>
</li>
<li>
<p>Более сложная в настройке</p>
</li>
<li>
<p>Более сложная в обслуживании.</p>
</li>
</ul>
</div>
</li>
<li>
<p>С точки зрения производительности:</p>
<div class="ulist">
<ul>
<li>
<p>Физическое разделение на <em>application server</em>, содержащий бизнес-логику и <em>database server</em>, содержащий базы данных, может незначительно повлиять на производительность.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_three_tier_application_в_web_разработке">1.3.6. Three-tier application в web-разработке</h4>
<div class="paragraph">
<p>В web-разработке <em>tiers</em> имеют разные имена, но выполняют схожие функции:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Web-server</strong> является <em>presentation tier</em> и предоставляет пользовательский интерфейс. Обычно это web-страница или web-сайт, например, сайт электронной коммерции, где пользователь добавляет продукты в корзину, добавляет реквизиты для оплаты или создает учетную запись. Контент может быть статическим или динамическим и обычно разрабатывается с использованием HTML, CSS и Javascript.</p>
</li>
<li>
<p><strong>Application server</strong>  соответствует <em>middle tier</em>, в котором размещается бизнес-логика, используемая для обработки вводимых пользователем данных. Продолжая пример электронной торговли, это <em>tier</em>, который запрашивает из базы данных продукты, чтобы получить информацию о наличии продукта, или добавляет подробности в профиль клиента. Этот уровень часто разрабатывается с использованием Java, Python, Ruby, JavaScript и PHP, при поддержке таких фреймворков, как, например, Spring, Django, Rails, NodeJS и Symphony соответственно.</p>
</li>
<li>
<p><strong>Database server</strong> - это <em>data tier</em> для web-приложения. Он работает с программным обеспечением для управления базами данных, например PostgreSQL, MariaDB, Oracle или DB2.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_n_tier_architecture_2">1.3.7. N-tier architecture</h4>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/application-architecture/n-tier-architecture.jpg" alt="N-tier architecture"></span></p>
</div>
<div class="paragraph">
<p><strong>N-tier architecture</strong> - также называемая <strong>multi-tier architecture</strong> - относится к любой архитектуре приложения с более чем одним <em>tiers</em>. Так же встречаются приложения с более чем тремя <em>tiers</em>. Например, где источником данных является другой <strong>multi-tier application</strong>.</p>
</div>
<hr>
<div class="paragraph">
<p>Resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.ibm.com/cloud/learn/three-tier-architecture" class="bare">https://www.ibm.com/cloud/learn/three-tier-architecture</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java">2. Java</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unresolved directive in java/index.adoc - include::collections.adoc[]</p>
</div>
<div class="sect2">
<h3 id="_generics">2.1. Generics</h3>
<div class="sect3">
<h4 id="_type_inference_вывод_типа">2.1.1. Type Inference (Вывод типа)</h4>
<div class="paragraph">
<p><strong>Вывод типа</strong> - это способность <strong>компилятора Java</strong> просматривать каждый <strong>вызов метода</strong> и соответствующее <strong>объявление</strong>, чтобы определить <strong>тип аргумента</strong> (или аргументов), которые делают вызов применимым. Алгоритм <strong>вывода типа</strong> определяет <strong>типы аргументов</strong> и, если они доступны, тип, которому <strong>присваивается</strong> или <strong>возвращается</strong> результат. Наконец, <strong>алгоритм вывода</strong> пытается найти <strong>наиболее конкретный тип</strong>, который работает со всеми аргументами.</p>
</div>
<div class="paragraph">
<p>В следующем примере <strong>логический вывод типа</strong> определяет, что второй аргумент, передаваемый методу <code>pick()</code>, имеет тип <code>Serializable</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">static &lt;T&gt; T pick(T a1, T a2) {
    return a2;
}
Serializable s = pick("d", new ArrayList&lt;String&gt;());</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_вывод_типа_и_обобщенные_методы">Вывод типа и обобщенные методы</h5>
<div class="paragraph">
<p><strong>Вывод типа</strong>, позволяет вызывать <strong>обобщенный метод</strong>, как обычный метод, без указания типа в угловых скобках.</p>
</div>
<div class="paragraph">
<p>Полный синтаксис для вызова этого метода:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Pair&lt;Integer, String&gt; p1 = new Pair&lt;&gt;(1, "apple");
Pair&lt;Integer, String&gt; p2 = new Pair&lt;&gt;(2, "pear");
boolean same = Util.&lt;Integer, String&gt;compare(p1, p2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Компилятор может определить <strong>тип</strong> ориентируясь на <strong>аргументы</strong> переданные в <strong>метод</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Pair&lt;Integer, String&gt; p1 = new Pair&lt;&gt;(1, "apple");
Pair&lt;Integer, String&gt; p2 = new Pair&lt;&gt;(2, "pear");
boolean same = Util.compare(p1, p2);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Эта функция называется <strong>вывод типа</strong>, она позволяет вызывать <strong>обобщенный метод</strong> как <strong>обычный метод</strong> без указания типа в угловых скобках.</p>
</div>
</div>
<div class="sect4">
<h5 id="_вывод_типа_и_создание_экземпляров_обобщенных_классов">Вывод типа и создание экземпляров обобщенных классов</h5>
<div class="paragraph">
<p>Можно заменить <strong>аргументы типа</strong>, необходимые для вызова конструктора обобщенного класса, пустым набором параметров типа <code>&lt;&gt;</code>, если компилятор может вывести аргументы типа из контекста. Эта пара угловых скобок неофициально называется <strong>diamond</strong>.</p>
</div>
<div class="paragraph">
<p>Например, рассмотрим следующее объявление переменной:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Map&lt;String, List&lt;String&gt;&gt; myMap = new HashMap&lt;String, List&lt;String&gt;&gt;();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Можно заменить <strong>параметризованный тип конструктора</strong> на пустой набор параметров типа <code>&lt;&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Map&lt;String, List&lt;String&gt;&gt; myMap = new HashMap&lt;&gt;();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание, что для использования <strong>вывода типа</strong> во время создания экземпляра обобщенного класса необходимо использовать <strong>diamond</strong>. В следующем примере <strong>компилятор</strong> генерирует <strong>предупреждение о непроверенном преобразовании</strong>, поскольку конструктор <code>HashMap()</code> относится к <strong>сырому типу</strong> <code>HashMap</code>, а не к типу <code>Map &lt;String, List &lt;String&gt;&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Map&lt;String, List&lt;String&gt;&gt; myMap = new HashMap(); // unchecked conversion warning</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_выведение_типов_и_обобщенные_конструкторы_обобщенных_и_необобщенных_классов">Выведение типов и обобщенные конструкторы обобщенных и необобщенных классов</h5>
<div class="paragraph">
<p>Конструкторы могут быть обобщенными (другими словами, объявлять свои собственные параметры обобщенного типа) как в обобщенных, так и в необобщенных  классах. Рассмотрим следующий пример:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class MyClass&lt;X&gt; {
    &lt;T&gt; MyClass(T t) {
        // ...//
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Рассмотрим следующий экземпляр класса <code>MyClass</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">new MyClass&lt;Integer&gt;("")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот оператор создает экземпляр параметризованного типа <code>MyClass &lt;Integer&gt;</code>; оператор явно указывает тип <code>Integer</code> для параметра обобщенного типа <code>X</code> обобщенного класса <code>MyClass &lt;X&gt;</code>. Конструктор для этого обобщенного класса содержит параметр обобщенного типа <code>T</code>. Компилятор определяет тип <code>String</code> для параметра обобщенного типа <code>T</code> конструктора этого обобщенного класса (поскольку фактическим параметром этого конструктора является объект <code>String</code>).</p>
</div>
<div class="paragraph">
<p>Компиляторы из выпусков предшествующих Java SE 7, могут определять фактические параметры типов обобщенных конструкторов, аналогично обобщенным методам. Однако компиляторы в Java SE 7 и более поздних версиях могут вывести фактические параметры типа создаваемого экземпляра универсального класса, если вы используете <code>&lt;&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">MyClass&lt;Integer&gt; myObject = new MyClass&lt;&gt;("");</code></pre>
</div>
</div>
<div class="paragraph">
<p>В этом примере компилятор определяет тип <code>Integer</code> для параметра обобщенного типа <code>X</code> обобщенного класса <code>MyClass &lt;X&gt;</code>. Он определяет тип <code>String</code> для параметра формального типа <code>T</code> конструктора этого универсального класса.</p>
</div>
</div>
<div class="sect4">
<h5 id="_целевые_типы_target_types">Целевые типы (Target Types)</h5>
<div class="paragraph">
<p><strong>Компилятор Java</strong> использует <strong>целевую типизацию</strong> для вывода параметров типа вызова обобщенного метода. <strong>Целевой тип выражения</strong> - это тип данных, ожидаемый <strong>компилятором Java</strong> в зависимости от того, где находится выражение. Рассмотрим метод <code>Collections.emptyList()</code>, который объявлен следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">static &lt;T&gt; List&lt;T&gt; emptyList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Рассмотрим следующий оператор присваивания:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">List&lt;String&gt; listOne = Collections.emptyList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот оператор ожидает экземпляр <code>List &lt;String&gt;</code>; этот тип данных является целевым типом. Поскольку метод <code>emptyList()</code> возвращает значение типа <code>List &lt;T&gt;</code>, <strong>компилятор</strong> делает вывод, что аргумент типа <code>T</code> должен быть значением <code>String</code>. Это работает как в <strong>Java SE 7</strong>, так и в <strong>8</strong>. В качестве альтернативы можно использовать подтверждающий тип и указать значение <code>T</code> следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">List&lt;String&gt; listOne = Collections.&lt;String&gt;emptyList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Однако в данном контексте это необязательно. Однако это было необходимо в других контекстах. Рассмотрим следующий метод:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">void processStringList(List&lt;String&gt; stringList) {
    // process stringList
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если есть необходимость вызвать метод <code>processStringList()</code> с пустым списком. В <strong>Java SE 7</strong> следующий код не компилируется:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">processStringList(Collections.emptyList());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Компилятор <strong>Java SE 7</strong> выдает сообщение об ошибке, подобное следующему:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">List&lt;Object&gt; cannot be converted to List&lt;String&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Компилятору требуется значение для аргумента типа <code>T</code>, поэтому он начинается со значением <code>Object</code>. Следовательно, вызов <code>Collections.emptyList()</code> возвращает значение типа <code>List &lt;Object&gt;</code>, которое несовместимо с методом <code>processStringList()</code>. В <strong>Java SE 7</strong> необходимо указать значение значения аргумента типа следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">processStringList(Collections.&lt;String&gt;emptyList());</code></pre>
</div>
</div>
<div class="paragraph">
<p>В <strong>Java SE 8</strong> в этом больше нет необходимости. Понятие целевого типа было расширено за счет включения <strong>аргументов метода</strong>, таких как аргумент метода <code>processStringList()</code>. В этом случае для <code>processStringList()</code> требуется аргумент типа <code>List &lt;String&gt;</code>. Метод <code>Collections.emptyList()</code> возвращает значение <code>List &lt;T&gt;</code>, поэтому, используя целевой тип <code>List &lt;String&gt;</code>, компилятор делает вывод, что аргумент типа <code>T</code> имеет значение <code>String</code>. Таким образом, в <strong>Java SE 8</strong> следующий код компилируется:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">processStringList(Collections.emptyList());</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_generics_наследование_и_подтипы">2.1.2. Generics, наследование и подтипы</h4>
<div class="paragraph">
<p>Возможно присвоить объект одного типа объекту другого типа при условии, что типы совместимы. Например, можно типу <code>Object</code> присвоить <code>Integer</code>, поскольку <code>Object</code> является одним из суперклассов <code>Integer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Object someObject = new Object();
Integer someInteger = new Integer(10);
someObject = someInteger; // OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>В объектно-ориентированной терминологии это называется отношением «есть». Поскольку <code>Integer</code>  является разновидностью <code>Object</code>, присвоение разрешено. Но <code>Integer</code> также является разновидностью <code>Number</code>, поэтому следующий код также валиден:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void someMethod(Number n) {
    /* ... */
}

someMethod(new Integer(10)); // OK
someMethod(new Double(10.1)); // OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>То же самое и с generics. Вы можете выполнить вызов обобщенного типа, передав <code>Number</code> в качестве <strong>аргумента типа</strong>, и любой последующий вызов <code>add()</code> будет разрешен, если аргумент совместим с <code>Number</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Box&lt;Number&gt; box = new Box&lt;Number&gt;();
box.add(new Integer(10));   // OK
box.add(new Double(10.1));  // OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь рассмотрим следующий метод:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void boxTest(Box&lt;Number&gt; n) { /* ... */ }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Какие аргументы он принимает? Посмотрев на его, видно, что он принимает единственный аргумент, тип которого - <code>Box &lt;Number&gt;</code>. Но что это значит? Можно ли передать в качестве аргумента <code>Box &lt;Integer</code>&gt; или <code>Box &lt;Double&gt;</code>, как и следовало ожидать? Ответ - «нет», потому что <code>Box &lt;Integer&gt;</code> и <code>Box &lt;Double&gt;</code> не являются подтипами <code>Box &lt;Number&gt;</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../assets/img/java/generics/generics-subtype-relationship.gif" alt="связь обобщенных подтипов">
</div>
</div>
<div class="paragraph">
<p>Это распространенное заблуждение, когда дело доходит до программирования с использованием generics, но это важная концепция, которую нужно изучить.</p>
</div>
<div class="sect4">
<h5 id="_обобщенные_классы_и_подтипы">Обобщенные классы и подтипы</h5>
<div class="paragraph">
<p>Можно создать подтипы общего класса или интерфейса, расширив или реализуя его. Отношения между параметрами типа одного класса или интерфейса и параметрами типа другого определяются ключевыми словами <code>extends</code> и <code>implements</code>.</p>
</div>
<div class="paragraph">
<p>Используя классы <code>Collections</code> в качестве примера, <code>ArrayList &lt;E&gt;</code> реализует <code>List &lt;E&gt;</code>, а <code>List &lt;E&gt;</code> расширяет <code>Collection &lt;E&gt;</code>. Итак, <code>ArrayList &lt;String&gt;</code> является подтипом <code>List &lt;String&gt;</code>, который является подтипом <code>Collection &lt;String&gt;</code>. Пока вы не изменяете <strong>аргумент типа</strong>, отношения подтипов между типами сохраняются.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../assets/img/java/generics/generics-sample-hierarchy.gif" alt="пример иерархии обобщенных подтипов">
</div>
</div>
<div class="paragraph">
<p>Теперь представьте, что мы хотим определить наш собственный интерфейс списка, <code>PayloadList</code>, который связывает необязательное значение универсального типа <code>P</code> с каждым элементом. Его объявление может выглядеть так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">interface PayloadList&lt;E,P&gt; extends List&lt;E&gt; {
    void setPayload(int index, P val);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующие параметризации <code>PayloadList</code> являются подтипами <code>List &lt;String&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">PayloadList&lt;String,String&gt;
PayloadList&lt;String,Integer&gt;
PayloadList&lt;String,Exception&gt;
[source, java]</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../assets/img/java/generics/generics-payload-list-hierarchy.gif" alt="иерархия playLoadList">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_java_tools">2.2. Java: Tools</h3>
<div class="sect3">
<h4 id="_java_tools_testing">2.2.1. Java Tools: Testing</h4>
<div class="sect4">
<h5 id="_junit">JUnit.</h5>
<div class="sect5">
<h6 id="_введение">Введение</h6>
<div class="paragraph">
<p><strong>Тестирование</strong> – это процесс проверки функционала программы с целью подтверждения того, что она работает в соответствии с определёнными требованиями. Unit-тестирование – это тестирование, которые пишутся, непосредственно, на уровне разработчика (тестирование определённой сущности – метод или класс). Это крайне важный этап разработки ПО, который помогает создавать качественный продукт.</p>
</div>
<div class="paragraph">
<p><strong>Юнит-тестирование</strong> делится на две большие группы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ручное тестирование</p>
</li>
<li>
<p>Автоматизированное тестирование</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ручное тестирование</th>
<th class="tableblock halign-left valign-top">Автоматизированное тестирование</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ручное выполнение тестов без помощи каких-либо средств.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Использование специальных средств для автоматизированного тестирования</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Не программируется</p>
<p class="tableblock">Нет возможности для написания сложных тестов для тестирования сложных моделей поведения.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Программируется</p>
<p class="tableblock">Тестировщики могут написать сложные тесты для тестирования сложных моделей программирования</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Низкая надёжность</p>
<p class="tableblock">Ручное тестирование имеет низкую надёжность, так как крайне подвержено влиянию человеческого фактора.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Высокая надёжность</p>
<p class="tableblock">Автоматизированное тестирование точное и надёжное.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Большие затраты времени</p>
<p class="tableblock">Связано с тем, что человек имеет крайне ограниченные возможность в скорости работы.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Быстро</p>
<p class="tableblock">Автоматизированные тесты выполняются на порядок быстрее, чем это может сделать человек.</p></td>
</tr>
</tbody>
</table>
<div class="sect6">
<h7 id="_junit_2">JUnit</h7>
<div class="paragraph">
<p><strong>JUnit</strong> – это фреймворк, разработанный для тестирования программ, написанных с использованием технологии <strong>Java</strong>. Он лежит в основе <strong>TDD</strong> (<strong>Test-Driven Development</strong>) и входит в семейство фрейморков для тестирования xUnit.</p>
</div>
<div class="paragraph">
<p>Главная идея данного фреймворка – “сначала тесты, потом код”. Это означает, что сначала мы определяем, что должно получиться в результате работы того или иного куска кода и пишем тесты, которые проверяют идентичность результата с требуемым, после чего пишем сам кусок кода, который и будем тестировать. Данный подход увеличивает эффективность работы разработчика и позволяет писать более стабильный код. В результате этого мы получаем меньшее количество времени, которое затрачивается на отладку программы.</p>
</div>
</div>
<div class="sect6">
<h7 id="_свойства_junit">Свойства JUnit</h7>
<div class="ulist">
<ul>
<li>
<p>Фреймворк с открытым исходным кодом, который используется для написания и выполнения тестов.</p>
</li>
<li>
<p>Позволяет писать код более быстро и качественно.</p>
</li>
<li>
<p>Крайне прост в использовании.</p>
</li>
<li>
<p>Поддерживает аннотации для идентификации методов.</p>
</li>
<li>
<p>Поддерживает утверждения для тестирования получаемых результатов.</p>
</li>
<li>
<p>Тесты могут быть организованы  в связки тестов (<strong>test suites</strong>).</p>
</li>
<li>
<p>Имеет визуальную индикацию состояния тестов (красные – не пройдены, зелёные – пройдены).</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="_тестовый_случай">Тестовый случай</h7>
<div class="paragraph">
<p><strong>Тестовый случай</strong> (Test Case) в <strong>юнит тестировании</strong> – это часть кода, которая проверяет, что другая часть кода  (в частности – метод) работает в соответствии с определёнными требованиями.</p>
</div>
<div class="paragraph">
<p>Формально описанный тестовый случай характеризуется известными входными данными и ожидаемым выводом программы, который известен до начала выполнения теста.</p>
</div>
<div class="paragraph">
<p>Необходимо создавать, как минимум, два тестовых случая для каждого требования – положительный и отрицательный. Если требование имеет под требования, каждое из них должно тестироваться отдельно.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_junit_5">JUnit 5</h6>
<div class="paragraph">
<p><strong>JUnit 5</strong> требует <strong>Java 8</strong> (или выше) во время выполнения. Однако вы все равно можете протестировать код, скомпилированный с предыдущими версиями <strong>JDK</strong>.</p>
</div>
<div class="paragraph">
<p>В отличие от предыдущих версий <strong>JUnit</strong>, <strong>JUnit 5</strong> состоит из нескольких разных модулей из трех разных подпроектов.</p>
</div>
<div class="paragraph">
<p><strong>JUnit 5</strong> = <strong>Platform JUnit</strong> + <strong>JUnit Jupiter</strong> + <strong>JUnit Vintage</strong></p>
</div>
<div class="paragraph">
<p><strong>JUnit платформа</strong> служит основой для запуска тестирования рамок на <strong>JVM</strong>. Он также определяет <strong>TestEngineAPI</strong> для разработки инфраструктуры тестирования, работающей на платформе. Кроме того, платформа предоставляет средство запуска консоли для запуска платформы из командной строки и средство запуска на основе <strong>JUnit 4</strong> для запуска любого <strong>TestEngine</strong> на платформе в среде на основе <strong>JUnit 4</strong>. Первоклассная поддержка <strong>платформы JUnit</strong> также существует в популярных <strong>IDE</strong> (см. <strong>IntelliJ IDEA</strong>, <strong>Eclipse</strong>, <strong>NetBeans</strong> и <strong>код Visual Studio</strong>) и инструментах сборки (см. <strong>Gradle</strong>, <strong>Maven</strong> и <strong>Ant</strong>).</p>
</div>
<div class="paragraph">
<p><strong>JUnit Jupiter</strong> является сочетанием новой модели программирования и модели расширения для написания тестов и расширений в <strong>JUnit 5</strong>. Jupiter подпроекте обеспечивает <strong>TestEngine</strong> для выполнения тестов на основе <strong>Jupiter</strong> на платформе.</p>
</div>
<div class="paragraph">
<p><strong>JUnit Vintage</strong> обеспечивает <strong>TestEngine</strong> запуск тестов на основе <strong>JUnit 3</strong> и <strong>JUnit 4</strong> на платформе.</p>
</div>
<div class="paragraph">
<p>Получать помощь, а также задайте вопросы, связанные с <strong>JUnit 5</strong> можно на <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://stackoverflow.com/questions/tagged/junit5"><strong>Stack Overflow</strong></a> или пообщайтесь с нами в <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://gitter.im/junit-team/junit5"><strong>Gitter</strong></a>.</p>
</div>
<div class="paragraph">
<p>В <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples"><strong>junit5-samples</strong></a> репозитории размещена коллекция примеров проектов, основанных на <strong>JUnit Jupiter</strong>, <strong>JUnit Vintage</strong> и других средах тестирования. Вы найдете подходящие сценарии сборки.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Для <strong>Gradle</strong> и <strong>Java</strong> ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-gradle"><strong>junit5-jupiter-starter-gradle</strong></a> проектом.</p>
</li>
<li>
<p>Для <strong>Gradle</strong> и <strong>Kotlin</strong> ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-gradle-kotlin"><strong>junit5-jupiter-starter-gradle-kotlin</strong></a> проектом.</p>
</li>
<li>
<p>Для <strong>Gradle</strong> и <strong>Groovy</strong> ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-gradle-groovy"><strong>junit5-jupiter-starter-gradle-groovy</strong></a> проектом.</p>
</li>
<li>
<p>Для <strong>Maven</strong> проверьте <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-maven"><strong>junit5-jupiter-starter-maven</strong></a> проект.</p>
</li>
<li>
<p>Что касается <strong>Ant</strong>, ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-ant"><strong>junit5-jupiter-starter-ant</strong></a> проектом.</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="_аннотации">Аннотации</h7>
<div class="paragraph">
<p><strong>JUnit Jupiter</strong> поддерживает следующие аннотации для настройки тестов и расширения фреймворка.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Аннотация</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Свойство</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является методом тестирования. В отличие от аннотации <strong>JUnit 4</strong>, эта аннотация не объявляет никаких атрибутов, так как тестовые расширения в JUnit Jupiter работают на основе собственных специальных аннотаций. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ParameterizedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является параметризированным тестом. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RepeatedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является тестовым шаблоном для повторного теста. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestFactory</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является испытательным заводом для динамических тестов. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestTemplate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является шаблоном для тестовых случаев, предназначенных для вызова несколько раз в зависимости от количества контекстов вызова, возвращенных зарегистрированными поставщиками. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestMethodOrder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для настройки порядка выполнения тестового метода для аннотированного тестового класса; похож на <strong>JUnit 4&#8217;s</strong>. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestInstance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для настройки жизненного цикла экземпляра теста для аннотированного тестового класса. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DisplayName</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Объявляет пользовательское имя дисплея для тестового класса или метода тестирования. Такие аннотации не наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DisplayNameGeneration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Объявляет пользовательский генератор имен отображения для тестового класса. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeEach</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен перед каждым, или методом в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterEach</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен после каждого, или метода в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeAll</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен прежде всего, и методы в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются (если они не скрыты или переопределены)и должны быть (если не используется жизненный цикл "в каждом классе" экземпляра теста).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterAll</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен в конце концов, и методы в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются (если они не скрыты или переопределены)и должны быть (если не используется жизненный цикл "в каждом классе" экземпляра теста).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Nested</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный класс является нестатичным вложенным тестовым классом. и методы не могут быть использованы непосредственно в тестовом классе, если не используется жизненный цикл экземпляра теста "на класс". Такие аннотации не наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Tag</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для объявления тегов для фильтрации тестов, либо на уровне класса или метода; аналогично тестовым группам в <strong>TestNG</strong> или <strong>Categories</strong> в <strong>JUnit 4.</strong> Такие аннотации наследуются на уровне класса, но не на уровне метода.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Disabled</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для отключения тестового класса или метода тестирования; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие аннотации не наследуются.@Ignore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для неудачи теста, испытательного завода, шаблона тестирования или метода жизненного цикла, если его выполнение превышает данный срок. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ExtendWith</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для регистрации расширений декларативно. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RegisterExtension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для регистрации расширений программно через поля. Такие поля наследуются, если они не затенены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TempDir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для поставки временного каталога с помощью инъекций поля или инъекций параметра в метод жизненного цикла или метод тестирования; расположен в пакете <code>org.junit.jupiter.api.io</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Все основные аннотации находятся в <a href="https://junit-org.translate.goog/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/package-summary.html?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=ajax,elem,se"><strong>org.junit.jupiter.api</strong></a> пакете в <strong>junit-jupiter-api</strong> модуле.</p>
</div>
</div>
<div class="sect6">
<h7 id="_утверждения">Утверждения</h7>
<div class="paragraph">
<p><strong>JUnit 5</strong> поставляется со многими стандартными утверждениями, которые можно найти в классе <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/Assertions.html"><strong>org.junit.jupiter.api.Assertions</strong>.</a></p>
</div>
<div class="paragraph">
<p>Основные утверждения:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>assertEquals()</code>,</p>
</li>
<li>
<p><code>assertArrayEquals()</code>,</p>
</li>
<li>
<p><code>assertSame()</code>,</p>
</li>
<li>
<p><code>assertNotSame()</code>,</p>
</li>
<li>
<p><code>assertTrue()</code>,</p>
</li>
<li>
<p><code>assertFalse()</code>,</p>
</li>
<li>
<p><code>assertNull()</code>,</p>
</li>
<li>
<p><code>assertNotNull()</code>,</p>
</li>
<li>
<p><code>assertLinesMatch()</code>,</p>
</li>
<li>
<p><code>assertIterablesMatch()</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_mockito">Mockito</h5>
<div class="sect5">
<h6 id="_mockito_что_это_такое_и_зачем_нужно">Mockito: что это такое и зачем нужно</h6>
<div class="paragraph">
<p>Говоря коротко, <strong>Mockito</strong> – фреймворк для работы с заглушками.</p>
</div>
<div class="paragraph">
<p>Как известно, при <strong>тестировании кода</strong> (прежде всего <strong>юнит-тестировании</strong>, но не только) тестируемому элементу часто требуется предоставить экземпляры классов, которыми он должен пользоваться при работе.
При этом часто они не должны быть <strong>полнофункциональными</strong> – наоборот, от них требуется вести себя <strong>жёстко заданным образом</strong>, так, чтобы их поведение было <strong>простым и полностью предсказуемым</strong>.
Они и называются <strong>заглушками</strong> (<strong>stub</strong>).
Чтобы их получить, можно создавать альтернативные тестовые реализации интерфейсов, наследовать нужные классы с переопределением функционала и так далее, но всё это достаточно неудобно, избыточно и чревато ошибками.
Более удобное во всех смыслах решение – <strong>специализированные фреймворки</strong> для создания заглушек.
Одним из таковых (и, пожалуй, самым известным для <strong>Java</strong>) и является <strong>Mockito</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Mockito</strong> позволяет создать одной строчкой кода так называемый <strong>mock</strong> (что-то вроде основы для нужной заглушки) любого класса.
Для такого <strong>mock</strong> сразу после создания характерно некое поведение по умолчанию (<strong>все методы возвращают заранее известные значения</strong> — обычно это <strong>null</strong> либо <strong>0</strong>).
Можно переопределить это поведение желаемым образом, проконтролировать с нужной степенью детальности обращения к ним так далее.
В результате <strong>mock</strong> и становится заглушкой с требуемыми свойствами.</p>
</div>
<div class="paragraph">
<p>Также <strong>mock</strong> можно создать и для тех классов, новый экземпляр которых вообще-то так просто не создашь, в частности, классов с исключительно приватными конструкторами типа <strong>синглтонов</strong> и <strong>утилитных классов</strong>, а при минимальной настройке фреймворка — и перечислений (<strong>enums</strong>).</p>
</div>
<div class="paragraph">
<p>Наибольшее распространение получили следующие возможности <strong>Mockito</strong> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>создание заглушек для классов и интерфейсов;</p>
</li>
<li>
<p>проверка вызова метода и значений передаваемых методу параметров;</p>
</li>
<li>
<p>использование концепции «частичной заглушки», при которой заглушка создается на класс с определением поведения, требуемое для некоторых методов класса;</p>
</li>
<li>
<p>подключение к реальному классу «шпиона» spy для контроля вызова методов.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_mock_и_spy">Mock и Spy</h6>
<div class="paragraph">
<p>Центральный класс <strong>Mockito</strong>, через который предполагается обращаться к большей части функционала, — это, собственно, класс под названием <strong>Mockito</strong> (есть также класс <strong>BDDMockito</strong>, предоставляющий примерно те же возможности в форме, более подходящей для <a href="https://ru.wikipedia.org/wiki/BDD_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)"><strong>BDD</strong></a>.
Доступ к функционалу реализован через его <strong>статические методы</strong>.</p>
</div>
<div class="paragraph">
<p>Помните, что методы <strong>mock</strong> объекта возвращают значения по умолчанию: <strong>false</strong> для <strong>boolean</strong>, <strong>0</strong> для <strong>int</strong>, <strong>пустые коллекции</strong>, <strong>null</strong> для остальных объектов.
Для <strong>spy</strong> — значение, возвращаемое методом реального объекта.</p>
</div>
<div class="paragraph">
<p>Для того, чтобы отличить mock-объект от обычного в составе <strong>Mockito</strong> для этого есть инструмент — <strong>метод Mockito.mockingDetails</strong>.
Передав ему произвольный объект, получим объект класса <strong>MockingDetails</strong>.
Он содержит информацию о том, что этот объект представляет собой с точки зрения <strong>Mockito</strong>: является ли он <strong>mock</strong>, <strong>spy</strong> (см. ниже), как использовался, как был создан и прочее.</p>
</div>
<div class="paragraph">
<p>Поведение по умолчанию (и не только его) можно изменить при помощи функционала класса <strong>MockSettings</strong>, но это нечасто бывает нужно.</p>
</div>
<div class="paragraph">
<p>Чтобы создать <strong>Mockito</strong> объект можно использовать либо аннотацию <strong>@Mock</strong>, либо <strong>метод</strong> <strong>mock</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Mock
ICalculator mcalc;

ICalculator mcalc = Mockito.mock(ICalculator.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Однако, что если необходимо использовать в качестве заглушки объект реального класса с имеющимся функционалом, переопределив работу только части его методов?
На этот случай в <strong>Mockito</strong> есть так называемые <strong>spy</strong>, "шпионы".
В отличие от <strong>mock&#8217;ов</strong>, их можно создавать на основе как класса, так и готового объекта.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">DataService dataServiceSpy = Mockito.spy(DataService.class);
// or
DataService dataService = new DataService();
dataServiceSpy = Mockito.spy(dataService);</code></pre>
</div>
</div>
<div class="paragraph">
<p>При создании <strong>spy</strong> на основе класса, если его тип — интерфейс, будет создан обычный <strong>mock-объект</strong>, а если тип — класс, то <strong>Mockito</strong> попытается создать экземпляр при помощи конструктора по умолчанию (без параметров).
И только если такого конструктора нет, произойдёт ошибка и тест не сработает.</p>
</div>
</div>
<div class="sect5">
<h6 id="_управление_поведением">Управление поведением</h6>
<div class="paragraph">
<p>В целом управление поведением <strong>mock-объекта</strong> сводится к одной очевидной концепции: когда на mock так-то воздействовали (то есть вызван такой-то метод с такими-то аргументами), он должен отреагировать так-то и так-то.
У этой концепции существуют две реализации в рамках класса <strong>Mockito</strong> — основная, рекомендуемая разработчиками к использованию везде, где это возможно, и альтернативная, применяемая там, где основная не годится.</p>
</div>
<div class="paragraph">
<p>Основная реализация базируется на методе <strong>Mockito.when</strong>.
Этот метод принимает в качестве "параметра" вызов переопределяемого метода <strong>mock-объекта</strong> (таким образом фиксируется определяемое воздействие) и возвращает объект типа <strong>OngoingStubbing</strong>, позволяющий вызвать один из методов семейства <strong>Mockito.then</strong>&#8230;&#8203; (так задаётся реакция на это воздействие).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">//when(mock).thenReturn(value)

public interface DataService {
    void saveData(List&lt;String&gt; dataToSave);
    String getDataById(String id);
    String getDataById(String id, Supplier&lt;String&gt; calculateIfAbsent);
    List&lt;String&gt; getData();
    List&lt;String&gt; getDataListByIds(List&lt;String&gt; idList);
    List&lt;String&gt; getDataByRequest(DataSearchRequest request);
}
-----------------------------------------
List&lt;String&gt; data = new ArrayList&lt;&gt;();
data.add("dataItem");
Mockito.when(dataService.getAllData()).thenReturn(data);</code></pre>
</div>
</div>
<div class="paragraph">
<p>После этой операции, вызвав у объекта dataService метод getAllData(), получим объект, data.</p>
</div>
<div class="paragraph">
<p>Альтернативная реализация связывания условия и результата вызова — методы семейства <strong>Mockito.do</strong>&#8230;&#8203;. Эти методы позволяют задать поведение начиная с результата вызова и возвращают объект класса <strong>Stubber</strong>, уже при помощи которого можно задать условие.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">//doReturn(value).when(mock).method(params)

public interface DataService {
    List&lt;String&gt; getData();
}
-----------------------------------------
List&lt;String&gt; data = new ArrayList&lt;&gt;();
data.add("dataItem");
Mockito.doReturn(data).when(dataService).getData()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание: в первой реализации при задании поведения метода (в данном случае <strong>getAllData()</strong>) сначала выполняется вызов ещё не переопределённой его версии, и только потом, в недрах <strong>Mockito</strong>, происходит переопределение.
Во второй же такого вызова не происходит — методу <strong>Stubber.when</strong> передаётся непосредственно <strong>mock</strong>, а уже у возвращённого этим методом объекта того же типа, но другой природы совершается вызов переопределяемого метода.
Эта разница всё и определяет.
Связывание через <strong>Mockito.do&#8230;&#8203;</strong> никак не контролирует на стадии компиляции то, какой переопределяемый метод я вызову и совместим ли он по типу с заданным возвращаемым значением.</p>
</div>
<div class="sect6">
<h7 id="_задание_условий_вызова">Задание условий вызова</h7>
<div class="paragraph">
<p>Пример выше касается метода без параметров, и связанное с ним условие вызова возможно одно — сам факт вызова.
Как только появляются параметры, ситуация становится сложнее.
Как минимум, для вызова метода, поведение которого я задаю, мне нужно что-то ему передать.
Но важнее другое: может оказаться, что задаваемую реакцию я хочу получать не всегда, а только при вызове с параметрами, отвечающими определённым требованиям.
Если нужно задать реакцию на любой вызов этого метода независимо от аргументов, можно воспользоваться методом <strong>Mockito.any</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public interface DataService {
    String getDataItemById(String id);
-----------------------------------------
Mockito.when(dataService.getDataItemById(any()))
       .thenReturn("dataItem");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если же требуется, чтобы <strong>mock</strong> реагировал только на определённое значение аргумента, можно использовать непосредственно это значение или методы <strong>Mockito.eq</strong> (когда речь об эквивалентности) либо <strong>Mockito.same</strong> (когда требуется сравнение ссылок)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Mockito.when(dataService.getDataItemById("idValue"))
       .thenReturn("dataItem");
// or
Mockito.when(dataService.getDataItemById(Mockito.eq("idValue")))
       .thenReturn("dataItem");</code></pre>
</div>
</div>
<div class="paragraph">
<p>При работе с методами с более чем одним аргументом заданные требования комбинируются в соответствии с логическим И, то есть для получения заданного результата КАЖДЫЙ из аргументов должен отвечать поставленному требованию.</p>
</div>
<div class="paragraph">
<p>Кроме того, при задании поведения такого метода нельзя комбинировать использующие матчеры статические методы Mockito и прямую передачу значений.
Используйте <strong>Mockito.eq</strong> или Mockito.same</p>
</div>
</div>
<div class="sect6">
<h7 id="_задание_результатов_вызова">Задание результатов вызова</h7>
<div class="paragraph">
<p>После того, как метод <strong>mock-объекта</strong> вызван, объект должен отреагировать на вызов.
Основные возможные последствия — возвращение результата и выбрасывание исключения, и именно на эти варианты в первую очередь рассчитан инструментарий <strong>Mockito</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Mockito.when(dataService.getAllData()).thenReturn(data);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Также</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Mockito.when(dataService.getDataById("invalidId"))
       .thenThrow(new IllegalArgumentException());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Есть и другой способ: можно создать объект исключения и бросить непосредственно его, а можно предоставить <strong>Mockito</strong> только класс исключения, чтобы оно было создано автоматически.
В обоих случаях синтаксис позволяет использовать и <strong>checked</strong> исключения, однако <strong>Mockito</strong> не позволит запустить такой тест, если тип исключения не соответствует методу, который я хочу заставить бросить это исключение.</p>
</div>
<div class="paragraph">
<p>Выше варианты реакции подходят, если в ответ на вызов с заданными условиями нужно всегда возвращать определённое, всегда одно и то же значение результата или выбрасывать всегда одинаковое исключение.
Предположим, метод принимает коллекцию значений, а возвращает другую коллекцию значений, связанных с первыми одно к одному (например, это получение коллекции объектов данных по набору их ID), и в рамках теста необходимо использовать этот <strong>mock-объект</strong> неоднократно с разными наборами входных данных, получая каждый раз соответствующий результат.
В Mockito есть метод <strong>Mockito.thenAnswer</strong>, он же <strong>Mockito.then</strong>.
Он принимает реализацию функционального интерфейса <strong>Answer</strong>, единственный метод которого получает объект <strong>класса InvocationOnMock</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Mockito.when(dataService.getDataByIds(Mockito.any()))
       .thenAnswer(invocation -&gt; invocation
                .&lt;List&lt;String&gt;&gt;getArgument(0).stream()
                .map(id -&gt; {
                    switch (id) {
                        case "a":
                            return "dataItemA";
                        case "b":
                            return "dataItemB";
                        default:
                            return null;
                    }
                })
                .collect(Collectors.toList()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание: типобезопасности <strong>InvocationOnMock</strong> не обеспечивает — аргументы возвращаются либо в виде массива <strong>Object[]</strong>, либо <strong>generic</strong>-методом.</p>
</div>
<div class="paragraph">
<p>Отдельно стоит упомянуть ещё один вариант реакции — <strong>thenCallRealMethod</strong>.
Предназначение понятно из названия.
Он действует как для <strong>mock</strong>-, так и для <strong>spy</strong>-объектов.
В случае <strong>mock</strong> все поля объекта, к которым может обратиться код метода, будут опять-таки иметь значение <strong>null</strong>.
Для <strong>spy</strong> же использование <strong>thenCallRealMethod</strong> означает возвращение к поведению <strong>spy</strong> по умолчанию.</p>
</div>
<div class="paragraph">
<p>Методы <strong>thenReturn</strong> и <strong>thenThrow</strong> имеют перегруженные версии, принимающие <strong>varargs</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Mockito.when(dataService.getDataById("a"))
       .thenReturn("valueA1", "valueA2")
       .thenThrow(IllegalArgumentException.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь первый вызов метода с заданным параметром вернёт "valueA1, второй — "valueA2, а третий (и все последующие) будет вызывать выбрасывание <strong>IllegalArgumentException</strong>.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_слежение_за_вызовами_методов">Слежение за вызовами методов</h6>
<div class="paragraph">
<p>Метод <strong>verify</strong> позволяет проверить, была ли выполнена проверка с определенными параметрами.
Если проверка не выполнялась или выполнялась с другими параметрами, то <strong>verify</strong> вызовет исключение.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Mockito.verify(dataService).getDataById(Mockito.any());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Тест с такой конструкцией пройдёт успешно, если она находится после единственного за время выполнения теста вызова метода <strong>getDataById</strong>, и упадёт, если метод не был вызван или был вызван дважды и более.</p>
</div>
<div class="paragraph">
<p>Для проверки количества вызовов определенных методов Mockito предоставляет следующие методы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>atLeast(int min) - не меньше min вызовов;</p>
</li>
<li>
<p>atLeastOnce() - хотя бы один вызов;</p>
</li>
<li>
<p>atMost(int max) - не более max вызовов;</p>
</li>
<li>
<p>times(int cnt) - cnt вызовов;</p>
</li>
<li>
<p>never() - вызовов не было;</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Mockito.verify(dataService, Mockito.times(1)).getDataById(Mockito.any());</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_mock_объекты_как_значения_полей_и_аннотации_mockito">Mock-объекты как значения полей и аннотации Mockito</h6>
<div class="paragraph">
<p>Если в классе теста есть поля, которым я хочу присвоить <strong>mock-объекты</strong> в качестве значений, это не обязательно делать вручную — достаточно снабдить его аннотацией <strong>@Mock</strong>.</p>
</div>
<div class="paragraph">
<p>Для <strong>spy</strong> предусмотрена аннотация <strong>@Spy</strong> — она в целом аналогична <strong>@Mock</strong>… но для spy может использоваться объект, на основе которого он будет создан (несмотря на название, этот метод предназначен не только для <strong>mock&#8217;ов</strong>, а задействует также и все нижеперечисленные аннотации).
Такой объект можно сразу указать в качестве значения аннотируемого поля, но можно и не указывать — тогда <strong>spy</strong> будет создан на основе класса.</p>
</div>
<div class="paragraph">
<p>Есть аннотация <strong>@Captor</strong> для создания экземпляров <strong>ArgumentCaptor</strong>.</p>
</div>
<div class="paragraph">
<p>Ещё существует <strong>@InjectMocks</strong>.
Помеченное таким образом поле инициализируется настоящим объектом указанного класса.
Его поля по возможности проинициализированы значениями <strong>mock-полей</strong>, помеченных соответствующей аннотацией.
Для этого используется конструктор с наибольшим числом параметров, сеттеры и так далее.
Если какого-то объектного параметра конструктора не хватает, вместо него будет использован <strong>null</strong>, а вот параметр-примитив просто не позволит тесту сработать.
В целом это похоже на маленькую и простую (и всё равно не такую уж примитивную) реализацию <strong>dependency injection</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_откат_поведения_к_дефолтному_и_сессии_mockito">Откат поведения к дефолтному и сессии Mockito</h6>
<div class="paragraph">
<p>Чтобы привести все <strong>mock-объекты</strong> в состояние по умолчанию можно использовать методы <strong>Mockito.reset</strong> и <strong>Mockito.clearInvocations</strong>.
Оба принимают <strong>varargs</strong>, и передавать им нужно соответствующие <strong>mock&#8217;и</strong>.</p>
</div>
<div class="paragraph">
<p>Ещё одно решение — использовать так называемые <strong>сессии Mockito</strong>.
Именно его рекомендуют авторы.
В начале сессии все <strong>mock-объекты</strong> инициализируются, а после работы обязательно должно быть выполнено её окончание (хотя mock&#8217;и продолжают оставаться функциональными и после него).
Если я хочу создавать отдельную сессию для каждого тестового метода, то удобно создать поле типа MockitoSession, присвоить ему значение до вызова тестового метода и завершить сессию после.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Mock
DataService dataService;

MockitoSession session;

@BeforeMethod
public void beforeMethod() {
    session = Mockito.mockitoSession()
            .initMocks(this)
            .startMocking();
}

@Test
public void testMethod() {
    // some code using the dataService field
}

@AfterMethod
public void afterMethod() {
    session.finishMocking();
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_links">Links</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://ru.wikipedia.org/wiki/BDD_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)">Mockito и как его готовить</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/444982/">BDD (программирование)</a></p>
</li>
<li>
<p><a href="https://www.javadoc.io/doc/org.mockito/mockito-core/2.7.10/org/mockito/Mockito.html">Официальная документация Mockito</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%B2%D1%82%D0%BE%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%5D">Автотестирование</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sql">3. SQL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_основные_понятия_sql">3.1. Основные понятия SQL</h3>
<div class="paragraph">
<p><strong>SQL</strong> - это язык структурированных запросов, с помощью которого можно обрабатывать и извлекать данные из реляционных баз данных.</p>
</div>
<div class="paragraph">
<p><strong>SQL</strong> (<strong>Structured Query Language</strong> — <strong>язык структурированных запросов</strong>) - это непроцедурный язык программирования, используемый для работы с информацией реляционной базы данных, которая управляется соответствующей <strong>системой управления базами данных</strong> (<strong>СУБД</strong>).</p>
</div>
<div class="paragraph">
<p>Первоначально SQL был основным средством доступа пользователя к информации базы данных и позволял выполнять следующие операции с таблицами <strong>БД</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>создание новой таблицы;</p>
</li>
<li>
<p>добавление записей в таблицу;</p>
</li>
<li>
<p>изменение содержимого записей;</p>
</li>
<li>
<p>удаление записей из таблицы;</p>
</li>
<li>
<p>чтение записей из одной или нескольких таблиц;</p>
</li>
<li>
<p>изменение структур таблиц.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>По мере развития <strong>СУБД</strong> <strong>SQL</strong> усложнился и обогатился новыми конструкциями типа индексы, представления, триггеры, хранимые процедуры — и стал приобретать черты, свойственные языкам программирования.
Изначально <strong>SQL</strong> создавался как простой стандартизированный язык извлечения и управления данными, содержащимися в реляционной <strong>СУБД</strong>.
Но со временем он усложнился настолько, что превратился в инструмент разработчика, а не конечного пользователя.</p>
</div>
<div class="paragraph">
<p>Таким образом использование <strong>SQL</strong> сводится, по сути, к формированию всевозможных выборок строк и совершению операций над всеми записями, входящими в набор.</p>
</div>
<div class="paragraph">
<p><strong>SQL</strong> состоит из четырех отдельных частей (иногда разделяют на 5 частей):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>DDL</strong> (<strong>Data Definition Language</strong>) - язык определения данных; используется для определения структур хранящихся в <strong>БД</strong> данных.
Операторы <strong>DDL</strong> позволяют создавать, изменять и удалять объекты в <strong>БД</strong>.
Допустимые типы объектов зависят от используемой <strong>СУБД</strong> и обычно включают базы данных, пользователей, таблицы, представления, хранимые процедуры и ряд более вспомогательных объектов типа роли и индексы. <strong>Операторы DDL</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>CREATE SCHEMA</code> - создать схему БД</p>
</li>
<li>
<p><code>DROP SHEMA</code> - удалить схему БД;</p>
</li>
<li>
<p><code>CREATE TABLE</code> - создать таблицу;</p>
</li>
<li>
<p><code>ALTER TABLE</code> - изменить структуру таблицы;</p>
</li>
<li>
<p><code>DROP TABLE</code> - удалить таблицу;</p>
</li>
<li>
<p><code>CREATE DATABASE</code> - создать базу данных;</p>
</li>
<li>
<p><code>DROP DATABASE</code> - удалить базу данных;</p>
</li>
<li>
<p><code>CREATE SEQUENCE</code> - создать последовательность;</p>
</li>
<li>
<p><code>DROP SEQUENCE</code> - удалить последовательность;</p>
</li>
<li>
<p><code>CREATE VIEW</code> - создать представление;</p>
</li>
<li>
<p><code>DROP VIEW</code> - удалить представление;</p>
</li>
<li>
<p><code>CREATE INDEX</code> - создать индекс;</p>
</li>
<li>
<p><code>DROP INDEX</code> - удалить индекс;</p>
</li>
<li>
<p><code>CREATE CONSTRAINT</code> - создать ограничение (<strong>Primary Key</strong>, <strong>Foreign Key</strong>);</p>
</li>
<li>
<p><code>DROP CONSTRAINT</code> - удалить ограничение (<strong>Primary Key</strong>, <strong>Foreign Key</strong>).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>DML</strong> (<strong>Data Manipulation Language</strong>) - язык манипуляции данными; используется для извлечения, вставки, изменения и удаления данных в таблицах. <strong>Операторы DML</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>SELECT</code> - чтение инфомации (из одной или нескольких таблиц);</p>
</li>
<li>
<p><code>INSERT</code> - добавить строки в таблицу;</p>
</li>
<li>
<p><code>UPDATE</code> - изменить строки в таблице;</p>
</li>
<li>
<p><code>DELETE</code> - удалить строки в таблице;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>DCL</strong> (<strong>Data Control Language</strong>) - язык определения доступа к данным; используется для контроля доступа к информации БД. Операторы DCL определяют привилегии пользователя и позволяют выдавать и отбирать права на использование DDL и DML определенных операторов к определенным объектам БД. <strong>Операторы DCL</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>GRANT</code> - предоставление доступа пользователю или приложению на манипулирование объектами;</p>
</li>
<li>
<p><code>DENY</code> — явный запрет доступа для пользователя;</p>
</li>
<li>
<p><code>REVOKE</code> - отмена запрета или разрешения пользователя.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>TCL</strong> (<strong>Transaction Control Language</strong>) - язык управления транзакциями; используется для контроля обработки транзакций в БД. Операторы TCL включают, как правило, оператор commit для сохранения изменений, сделанных в ходе транзакции, и rollback для их отмены.
Оператор savepoint можно использовать для разбиения транзакции на несколько частей, и, в зависимости от определенных условий, часть из них "откатить". <strong>Операторы TCL</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>BEGIN TRANSACTION</code> — начать транзакцию;</p>
</li>
<li>
<p><code>COMMIT</code> - зафиксировать внесенные изменения;</p>
</li>
<li>
<p><code>ROLLBACK</code> - откатить внесенные изменения.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Необходимо отметить, что SQL реализует декларативную парадигму программирования: с помощью данного языка пользователь описывает запрос, а СУБД принимает решение, как этот запрос выполнить, т.е. планирует элементарные операции, необходимые для выполнения данного запроса.</p>
</div>
<div class="sect3">
<h4 id="_create_database_and_schema">3.1.1. Create Database and Schema</h4>
<div class="paragraph">
<p><strong>Схема</strong>/<strong>Schema</strong> с точки зрения <strong>базы данных</strong> представляет собой контейнер объектов типа таблиц, триггеров, хранимых процедур и т.п. Но стоит рассмотреть некоторые особенности для следующих <strong>СУБД</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>PostgreSQL</strong>: <strong>Schema</strong> создается внутри объекта <strong>Database</strong>. <em>Сервер может управлять несколькими базами данных, каждая из которых может включать несколько схем</em>. То есть, <em>схема не связана с учетной записью пользователя</em>.</p>
</li>
<li>
<p><strong>MariaDB</strong>: понятие <strong>Schema</strong> имеет тождественный смысл с <strong>Database</strong>. <em>*База данных* (<strong>Database</strong>) является контейнером объектов, к которым пользователь получает доступ</em>.</p>
</li>
<li>
<p><strong>SQL Server</strong>: в Microsoft SQL Server начиная с версии 2005 <em>жесткая связь между пользователями и схемами была отменена</em>. <em>Пользователи могут получить доступ на выполнение определенных операций с объектами схемы: чтение, запись, обновление или выполнение</em>.</p>
</li>
<li>
<p><strong>Oracle® Database</strong>: <em>*Schema* привязывается к пользователю</em>, т.е. наименование схемы, как правило, является учетной записью пользователя. <em>*Схема* создается при создании пользователем первого объекта, и все последующие объекты созданные этим пользователем становятся частью этой схемы</em>. Кроме этого <em>Oracle позволяет создавать <strong>схему</strong> как контейнер одновременно с объектами <strong>базы данных</strong></em>.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_оператор_create_database">Оператор <code>CREATE DATABASE</code></h5>
<div class="paragraph">
<p>Оператор <code>CREATE DATABASE</code> используется для создания новой базы данных SQL.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE DATABASE databasename;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор SQL создает базу данных с именем <code>invoice</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE DATABASE invoice;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_оператор_drop_database">Оператор <code>DROP DATABASE</code></h5>
<div class="paragraph">
<p>Оператор <code>DROP DATABASE</code> используется для удаления существующей базы данных SQL.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP DATABASE databasename;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор SQL уничтожает существующую базу данных <code>info</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP DATABASE info;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_типы_данных">3.1.2. Типы данных</h4>
<div class="paragraph">
<p><strong>Тип данных</strong> — это атрибут, который определяет тип любого объекта. <strong>SQL</strong> предлагает шесть категорий типов данных для использования.</p>
</div>
<div class="sect4">
<h5 id="_точные_типы_числовых_данных">Точные типы числовых данных</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Тип данных</th>
<th class="tableblock halign-left valign-top">Возможные значения</th>
<th class="tableblock halign-left valign-top">Примечание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code> или <code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Фактически является аналогом булевого типа в языках программирования. Занимает 1 байт.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TINYINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>0</code> до <code>255</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Занимает 1 байт. Хорошо подходит для хранения небольших чисел.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SMALLINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>–32 768</code> до <code>32 767</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Занимает 2 байта</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>–2 147 483 648</code> до <code>2 147 483 647</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Занимает 4 байта. Наиболее используемый тип для хранения чисел.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BIGINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>-9 223 372 036 854 775 808</code> до <code>9 223 372 036 854 775 807</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Занимают в памяти 8 байт.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DECIMAL</code></p></td>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock">Хранит числа с фиксированной точностью. Занимает от 5 до 17 байт в зависимости от количества чисел после запятой. Данный тип может принимать два параметра <code>precision</code> и <code>scale</code>: <code>DECIMAL(precision, scale)</code>. Параметр <code>precision</code> представляет максимальное количество цифр, которые может хранить число. Это значение должно находиться в диапазоне от <code>1</code> до <code>38</code>. По умолчанию оно равно <code>18</code>. Параметр <code>scale</code> представляет максимальное количество цифр, которые может содержать число после запятой. Это значение должно находиться в диапазоне от <code>0</code> до значения параметра <code>precision</code>. По умолчанию оно равно <code>0</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MONEY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Дробные значения от <code>-922 337 203 685 477.5808</code> до <code>922 337 203 685 477.5807</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Представляет денежные величины и занимает 8 байт.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SMALLMONEY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Хранит дробные значения от <code>-214 748.3648</code> до <code>214 748.3647</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Предназначено для хранения денежных величин. Занимает 4 байта. Эквивалентен типу <code>DECIMAL(10,4)</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Хранит числа от <code>–1.79E+308</code> до <code>1.79E+308</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Занимает от 4 до 8 байт в зависимости от дробной части.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>–340E+38</code> to <code>3.40E+38</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Занимает 4 байта. Эквивалентен типу <code>FLOAT(24)</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Если необходимо получать из базы данных числовое значение в строго указанном формате, то для этого следует выбрать один из точных числовых типов данных.</p>
</div>
</div>
<div class="sect4">
<h5 id="_примерные_типы_числовых_данных">Примерные типы числовых данных</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Тип данных</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возможные значения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>-1.79E + 308</code>, до <code>1.79E + 308</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>real</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>-3.40E + 38</code>, до <code>3.40E + 38</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Некоторые числа нельзя точно представить в десятичном виде с ограниченным числом знаков, например, одну треть или число пи. Для записи таких чисел используются действительный (<code>real</code>) или плавающий (<code>float</code>) типы данных. Данные действительного типа хранятся с точностью от 1 до 7 знаков. Плавающий формат, который иногда называют еще форматом двойной точности, может хранить числа, содержащие от 8 до 15 значащих цифр. Действительный и плавающий типы данных применяются в научных приложениях для хранения чисел, не требующих точного двоичного выражения. Одна-две последние цифры могут не вполне точно сохраняться при преобразованиях в двоичный формат.</p>
</div>
</div>
<div class="sect4">
<h5 id="_типы_данных_даты_и_времени">Типы данных даты и времени</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Тип данных</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Примечание</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>datetime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>1 января 1753</code>, до <code>31 декабря, 9999</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>smalldatetime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">От <code>1 января 1900</code>, до <code>6 июня 2079</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сохраняет дату, как <code>30 июня 1991 года</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сохраняет время суток, как <code>12:30</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Для дат применяются два типа данных, <code>datetime</code> и <code>smalldatetime</code>. Тип данных <code>smalldatetime</code> охватывает период времени от 1 января 1900 года до 6 июня 2079 года и включает время с точностью до минуты. Такого диапазона достаточно для подавляющего большинства проектов. Тип данных <code>datetime</code> годен для использования до 31 декабря 9999 года (это следует учитывать при решении проблемы 10К года).</p>
</div>
</div>
<div class="sect4">
<h5 id="_типы_данных_символьных_строк">Типы данных символьных строк</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Тип данных</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возможные значения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 8000 символов. (Фиксированная длина без Unicode символов)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>varchar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимум 8000 символов. (Переменная длина данных не-Unicode).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>text</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Переменная длина данных, не Unicode с максимальной длиной 2147483647 символов.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>К этому типу относятся такие символьные данные, как имена или адреса. Можно выбрать символьный тип данных либо фиксированной длины, <code>char</code>, либо переменной длины, <code>varchar</code>. Фиксированный размер оказывается предпочтительным в тех случаях, когда данные имеют одинаковую или сходную длину, например, при вводе идентификатора автора (часто в этом качестве используют индивидуальный номер системы социальной безопасности). В большинстве ситуаций применение переменной длины данных не приводит к сколько-нибудь заметному увеличению времени обработки. В то же время фамилия автора может быть очень длинной, так что использование типа <code>varchar</code> оказывается вполне оправданным. Применительно к подавляющему большинству фамилий фиксированная длина поля означает потерю значительного объема памяти, поэтому лучше использовать тип данных varchar. При выборе того или иного типа данных всегда следует искать компромисс с учетом двух аспектов: с одной стороны, потери полезного объема памяти при использовании данных фиксированной длины, а с другой стороны, увеличения времени обработки в случае применения данных переменной длины.</p>
</div>
</div>
<div class="sect4">
<h5 id="_типы_строк_данных_символов_unicode">Типы строк данных символов Unicode</h5>
<div class="paragraph">
<p><strong>Юникод</strong> (англ. <strong>Unicode</strong>) — стандарт кодирования символов, включающий в себя знаки почти всех письменных языков мира.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Тип данных</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возможные значения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nchar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 4000 символов. (Фиксированная длина Unicode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nvarchar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 4000 символов. (Переменная длина Unicode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nvarchar(max)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 231 символов (SQL Server 2005). (Переменная длина Unicode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ntext</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 1,073,741,823 символа. (Переменная длина Unicode)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>SQL Server 7.0 поддерживает набор символов Unicode.
В связи с этим, чтобы воспользоваться всеми преимуществами, предоставляемыми расширенными возможностями Unicode, необходимо было ввести дополнительный тип данных. Если необходимо использовать символьные данные Unicode, то следует указать тип данных <code>Nchar</code> или, если это информация переменной длины, то <code>Nvarchar</code>. При вводе данных Unicode их следует заключать в одиночные кавычки, причем непосредственно перед ними необходимо поставить заглавную латинскую букву N. Ограничение максимальной длины информации при работе с типом данных Unicode составляет 4000 знаков. Это объясняется тем, что для хранения каждого символа Unicode требуется два байта памяти. Поэтому на стандартную страницу памяти размером 8К можно поместить в два раза меньше символов Unicode, чем при использовании обычных символов.</p>
</div>
</div>
<div class="sect4">
<h5 id="_двоичные_типы_данных">Двоичные типы данных</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Тип данных</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возможные значения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 8000 байт (фиксированная длина двоичных данных)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>varbinary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 8000 байт.(Переменная длина двоичных данных)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>varbinary(max)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 231 байт (SQL Server 2005).(Переменная длина двоичных данных)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>image</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Максимальная длина 2147483647 байт.(Переменная длина двоичных данных)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Если в базе данных необходимо хранить двоичную информацию, имеется выбор между двумя форматами представления: с фиксированной или переменной длиной. Данным фиксированной длины соответствует тип данных <code>binary</code>, а двоичным данным переменной длины соответствует тип данных <code>varbinary</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_таблицы">3.1.3. Таблицы</h4>
<div class="sect4">
<h5 id="_создание_таблицы_create_table">Создание таблицы <code>CREATE TABLE</code></h5>
<div class="paragraph">
<p>Для того чтобы создать таблицу в <strong>SQL</strong>, используется выражение <code>CREATE TABLE</code>. Оно принимает в качестве параметров все колонки, которые необходимо внести, а также их типы данных. Пример создания таблицы с названием <code>Months</code>, в которой будет три колонки:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code> - порядковый номер месяца (целочисленный тип или <code>int</code>).</p>
</li>
<li>
<p><code>name</code> - название месяца.</p>
</li>
<li>
<p><code>days</code> - число дней в конкретном месяце.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Код создания будет выглядеть следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE months (id int, name varchar(10), days int);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_запрос_drop_table">Запрос <code>DROP TABLE</code></h5>
<div class="paragraph">
<p>Оператор <code>DROP TABLE</code> используется для удаления существующей таблицы в базе данных.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP TABLE table_name;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_удаление_таблиц_при_помощи_truncate">Удаление таблиц при помощи <code>TRUNCATE</code></h5>
<div class="paragraph">
<p>Если необходимо все данные из таблицы, но при этом оставить саму таблицу, следует использовать команду <code>TRUNCATE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">TRUNCATE TABLE table_name;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ограничения">3.1.4. Ограничения</h4>
<div class="paragraph">
<p><strong>Ограничения</strong> могут быть указаны при создании таблицы с помощью оператора <code>CREATE TABLE</code> или после создания таблицы с помощью инструкции <code>ALTER TABLE</code>.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE table_name (
    column1 datatype constraint,
    column2 datatype constraint,
    column3 datatype constraint,
    ....
);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>SQL-ограничения</strong> используются для указания правил данных таблицы, для ограничения типа данных, которые могут входить в таблицу. Это обеспечивает точность и надежность данных в таблице. Если между ограничением и действием данных существует какое-либо нарушение, действие прерывается.</p>
</div>
<div class="paragraph">
<p>Ограничения могут быть уровнями столбцов или таблиц. Ограничения уровня столбца применяются к столбцу, а ограничения уровня таблиц относятся ко всей таблице.</p>
</div>
<div class="paragraph">
<p>В SQL обычно используются следующие ограничения:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NOT NULL</code> - гарантирует, что столбец не может иметь значение NULL</p>
</li>
<li>
<p><code>UNIQUE</code> - обеспечивает, чтобы все значения в столбце были разными</p>
</li>
<li>
<p><code>PRIMARY KEY</code> - комбинация NOT NULL и UNIQUE. Уникально идентифицирует каждую строку в таблице</p>
</li>
<li>
<p><code>FOREIGN KEY</code> - однозначно идентифицирует строку / запись в другой таблице</p>
</li>
<li>
<p><code>CHECK</code> - обеспечивает, чтобы все значения в столбце удовлетворяли конкретному условию</p>
</li>
<li>
<p><code>DEFAULT</code> - устанавливает значение по умолчанию для столбца, если не указано значение</p>
</li>
<li>
<p><code>INDEX</code> - используется для быстрого создания и извлечения данных из базы данных</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ограничение_not_null">Ограничение <code>NOT NULL</code></h5>
<div class="paragraph">
<p>По умолчанию столбец может содержать значения <code>NULL</code>. Ограничение <code>NOT NULL</code> приводит к тому, что столбец НЕ принимает значения <code>NULL</code>. Это приводит к тому, что поле всегда содержит значение, а это означает, что нельзя вставить новую запись или обновить запись без добавления значения в это поле.</p>
</div>
<div class="paragraph">
<p>Следующий SQL-запрос гарантирует, что столбцы <code>user_id</code>, <code>name</code> и <code>fullname</code> НЕ будут принимать значения <code>NULL</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users
(
    user_id int NOT NULL,
    name varchar(255) NOT NULL,
    fullname varchar(255) NOT NULL,
    balanse int
);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ограничение_unique">Ограничение <code>UNIQUE</code></h5>
<div class="paragraph">
<p>Ограничение <code>UNIQUE</code> гарантирует, что все значения в столбце отличаются. Ограничения <code>UNIQUE</code> и <code>PRIMARY KEY</code> гарантируют уникальность столбца или набора столбцов. Ограничение <code>PRIMARY KEY</code> автоматически имеет ограничение <code>UNIQUE</code>.</p>
</div>
<div class="paragraph">
<p>Однако для каждой таблицы может быть множество ограничений <code>UNIQUE</code>, но только одно ограничение <code>PRIMARY KEY</code> для каждой таблицы.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users
(
    user_id int NOT NULL,
    name varchar(255) NOT NULL,
    fullname varchar(255),
    gender int,
    UNIQUE (user_id)
);</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_создание_ограничения_unique_когда_таблица_уже_создана">Создание ограничения <code>UNIQUE</code> когда таблица уже создана</h6>
<div class="paragraph">
<p>Чтобы создать ограничение <code>UNIQUE</code> в столбце <code>user_id</code>, когда таблица уже создана, используйте следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ADD UNIQUE (user_id);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы назвать ограничение <code>UNIQUE</code> и определить ограничение <code>UNIQUE</code> для нескольких столбцов, используйте следующий синтаксис:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ADD CONSTRAINT UC_Users UNIQUE (user_id, name);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_ограничения_unique">Удаление ограничения <code>UNIQUE</code></h6>
<div class="paragraph">
<p>Чтобы удалить ограничение <code>UNIQUE</code>, используйте следующий SQL-запрос:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
DROP INDEX UC_Users;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ограничение_primary_key">Ограничение <code>PRIMARY KEY</code></h5>
<div class="paragraph">
<p>Ограничение <code>PRIMARY KEY</code> однозначно идентифицирует каждую запись в таблице базы данных. Первичные ключи должны содержать <code>UNIQUE</code> значения и не могут содержать значения <code>NULL</code>.
В таблице может быть только один первичный ключ, который может состоять из одного или нескольких полей.</p>
</div>
<div class="sect5">
<h6 id="_создание_primary_key_при_создании_таблицы">Создание <code>PRIMARY KEY</code> при создании таблицы</h6>
<div class="paragraph">
<p>Следующий SQL-запрос создает <code>PRIMARY KEY</code> в столбце <code>user_id</code>, когда создается таблица <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users
(
    user_id int NOT NULL,
    name varchar(255) NOT NULL,
    fullname varchar(255),
    gender int,
    PRIMARY KEY (user_id)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы разрешить именовать ограничение <code>PRIMARY KEY</code> и определить ограничение <code>PRIMARY KEY</code> для нескольких столбцов, используйте следующий синтаксис SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users
(
    user_id int NOT NULL,
    name varchar(255) NOT NULL,
    fullname varchar(255),
    gender int,
    CONSTRAINT PK_Users PRIMARY KEY (user_id, name)
);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_создание_ограничения_primary_key_когда_таблица_уже_создана">Создание ограничения <code>PRIMARY KEY</code> когда таблица уже создана</h6>
<div class="paragraph">
<p>Чтобы создать ограничение <code>PRIMARY KEY</code> в столбце <code>user_id</code>, когда таблица уже создана, используйте следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ADD PRIMARY KEY (user_id);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы разрешить именовать ограничение <code>PRIMARY `KEY</code> и определить ограничение <code>PRIMARY KEY</code> для нескольких столбцов, используйте следующий синтаксис:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ADD CONSTRAINT PK_Users PRIMARY KEY (user_id, name);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_ограничения_primary_key">Удаление ограничения `PRIMARY KEY</h6>
<div class="paragraph">
<p>Чтобы удалить ограничение <code>PRIMARY KEY</code>, используйте следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
DROP PRIMARY KEY;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ограничение_foreign_key">Ограничение <code>FOREIGN KEY</code></h5>
<div class="paragraph">
<p><code>FOREIGN KEY</code> - это <strong>ключ</strong>, используемый для соединения двух таблиц вместе. Является полем (или набором полей) в одной таблице, которое ссылается на <code>PRIMARY KEY</code> в другой таблице.</p>
</div>
<div class="paragraph">
<p>Таблица, содержащая внешний ключ, называется дочерней таблицей, а таблица, содержащая ключ-кандидат, называется <strong>ссылочной</strong> или <strong>родительской таблицей</strong>.</p>
</div>
<div class="sect5">
<h6 id="_создание_foreign_key_при_создании_таблицы">Создание <code>FOREIGN KEY</code> при создании таблицы</h6>
<div class="paragraph">
<p>Следующий SQL-запрос создает <code>FOREIGN KEY</code> в столбце <code>user_id</code> при создании таблицы <code>invoice</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE invoice
(
    invoice_id int NOT NULL,
    number int NOT NULL,
    user_id int,
    PRIMARY KEY (invoice_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы разрешить именовать ограничение <code>FOREIGN KEY</code> и определять ограничение <code>FOREIGN KEY</code> для нескольких столбцов, используйте следующий синтаксис SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE invoice
(
    invoice_id int NOT NULL,
    number int NOT NULL,
    user_id int,
    PRIMARY KEY (invoice_id),
    CONSTRAINT FK_UserInvoice FOREIGN KEY (user_id)
    REFERENCES Users(user_id)
);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_создание_ограничения_foreign_key_когда_таблица_уже_создана">Создание ограничения <code>FOREIGN KEY</code> когда таблица уже создана</h6>
<div class="paragraph">
<p>Чтобы создать ограничение <code>FOREIGN KEY</code> в столбце <code>user_id</code>, когда таблица <code>invoice</code> уже создана, используйте следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE invoice
ADD FOREIGN KEY (user_id) REFERENCES Users(user_id);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы разрешить именовать ограничение <code>FOREIGN KEY</code> и определять ограничение <code>FOREIGN KEY</code> для нескольких столбцов, используйте следующий синтаксис:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE invoice
ADD CONSTRAINT FK_UsersInvoice
FOREIGN KEY (user_id) REFERENCES Users(user_id);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_ограничения_foreign_key">Удаление ограничения <code>FOREIGN KEY</code></h6>
<div class="paragraph">
<p>Чтобы удалить ограничение <code>FOREIGN KEY</code>, используйте следующий:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE invoice
DROP FOREIGN KEY FK_UsersInvoice;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ограничение_check">Ограничение <code>CHECK</code></h5>
<div class="paragraph">
<p>Ограничение <code>CHECK</code> используется для ограничения диапазона значений, который может быть помещен в столбец.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Если определяется ограничение <code>CHECK</code> для одного столбца, оно допускает только определенные значения для этого столбца.</p>
</li>
<li>
<p>Если определяется ограничение <code>CHECK</code> для таблицы, оно может ограничить значения в определенных столбцах на основе значений в других столбцах в строке.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_создание_ограничения_check_при_создании_таблицы">Создание ограничения <code>CHECK</code> при создании таблицы</h6>
<div class="paragraph">
<p>Следующий SQL-запрос создает ограничение <code>CHECK</code> в столбце <code>age</code>, когда создается таблица <code>users</code>. Ограничение <code>CHECK</code> гарантирует, не может быть пользователя с возрастом старше 60 лет:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users
(
    user_id int NOT NULL,
    name varchar(255) NOT NULL,
    fullname varchar(255),
    age int,
    CHECK (age&gt;=60)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы разрешить именовать ограничение <code>CHECK</code> и определить ограничение <code>CHECK</code> для нескольких столбцов, используйте следующий синтаксис SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users
(
    user_id int NOT NULL,
    name varchar(255) NOT NULL,
    fullname varchar(255),
    age int,
    balance int,
    CONSTRAINT CHK_Users CHECK (age&gt;=60 AND balance = 500)
);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_создание_ограничения_check_когда_таблица_уже_создана">Создание ограничения <code>CHECK</code> когда таблица уже создана</h6>
<div class="paragraph">
<p>Чтобы создать ограничение <code>CHECK</code> в столбце <code>age</code>, когда таблица уже создана, используйте следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ADD CHECK (age&gt;=60);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы разрешить именовать ограничение <code>CHECK</code> и определить ограничение <code>CHECK</code> для нескольких столбцов, используйте следующий синтаксис:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ADD CONSTRAINT CHK_UsersAge CHECK (age&gt;=60 AND country='Spain');</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_drop_check"><code>DROP CHECK</code></h6>
<div class="paragraph">
<p>Чтобы удалить ограничение <code>CHECK</code>, используйте следующий SQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
DROP CHECK CHK_UsersAge;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ограничение_default">Ограничение <code>DEFAULT</code></h5>
<div class="paragraph">
<p>Ограничение <code>DEFAULT</code> используется для предоставления значения по умолчанию для столбца. Значение по умолчанию будет добавлено ко всем новым записям, если другое значение не указано.</p>
</div>
<div class="sect5">
<h6 id="_установка_default_столбца_при_создании_таблицы">Установка <code>DEFAULT</code> столбца при создании таблицы</h6>
<div class="paragraph">
<p>Следующий SQL-запрос устанавливает значение <code>DEFAULT</code> для столбца <code>country</code>, когда создается таблица <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users
(
    user_id int NOT NULL,
    name varchar(255) NOT NULL,
    fullname varchar(255),
    gender int,
    country varchar(255) DEFAULT 'Spain'
);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_установка_default_столбца_в_уже_созданной_таблице">Установка <code>DEFAULT</code> столбца в уже созданной таблице</h6>
<div class="paragraph">
<p>Чтобы создать ограничение <code>DEFAULT</code> в столбце <code>country</code>, когда таблица уже создана, используйте следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ALTER country SET DEFAULT 'Spain';</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_ограничения_default">Удаление ограничения <code>DEFAULT</code></h6>
<div class="paragraph">
<p>Чтобы удалить ограничение <code>DEFAULT</code>, используйте следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ALTER country DROP DEFAULT;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_изменение_структуры_таблицы">3.1.5. Изменение структуры таблицы</h4>
<div class="paragraph">
<p>Оператор <code>ALTER TABLE</code> используется для добавления, удаления или изменения столбцов в существующей таблице, а также для добавления и удаления различных ограничений для существующей таблицы.</p>
</div>
<div class="sect4">
<h5 id="_alter_table_add_column"><code>ALTER TABLE - ADD Column</code></h5>
<div class="paragraph">
<p>Чтобы добавить столбец в таблицу, используйте следующий синтаксис:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE table_name
ADD column_name datatype;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_alter_table_drop_column"><code>ALTER TABLE - DROP COLUMN</code></h5>
<div class="paragraph">
<p>Чтобы удалить столбец в таблице, используйте следующий синтаксис, обратите внимание, что некоторые системы баз данных не позволяют удалить столбец:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE table_name
DROP COLUMN column_name;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_alter_table_altermodify_column"><code>ALTER TABLE - ALTER/MODIFY COLUMN</code></h5>
<div class="paragraph">
<p>Чтобы изменить тип данных столбца в таблице, используйте следующий синтаксис:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE table_name
ALTER COLUMN column_name datatype;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE table_name
MODIFY COLUMN column_name datatype;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_изменить_тип_данных">Изменить тип данных</h5>
<div class="paragraph">
<p>Изменим тип данных столбца с именем <code>day_birth</code> в таблице <code>users</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
ALTER COLUMN day_birth year;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_пример_drop_column">Пример <code>DROP COLUMN</code></h5>
<div class="paragraph">
<p>Для удаления столбца <code>day_birth</code> в таблице <code>users</code> используется следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users
DROP COLUMN day_birth;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_однострочные_и_многострочные_комментарии">3.1.6. Однострочные и многострочные комментарии</h4>
<div class="paragraph">
<p>Комментарии используются для пояснения разделов операторов SQL или для предотвращения выполнения операторов во время отладки запросов.</p>
</div>
<div class="sect4">
<h5 id="_однострочные_комментарии">Однострочные комментарии</h5>
<div class="paragraph">
<p>Однострочные комментарии начинаются со знака <code>-</code>. Любой текст между <code>-</code> и концом строки будет проигнорирован (не будет выполнен).</p>
</div>
<div class="paragraph">
<p>В следующем примере в качестве объяснения используется однострочный комментарий:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">-- Select all:
SELECT * FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В следующем примере используется однострочный комментарий для игнорирования конца строки:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * FROM users -- WHERE balance = 1000;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В следующем примере используется однострочный комментарий для игнорирования оператора:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">-- SELECT * FROM users
SELECT * FROM users;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_многострочные_комментарии">Многострочные комментарии</h5>
<div class="paragraph">
<p>Многострочные комментарии начинаются с <code>/</code> и заканчиваются на <code>/</code>. Любой текст между <code>/</code> и <code>/</code> будет проигнорирован. В следующем примере в качестве объяснения используется многострочный комментарий:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">/* Этот запрос
выведет данные
всех пользователей */

SELECT * FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В следующем примере используется многострочный комментарий для игнорирования многих операторов:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">/*SELECT * FROM users;
SELECT * FROM product;
SELECT * FROM invoice;*/

SELECT * FROM category;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_манипуляция_данными">3.2. Манипуляция данными</h3>
<div class="sect3">
<h4 id="_добавление_записи_в_таблицу_insert_into">3.2.1. Добавление записи в таблицу (<code>INSERT INTO</code>)</h4>
<div class="paragraph">
<p><code>INSERT INTO</code> - этот запрос используется для добавления двумя разными способами новых строк данных в таблицу в базе данных.</p>
</div>
<div class="paragraph">
<p><strong>Способ первый:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">INSERT INTO months
VALUES (1, 'January', 31);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот способ не подразумевает указания названий колонок, а лишь принимает значения в том порядке, в котором они указаны в таблице. Однако, если в будущем необходимо добавить дополнительные колонки, все предыдущие запросы работать не будут.</p>
</div>
<div class="paragraph">
<p>Для решения данной проблемы следует использовать <strong>второй способ</strong>. Его суть заключается в том, что перед вводом данных указываются названия колонок.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">INSERT INTO months (id, name, days)
VALUES (2, 'February', 29);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_выборка_записей_из_таблицы_select">3.2.2. Выборка записей из таблицы (<code>SELECT</code>)</h4>
<div class="sect4">
<h5 id="_простая_выборка_select">Простая выборка (<code>SELECT</code>)</h5>
<div class="paragraph">
<p><code>SELECT</code> - используется для выбора данных из базы данных. Возвращаемые данные сохраняются в таблице результатов, называемой результирующим набором.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM characters;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Результатом данного запроса будет таблица со всеми данными в таблице <code>characters</code>. Знак звёздочки (<code>*</code>) означает то, что необходимо показать все столбцы из таблицы без исключений. Так как в базе данных обычно больше одной таблицы, нам необходимо указывать название таблицы, данные из которой требуется посмотреть. Сделать это можно используя ключевое слово <code>FROM</code>.</p>
</div>
<div class="paragraph">
<p>Когда необходимы лишь некоторые столбцы из таблицы, то можно указать их имена через запятую вместо звёздочки.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name, weapon
FROM characters;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_выборка_уникальных_select_distinct">Выборка уникальных (<code>SELECT DISTINCT</code>)</h5>
<div class="paragraph">
<p>Оператор <code>SELECT DISTINCT</code> используется для возврата только отдельных (разных) значений. Внутри таблицы столбец часто содержит много повторяющихся значений и вам нужно только перечислить отличающиеся значения.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT DISTINCT column1, column2, ...
FROM table_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор SQL выбирает только значения <code>DISTINCT</code> из столбца <code>name</code> в таблице <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT DISTINCT name
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор SQL выбирает только значения <code>DISTINCT</code> по столбцам <code>name</code>, <code>age</code> в таблице <code>users</code>, т.е. уникальное сочетание <code>name</code> + <code>age</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT DISTINCT name, age
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В следующем SQL-заявлении указано количество разных имен пользователей:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT COUNT(DISTINCT name)
FROM users;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_выборка_с_условием_where">3.2.3. Выборка с условием (<code>WHERE</code>)</h4>
<div class="paragraph">
<p><code>WHERE</code> - это запрос позволяющий включить в вывод лишь некоторые конкретные строки. Данное ключевое слово позволяет фильтровать данные по определённому условию.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column1, column2, ...
FROM table_name
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример предложения</strong>, следующий оператор SQL выбирает всех пользователей с именем <code>name</code> в таблице <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE name = 'Tom';</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Следует отметить, что <strong>SQL</strong> требует одинарных кавычек вокруг текстовых значений (большинство систем баз данных также допускают двойные кавычки). Однако числовые поля не должны быть заключены в кавычки.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_операторы_в_разделе_where">Операторы в разделе <code>WHERE</code></h5>
<div class="paragraph">
<p>Следующие операторы могут использоваться в предложении <code>WHERE</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Заголовок</strong></th>
<th class="tableblock halign-left valign-top"><strong>Группа</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!=</code> или <code>&lt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Не равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Больше чем</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Меньше чем</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Больше или равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Меньше или равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BETWEEN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Между включенным диапазоном</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIKE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Поиск по шаблону</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Поиск данных по нескольким значениям, перечисленным через запятую</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_операторы_and_or_и_not">Операторы <code>AND</code>, <code>OR</code> и <code>NOT</code></h5>
<div class="paragraph">
<p>Предложение <code>WHERE</code> может быть объединено с операторами <code>AND</code>, <code>OR</code> и <code>NOT</code>. Операторы <code>AND</code> и <code>OR</code> используются для фильтрации записей на основе более чем одного условия:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Оператор <code>AND</code> отображает запись, если все условия, разделенные символом <code>AND</code>, имеют значение <code>true</code>.</p>
</li>
<li>
<p>Оператор <code>OR</code> отображает запись, если любое из условий, разделенных <code>OR</code>, является <code>true</code>.</p>
</li>
<li>
<p>Оператор <code>NOT</code> отображает запись, если условие (и) <strong>false</strong>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_оператор_and">Оператор <code>AND</code></h6>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column1, column2, ...
FROM table_name
WHERE condition1 AND condition2 AND condition3 ...;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор SQL выбирает все поля из <code>users</code>, где пол <code>gender</code> равен <code>F</code> (<em>Female</em>), а баланс <code>balance</code> больше или равен <code>1000</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE gender = 'F'
  AND balance &gt;= 1000;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_оператор_or">Оператор <code>OR</code></h6>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column1, column2, ...
FROM table_name
WHERE condition1 OR condition2 OR condition3 ...;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор SQL выбирает все поля из <code>users</code>, где баланс пользователя <code>balance</code> равен <code>1000</code> или возраст пользователя <code>age</code> равен <code>25</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * FROM users
WHERE balance = 1000 OR age = 25;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_оператор_not">Оператор <code>NOT</code></h6>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column1, column2, ...
FROM table_name
WHERE NOT condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор SQL выбирает все поля из <code>users</code>, где возраст <code>age</code> не равен <code>30</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE NOT age = 30;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_комбинирование_and_or_и_not">Комбинирование <code>AND</code>, <code>OR</code> и <code>NOT</code></h6>
<div class="paragraph">
<p>Также можно комбинировать операторы <code>AND</code>, <code>OR</code> и <code>NOT</code>.</p>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает все поля из <code>users</code>, где возраст <code>age</code> равно <code>30</code>. И баланс <code>balance</code> больше <code>1000</code> или имя <code>name</code> не равно <code>Tom</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE age = 30
  AND (balance &gt; 1000 OR NOT name = 'Tom');</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_выборка_с_сортировкой_результата_order_by">Выборка с сортировкой результата (<code>ORDER BY</code>)</h5>
<div class="paragraph">
<p>Ключевое слово <code>ORDER BY</code> используется для сортировки результирующего набора в порядке возрастания или убывания. По умолчанию оно сортирует записи по возрастанию. Чтобы отсортировать записи в порядке убывания, используйте ключевое слово <code>DESC</code>. Для сортировки по возрастанию, используйте ключевое слово <code>ASC</code>.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column1, column2, ...
FROM table_name
ORDER BY column1, column2, ... ASC|DESC;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает всех пользователей из таблицы <code>users</code>, отсортированные по столбцу <code>name</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
ORDER BY name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>или</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
ORDER BY name ASC;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Но <code>ASC</code> избыточен, так как он идет по умолчанию.</p>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает всех пользователей из таблицы <code>users</code>, отсортированные по столбцу <code>name</code> в обратном порядке:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
ORDER BY name DESC;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_значение_null">Значение <code>NULL</code></h5>
<div class="paragraph">
<p>Поле со значением <code>NULL</code> является <strong>полем без значения</strong>. Если поле в таблице является необязательным, можно вставить новую запись или обновить запись без добавления значения в это поле. Затем поле будет сохранено со значением <code>NULL</code>. Значение <code>NULL</code> отличается от нулевого значения или поля, содержащего пробелы.</p>
</div>
<div class="sect5">
<h6 id="_как_проверить_значения_null">Как проверить значения <code>NULL</code>?</h6>
<div class="paragraph">
<p>Невозможно проверить значения <code>NULL</code> с операторами сравнения, такими как <code>=</code>, <code>&lt;</code> или <code>!=</code>. Вместо этого нужно использовать операторы <code>IS NULL</code> и <code>IS NOT NULL</code>.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис <code>IS NULL</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_names
FROM table_name
WHERE column_name IS NULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор использует оператор <code>IS NULL</code> для перечисления всех пользователей, у которых нет телефона.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name, phone
FROM users
WHERE phone IS NULL;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Синтаксис <code>NOT NULL</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_names
FROM table_name
WHERE column_name IS NOT NULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор использует оператор <code>IS NOT NULL</code> для перечисления всех пользователей, у которых есть телефон.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name, phone
FROM users
WHERE phone IS NOT NULL;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_выборка_с_указанием_количества_записей_в_результате_limit">Выборка с указанием количества записей в результате (<code>LIMIT</code>)</h5>
<div class="paragraph">
<p>Предложение <code>SELECT &#8230;&#8203; LIMIT</code> используется для указания количества возвращаемых записей. Оно полезно для больших таблиц с тысячами записей. Возвращение большого количества записей может повлиять на производительность.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE condition
LIMIT number;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_примеры_top_limit_и_rownum">Примеры <code>TOP</code>, <code>LIMIT</code> и <code>ROWNUM</code></h5>
<div class="paragraph">
<p>Следующий оператор показывает эквивалентный пример, используя предложение <code>LIMIT</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
LIMIT 3;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор показывает эквивалентный пример, используя предложение <code>LIMIT</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE balance = 1000
LIMIT 5;</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<code>TOP</code>, <code>ROWNUM</code> - не входят в стандарт <strong>SQL</strong>, это dialect для <strong>СУБД</strong> Oracle. Поэтому они не будут работать например для <strong>PostgreSQL</strong>, <strong>MariaDB</strong>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает первые три записи из таблицы <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT TOP 3 *
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор показывает эквивалентный пример с использованием <code>ROWNUM</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE ROWNUM &lt;= 3;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает <strong>первые 25% записей</strong> из таблицы <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT TOP 25 PERCENT *
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает первые 5 записи из таблицы <code>users</code>, где баланс <code>balance</code> равен <code>1000</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT TOP 5 *
FROM users
WHERE balance = 1000;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор показывает эквивалентный пример с использованием <code>ROWNUM</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * FROM users
WHERE balance = 1000 AND ROWNUM &lt;= 5;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_выборка_по_заданному_шаблону_like">Выборка по заданному шаблону (<code>LIKE</code>)</h5>
<div class="paragraph">
<p>Оператор <code>LIKE</code> используется в предложении <code>WHERE</code> для поиска заданного шаблона в столбце.</p>
</div>
<div class="paragraph">
<p>В сочетании с оператором <code>LIKE</code> используются два подстановочных знака:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>%</code> - знак процента представляет нулевой, один или несколько символов</p>
</li>
<li>
<p><code>_</code> - подчеркнутый символ представляет собой один символ</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column1, column2, ...
FROM table_name
WHERE columnN LIKE pattern;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Выражение</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WHERE name LIKE 'text%'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Находит любые значения, начинающиеся с <code>text</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WHERE name LIKE '%text'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Находит любые значения, заканчивающиеся на <code>text</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WHERE name LIKE '%text%'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Находит любые значения, которые имеют <code>text</code> в любой позиции</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WHERE name LIKE '_text%'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Находит любые значения, которые имеют <code>text</code> во второй позиции</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WHERE name LIKE 'text_%_%'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Находит любые значения, начинающиеся с <code>text</code> и длиной не менее 3 символов</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WHERE name LIKE 'text%data'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Находит любые значения, начинающиеся с <code>text</code> и заканчивающиеся на <code>data</code></p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_подстановочные_знаки">Подстановочные знаки</h6>
<div class="paragraph">
<p>Символ подстановки используется для замены любого другого символа в строке. Подстановочные символы используются с оператором <code>LIKE</code>. Оператор <code>LIKE</code> используется в предложении <code>WHERE</code> для поиска заданного шаблона в столбце.</p>
</div>
<div class="sect6">
<h7 id="_использование_подстановочного_знака">Использование подстановочного знака</h7>
<div class="paragraph">
<p>Следующий оператор SQL выбирает всех пользователей с <code>name</code>, начиная с любого символа, за которым следует <code>о</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE name LIKE '_o';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает всех пользователей с <code>name</code> начиная с <code>B</code>, за которыми, следует любой символ. А за ним следует <code>l</code>, за которым следует любой символ, а затем <code>y</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE name LIKE 'B_l_y';</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Подстановочные знаки <code>[charlist]</code> и <code>[!charlist]</code> - не входят в стандарт <strong>SQL</strong>, это dialect для <strong>СУБД</strong> Oracle. Поэтому они не будут работать например для <strong>PostgreSQL</strong>, <strong>MariaDB</strong>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect6">
<h7 id="_использование_подстановочного_знака_charlist">Использование подстановочного знака <code>[charlist]</code></h7>
<div class="paragraph">
<p>Следующий оператор SQL выбирает всех пользователей с name, начиная с <code>Т</code>, <code>Р</code> или <code>Е</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE name LIKE '[ТРЕ]%';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор SQL выбирает всех пользователей с <code>name</code>, начиная с <code>Т</code>, <code>Р</code> или <code>Е</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE name LIKE '[Т-E]%';</code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_использование_подстановочного_знака_charlist_2">Использование подстановочного знака <code>[!charlist]</code></h7>
<div class="paragraph">
<p>Два следующих оператора SQL выбирают всех пользователей с помощью <code>name NOT</code>, начинающегося с <code>Т</code>, <code>Р</code> или <code>E</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE name LIKE '[!ТРЕ]%';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Или:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE name NOT LIKE '[ТРЕ]%';</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_выборка_с_проверкой_на_вхождение_в_множество_in">Выборка с проверкой на вхождение в множество (<code>IN</code>)</h5>
<div class="paragraph">
<p>Оператор <code>IN</code> позволяет указать несколько значений в предложении <code>WHERE</code>. Он является сокращением для нескольких условий <code>OR</code>.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE column_name IN (value1, value2, ...);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Синтаксис  подзапросом</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE column_name IN (SELECT STATEMENT);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий SQL запрос выбирает всех пользователей, которые находятся в странах <code>Belarus</code>, <code>Spain</code> и <code>France</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE country IN ('Belarus', 'Spain', 'France');</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий SQL запрос выбирает всех пользователей, которые <strong>НЕ расположены</strong> в <code>Belarus</code>, <code>Spain</code> и <code>France</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM users
WHERE country NOT IN ('Belarus', 'Spain', 'France');</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_выборка_с_проверкой_на_вхождение_в_диапазон_between_и_not_between">Выборка с проверкой на вхождение в диапазон (<code>BETWEEN</code> и <code>NOT BETWEEN</code>)</h5>
<div class="paragraph">
<p>Оператор <code>BETWEEN</code> выбирает значения в заданном диапазоне. Значения могут быть числами, текстом или датами.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE column_name BETWEEN value1 AND value2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий SQL запрос выбирает все продукты с ценой <code>BETWEEN</code> <code>5</code> и <code>200</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM products
WHERE price BETWEEN 5 AND 200;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы отобразить товары вне диапазона предыдущего примера, используйте <code>NOT BETWEEN</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM products
WHERE price NOT BETWEEN 5 AND 200;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_пример_between_с_in">Пример <code>BETWEEN</code> с <code>IN</code></h6>
<div class="paragraph">
<p>Следующий оператор выбирает все товары с ценой <code>BETWEEN</code> <code>5</code> и <code>200</code> и не показывать товары с категориями <code>1</code>, <code>2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM products
WHERE (price BETWEEN 5 AND 200)
  AND NOT category_id IN (1, 2);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_between_текстовых_значений"><code>BETWEEN</code> текстовых значений</h6>
<div class="paragraph">
<p>Следующий оператор выбирает все товары с name <code>BETWEEN</code> <code>Bike</code> и <code>PC</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM products
WHERE name BETWEEN 'Bike' AND 'PC'
ORDER BY name;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_not_between_текстовых_значений"><code>NOT BETWEEN</code> текстовых значений</h6>
<div class="paragraph">
<p>Следующий оператор выбирает все продукты с name <code>NOT BETWEEN</code> <code>Bike</code> и <code>PC</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM products
WHERE name NOT BETWEEN 'Bike' AND 'PC'
ORDER BY name;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_пример_between_с_датами">Пример <code>BETWEEN</code> с датами</h6>
<div class="paragraph">
<p>Следующий оператор SQL выбирает все счета с помощью <code>date BETWEEN</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
FROM products
WHERE manufacture_date BETWEEN '2021-02-01' AND '2021-04-01';</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_псевдонимы_aliases">3.2.4. Псевдонимы (<code>Aliases</code>)</h4>
<div class="paragraph">
<p><strong>SQL-псевдонимы</strong> используются для предоставления таблицы или столбца таблицы временного имени. Псевдонимы часто используются, чтобы сделать имена столбцов более читабельными. Псевдоним существует только для продолжительности запроса.</p>
</div>
<div class="paragraph">
<p>Псевдонимы могут быть полезны, когда:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>В запросе содержится более одной таблицы</p>
</li>
<li>
<p>Функции используются в запросе</p>
</li>
<li>
<p>Названия столбцов большие или не очень читаемые</p>
</li>
<li>
<p>Два или более столбца объединяются вместе</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Синтаксис псевдонимов для столбца</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name AS alias_name
FROM table_name;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Синтаксис псевдонимов для таблицы</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name AS alias_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор создает два псевдонима: один для столбца <code>user_id</code> и один для столбца <code>name</code>:</p>
</div>
<div class="paragraph">
<p><strong>Пример:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT user_id AS id, name AS user
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор создает два псевдонима: один для столбца <code>name</code> и один для столбца <code>country</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name AS user, country AS "User from Country"
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор выбирает все покупки от пользователя с помощью <code>user_id</code> и <code>name</code>. В запросе используются таблицы <code>users</code> и <code>products</code>, которым даются псевдонимы таблиц <code>u</code> и <code>p</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT u.name AS buyer, p.name as purchase, p.price
FROM users AS u,
     products AS p
WHERE u.name = 'Lily'
  AND u.user_id = p.user_id;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_обновление_записей_update">3.2.5. Обновление записей (<code>UPDATE</code>)</h4>
<div class="paragraph">
<p>Зачастую необходимо изменить данные в таблице. В <strong>SQL</strong> это делается с помощью <code>UPDATE</code>.</p>
</div>
<div class="paragraph">
<p>Использование <code>UPDATE</code> включает в себя выбор таблицы, в которой находится поле подлежащее изменению. Запись нового значения осуществляется с помощью запроса <code>WHERE</code>, чтобы обозначить конкретное место в таблице.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">UPDATE table_name
SET column1 = value1, column2 = value2, ...
WHERE condition</code></pre>
</div>
</div>
<div class="paragraph">
<p>Предположим есть таблица с самыми высоко оценёнными сериалами всех времён. Однако в ней есть несоответствие: <strong>Игра Престолов</strong>  обозначена как комедия, изменим значение поля следующим запросом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">UPDATE tv_series
SET genre = 'drama'
WHERE name = 'Game of Thrones';</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_удаление_записей_из_таблицы_delete">3.2.6. Удаление записей из таблицы (<code>DELETE</code>)</h4>
<div class="paragraph">
<p>Удаление записи из таблицы очень простая операция, всё что нужно - это обозначить, что необходимо удалить.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DELETE
FROM tv_serials
WHERE tv_serial_id = 3;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Необходимо убедиться что используется запрос <code>WHERE</code>, когда происходит удаление записи из таблицы. Иначе удалятся все записи.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_удалить_все_записи">Удалить все записи</h5>
<div class="paragraph">
<p>Можно удалить все строки таблицы без удаления таблицы. Это означает, что структура таблицы, атрибуты и индексы будут неповрежденными:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DELETE FROM table_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>или:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DELETE
FROM tv_serials
WHERE tv_serial_id IS NOT NULL;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_многотабличные_базы_данных">3.3. Многотабличные базы данных</h3>
<div class="sect3">
<h4 id="_ключи">3.3.1. Ключи</h4>
<div class="paragraph">
<p><strong>Ключ</strong> — это колонка или колонки, не имеющие в строках дублирующих значений.</p>
</div>
<div class="paragraph">
<p><strong>Ключи бывают:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Первичные</strong></p>
</li>
<li>
<p><strong>Внешние</strong></p>
</li>
<li>
<p><strong>Составные</strong></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_первичный_ключ">Первичный ключ</h5>
<div class="paragraph">
<p>Столбец, который в базе данных должен быть уникальным помечают первичным ключом. <strong>Первичный ключ</strong> или <strong>primary key</strong> означает, что в таблице значение колонки <strong>primary key</strong> не может повторяться. Таким образом данный ключ позволяет однозначно идентифицировать запись в таблице не боясь при этом, что значение столбца повториться.</p>
</div>
<div class="paragraph">
<p>В качестве первичного ключа может использоваться:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Естественный Ключ</strong> (<strong>Natural key</strong>) – набор атрибутов описываемой записью сущности, уникально её идентифицирующий (например, номер паспорта для человека).</p>
</li>
<li>
<p><strong>Суррогатный Ключ</strong> (<strong>Surrogate Key</strong>) – автоматически сгенерированное поле, никак не связанное с информационным содержанием записи.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Допустим есть таблица студентов с полями: <code>ФИО</code>, <code>год рождения</code>. Поскольку может возникнуть ситуация когда <code>ФИО</code> и <code>год рождения</code> совпадут сразу у нескольких студентов, верным решением будет внести в таблицу первичный ключ:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Первичный ключ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ФИО</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Год рождения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2001</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2002</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Николаенко Николай</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2001</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_внешний_ключ">Внешний ключ</h5>
<div class="paragraph">
<p><strong>Внешние ключи</strong> еще называют <strong>ссылочным</strong>, они необходимы для связывания таблиц между собой.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Товары</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Артикул</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID тип товара</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Цена</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">151687</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">104</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">151605</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">42</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">151690</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">77</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">151601</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Тип товара</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Тип товара</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Джемпер</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Футболка</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>В таблице <code>Тип товара</code> внешним ключом будет поле <code>ID тип товара</code> в таблице <code>Товары</code>. Благодаря такой зависимости образуется связь между двумя таблицами.</p>
</div>
</div>
<div class="sect4">
<h5 id="_составной_ключ">Составной ключ</h5>
<div class="paragraph">
<p>Бывают ситуации, когда при вставке в таблицу нужно проверять запись на уникальность сразу по нескольким полям.</p>
</div>
<div class="paragraph">
<p><strong>Составной ключ</strong> — это несколько первичных ключей в таблице. Таким образом, создав составной ключ, уникальность записи будет проверяться по полям, которые объединенные в этот ключ.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Город</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">№ школы</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Директор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Адрес</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Телефон</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Гомель</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Лесная, 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2-22-99</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Минск</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Солнечная, 4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4-44-44</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Минск</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Николаенко Николай</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Радужная, 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5-55-55</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Составной ключ может состоять и более чем из двух полей. В таблице поля <code>Город</code> и <code>№ школы</code> вместе образуют составной ключ. В такой таблице у разных записей не могут совпасть одновременно два поля <code>Город</code> и <code>№ школы</code>, а номера школ совпасть могут.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_подзапросы">3.3.2. Подзапросы</h4>
<div class="sect4">
<h5 id="_оператор_exists">Оператор <code>EXISTS</code></h5>
<div class="paragraph">
<p>Оператор <code>EXISTS</code> используется для проверки существования любой записи в подзапросе. Если подзапрос возвращает одну или несколько записей, то возвращается <code>true</code>.</p>
</div>
<div class="sect5">
<h6 id="_синтаксис_exists">Синтаксис <code>EXISTS</code></h6>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE EXISTS
(SELECT column_name FROM table_name WHERE condition);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_примеры_использования_exists">Примеры использования <code>EXISTS</code></h6>
<div class="paragraph">
<p>Следующий оператор возвращает <code>TRUE</code> и перечисляет доставки с ценой товара менее <code>1000</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name
FROM delivery
WHERE EXISTS (SELECT name FROM product WHERE delivery_id = delivery.delivery_id AND price &lt; 1000);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор SQL возвращает <code>TRUE</code> и перечисляет доставки с ценой товара <code>5000</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name
FROM delivery
WHERE EXISTS (SELECT name FROM product WHERE delivery_id = delivery.delivery_id AND price = 5000);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_операторы_any_и_all">Операторы <code>ANY</code> и <code>ALL</code></h5>
<div class="paragraph">
<p>Операторы <code>ANY</code> и <code>ALL</code> используются с предложением <code>WHERE</code> или <code>HAVING</code>. Оператор <code>ANY</code> возвращает <code>true</code>, если какое-либо из значений подзапроса соответствует условию. Оператор <code>ALL</code> возвращает <code>true</code>, если все значения подзапроса удовлетворяют условию.</p>
</div>
<div class="sect5">
<h6 id="_синтаксис_any">Синтаксис <code>ANY</code></h6>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE column_name operator ANY
(SELECT column_name FROM table_name WHERE condition);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_пример_any">Пример <code>ANY</code></h6>
<div class="paragraph">
<p>Оператор <code>ANY</code> возвращает <code>TRUE</code>, если какое-либо из значений подзапроса соответствует условию. Следующий оператор возвращает <code>TRUE</code> и перечисляет имена товаров, если он находит ЛЮБЫЕ записи в таблице <code>info</code>, с количеством = <code>15</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name
FROM product
WHERE product_id = ANY (SELECT product_id FROM info WHERE counts = 15)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор возвращает <code>TRUE</code> и перечисляет имена товаров, если он находит ЛЮБЫЕ записи в таблице <code>info</code>, с количеством &gt; <code>15</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name
FROM product
WHERE product_id = ANY (SELECT product_id FROM info WHERE counts &gt; 15);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_синтаксис_all">Синтаксис <code>ALL</code></h6>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE column_name operator ALL
(SELECT column_name FROM table_name WHERE condition);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_пример_all">Пример <code>ALL</code></h6>
<div class="paragraph">
<p>Оператор <code>ALL</code> возвращает <code>TRUE</code>, если все значения подзапроса удовлетворяют условию.</p>
</div>
<div class="paragraph">
<p>Следующий оператор возвращает <code>TRUE</code> и перечисляет имена товаров, если ВСЕ записи в таблице <code>info</code> имеют количество = <code>7</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name
FROM product
WHERE product_id = ALL (SELECT product_id FROM info WHERE couns =7);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_соединение">3.3.3. Соединение</h4>
<div class="paragraph">
<p>Оператор <code>UNION</code> используется для объединения результирующего набора из двух или более операторов <code>SELECT</code>. Каждый оператор <code>SELECT</code> в <code>UNION</code> должен иметь одинаковое количество столбцов. Столбцы также должны иметь похожие типы данных и в каждой инструкции <code>SELECT</code> быть в том же порядке.</p>
</div>
<div class="sect4">
<h5 id="_синтаксис_union">Синтаксис <code>UNION</code></h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s) FROM table1
UNION
SELECT column_name(s) FROM table2;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_пример_union">Пример <code>UNION</code></h5>
<div class="paragraph">
<p>Следующий оператор выбирает все разные города (только отдельные значения) от <code>users</code> и <code>delivery</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT city FROM users
UNION
SELECT city FROM delivery
ORDER BY city;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_синтаксис_union_all">Синтаксис <code>UNION ALL</code></h5>
<div class="paragraph">
<p>Оператор <code>UNION</code> по умолчанию выбирает только разные значения. Чтобы разрешить повторяющиеся значения, используйте <code>UNION ALL</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s) FROM table1
UNION ALL
SELECT column_name(s) FROM table2;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_пример_union_all">Пример <code>UNION ALL</code></h5>
<div class="paragraph">
<p>Следующий оператор выбирает все города (дублирующиеся значения также) из <code>users</code> и <code>delivery</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT city FROM users
UNION ALL
SELECT city FROM delivery
ORDER BY city;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_оператор_union_с_where">Оператор <code>UNION</code> с <code>WHERE</code></h5>
<div class="paragraph">
<p>Следующий оператор выбирает все разные испанские города (только отдельные значения) от <code>users</code> и <code>delivery</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT city, country FROM users
WHERE country='Spain'
UNION
SELECT city, country FROM delivery
WHERE country='Spain'
ORDER BY city;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_оператор_union_all_с_where">Оператор <code>UNION ALL</code> с <code>WHERE</code></h5>
<div class="paragraph">
<p>Следующий оператор выбирает все испанские города (повторяющиеся значения) также из <code>users</code> и <code>delivery</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT city, country FROM users
WHERE country='Spain'
UNION ALL
SELECT city, country FROM delivery
WHERE country = 'Spain'
ORDER BY city;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_объединения">3.3.4. Объединения</h4>
<div class="paragraph">
<p>Предложение <code>JOIN</code> используется для объединения строк из двух или более таблиц на основе соответствующего столбца между ними.</p>
</div>
<div class="paragraph">
<p>Существует несколько типов <code>JOIN</code> в <strong>SQL</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>(INNER) JOIN</code> - возвращает записи, имеющие соответствующие значения в обеих таблицах</p>
</li>
<li>
<p><code>LEFT (OUTER) JOIN</code> - возвращает все записи из левой таблицы и соответствующие записи из правой таблицы</p>
</li>
<li>
<p><code>RIGHT (OUTER) JOIN</code> - вернуть все записи из правой таблицы и сопоставленные записи из левой таблицы</p>
</li>
<li>
<p><code>FULL (OUTER) JOIN</code> - возвращает все записи, когда есть совпадение в левой или правой таблице</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_inner_join"><code>INNER JOIN</code></h5>
<div class="paragraph">
<p>Ключевое слово <code>INNER JOIN</code> выбирает записи, имеющие соответствующие значения в обеих таблицах</p>
</div>
<div class="paragraph">
<p><strong>Синтаксиc:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table1
INNER JOIN table2 ON table1.column_name = table2.column_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Таблица users</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">user_id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">fullname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ник</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Никольский</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Майк</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Майкович</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Таблица invoice</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">invoice_id</th>
<th class="tableblock halign-left valign-top">user_id</th>
<th class="tableblock halign-left valign-top">product_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Столбец <code>user_id</code> в таблице <code>invoice</code> ссылается на <code>user_id</code> в таблице <code>invoice</code> между которыми осуществляется взаимосвязь. Для выбора записей, имеющие соответствующие значения в обеих таблицах используется следующий запрос:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT invoice.invoice_id, users.name
FROM Orders
INNER JOIN users ON invoice.user_id = users.user_id;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_join_three_таблиц"><code>JOIN Three</code> таблиц</h6>
<div class="paragraph">
<p>Следующий оператор выбирает все счета с информацией о пользователях и отправителях:</p>
</div>
<div class="paragraph">
<p><strong>Пример:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT invoice.invoice, users.name, addresser.name
FROM ((invoice
INNER JOIN users ON invoice.user_id = users.user_id)
INNER JOIN addresser ON invoice.addresser_id = addresser.addresser_id);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_left_join"><code>LEFT JOIN</code></h5>
<div class="paragraph">
<p>Ключевое слово <code>LEFT JOIN</code> возвращает все записи из левой таблицы и сопоставленные записи из правой таблицы. Результат равен <code>NULL</code> с правой стороны, если нет совпадения.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table1
LEFT JOIN table2 ON table1.column_name = table2.column_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор выберет всех пользователей и любые заказы, которые они могут иметь:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT users.name, invoice.invoice_id
FROM users
LEFT JOIN invoice ON users.user_id = invoice.user_id
ORDER BY users.name;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_right_join"><code>RIGHT JOIN</code></h5>
<div class="paragraph">
<p>Ключевое слово <code>RIGHT JOIN</code> возвращает все записи из правой таблицы и сопоставленные записи из левой таблицы. Результат равен <code>NULL</code> с левой стороны, когда нет совпадения.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table1
RIGHT JOIN table2 ON table1.column_name = table2.column_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор вернет всех пользователей и любые заказы, которые они могли бы разместить.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT invoice.invoice_id, users.name, users.fullname
FROM invoice
RIGHT JOIN users ON invoice.user_id = users.user_id
ORDER BY invoice.invoice_id;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_full_outer_join"><code>FULL OUTER JOIN</code></h5>
<div class="paragraph">
<p>Ключевое слово <code>FULL OUTER JOIN</code> возвращает все записи, когда есть совпадение в обеих таблицах таблицы или справа.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table1
FULL OUTER JOIN table2 ON table1.column_name = table2.column_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор выбирает всех пользователей и все заказы:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT users.name, invoice.invoice_id
FROM users
FULL OUTER JOIN invoice ON users.user_id = invoice.user_id
ORDER BY users.name;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_регулярное_соединение_self_join">Регулярное соединение <code>Self JOIN</code></h5>
<div class="paragraph">
<p><code>Self JOIN</code> - это регулярное соединение, но таблица соединяется сама с собой.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table1 T1, table1 T2
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, следующий оператор соответствует пользователям из одного города:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT A.name AS name1, B.name AS name2, A.city
FROM users A, users B
WHERE A.user_id &lt;&gt; B.user_id
AND A.city = B.city
ORDER BY A.city;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_агрегатные_функции_и_группировка">3.4. Агрегатные функции и группировка</h3>
<div class="sect3">
<h4 id="_агрегатные_функции">3.4.1. Агрегатные функции</h4>
<div class="sect4">
<h5 id="_функции_min_и_max">Функции <code>MIN()</code> и <code>MAX()</code></h5>
<div class="paragraph">
<p>Функция <code>MIN()</code> возвращает наименьшее значение выбранного столбца. Функция <code>MAX()</code> возвращает наибольшее значение выбранного столбца.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис <code>MIN()</code>:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT MIN(column_name)
FROM table_name
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример <code>MIN()</code>:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT MIN(price) AS min_price
FROM product;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Синтаксис <code>MAX()</code>:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT MAX(column_name)
FROM table_name
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример <code>MAX()</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT MAX(price) AS max_price
FROM product;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_функция_count">Функция <code>COUNT()</code></h5>
<div class="paragraph">
<p>Функция <code>COUNT()</code> возвращает количество строк, соответствующих заданным критериям.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT COUNT(column_name)
FROM table_name
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример:</strong></p>
</div>
<div class="paragraph">
<p>Следующий оператор SQL находит количество товаров.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT COUNT(product_id)
FROM product;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_функция_avg">Функция <code>AVG()</code></h5>
<div class="paragraph">
<p>Функция <code>AVG()</code> возвращает среднее значение числового столбца.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT AVG(column_name)
FROM table_name
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Например</strong> найдем среднюю стоимость товара:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT AVG(price)
FROM product;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_функция_sum">Функция <code>SUM()</code></h5>
<div class="paragraph">
<p>Функция <code>SUM()</code> возвращает общую сумму числового столбца.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT SUM(column_name)
FROM table_name
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, найдем сумму полей доставка <code>delivery</code> в таблице <code>invoice</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT SUM(delivery)
FROM invoice;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_группировка">3.4.2. Группировка</h4>
<div class="paragraph">
<p>Оператор <code>GROUP BY</code> часто используется с агрегатными функциями (<code>COUNT</code>, <code>MAX</code>, <code>MIN</code>, <code>SUM</code>, <code>AVG</code>) для группировки результирующего набора одним или несколькими столбцами.</p>
</div>
<div class="sect4">
<h5 id="_синтаксис_group_by">Синтаксис <code>GROUP BY</code></h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE condition
GROUP BY column_name(s)
ORDER BY column_name(s);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_пример_sql_group_by">Пример SQL <code>GROUP BY</code></h5>
<div class="paragraph">
<p>В следующем выражении указано количество пользователей в каждой стране:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT COUNT(use_id), country
FROM users
GROUP BY country;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В следующем SQL-заявлении указано количество пользователей в каждой стране, отсортированных по высоким и низким:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT COUNT(user_id), country
FROM users
GROUP BY country
ORDER BY COUNT(user_id) DESC;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_операторgroup_by_с_join">Оператор`GROUP BY` с <code>JOIN</code></h5>
<div class="paragraph">
<p>В следующем выражении указано количество заказов, отправленных каждой службой доставки:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT delivery.name, COUNT(invoice.delivery_id) AS orders FROM invoice
LEFT JOIN delivery ON invoice.delivery_id = delivery.delivery_id
GROUP BY name;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_предложение_having">3.4.3. Предложение <code>HAVING</code></h4>
<div class="paragraph">
<p>Предложение <code>HAVING</code> используется в SQL, для работы с агрегатными функциями, так как <code>WHERE</code> не могло с ними использоваться.</p>
</div>
<div class="paragraph">
<p><strong>Синтаксис:</strong>`</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column_name(s)
FROM table_name
WHERE condition
GROUP BY column_name(s)
HAVING condition
ORDER BY column_name(s);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, в следующем SQL-заявлении указано количество пользователей в каждой стране. Включать только страны с более чем 7 клиентами:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT COUNT(user_id), country
FROM users
GROUP BY country
HAVING COUNT(user_id) &gt; 7;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В следующем SQL-заявлении указано количество пользователей в каждой стране, отсортированные по высоким и низким.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT COUNT(user_id), country
FROM users
GROUP BY country
HAVING COUNT(user_id) &gt; 7
ORDER BY COUNT(user_id) DESC;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_проектирование_баз_данных">3.5. Проектирование баз данных</h3>
<div class="sect3">
<h4 id="_нормализация_и_денормализация_баз_данных">3.5.1. Нормализация и денормализация баз данных</h4>
<div class="paragraph">
<p><strong>Нормализация базы данных</strong> - это процесс эффективной организации данных в базе данных. Есть две причины процесса нормализации:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Устранение избыточных данных, например, хранение тех же данных в более чем одной таблице.</p>
</li>
<li>
<p>Обеспечение зависимостей данных.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Денормализация</strong> — намеренное приведение структуры базы данных в состояние, не соответствующее критериям нормализации, обычно проводимое с целью ускорения операций чтения из базы за счет добавления избыточных данных.</p>
</div>
<div class="paragraph">
<p><strong>Нормализация</strong> состоит из ряда принципов, которые помогают в создании хорошей структуры базы данных. Эти принципы делятся на нормальные формы, их цель в организации структуры базы данных таким образом, чтобы правильно организовать структуру базы данных.</p>
</div>
<div class="sect4">
<h5 id="_первая_нормальная_форма">Первая нормальная форма</h5>
<div class="paragraph">
<p>Правила первой нормальной формы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>В таблице не должно быть дублирующих строк.</p>
</li>
<li>
<p>В каждой ячейке таблицы хранится атомарное значение (одно не составное значение).</p>
</li>
<li>
<p>В столбце хранятся данные одного типа.</p>
</li>
<li>
<p>Нет упорядочивания строк сверху вниз (другими словами, порядок строк не несет в себе никакой информации).</p>
</li>
<li>
<p>Нет упорядочивания столбцов слева направо (другими словами, порядок столбцов не несет в себе никакой информации).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Пример, допустим есть ненормализованная таблица:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID покупателя</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ФИО</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Заказ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Телефон</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ноутбук Asus G53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Мобильный телефон 44 888 77 77, Домашний Телефон 8-77-77</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Телефон Nokia 5310</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Мобильный телефон 44 888 77 77, Домашний Телефон 8-77-77</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Наушники LG 700</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Мобильный телефон 44 888 77 77, Домашний Телефон 8-77-77</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Такая таблица нарушает требования первой нормальной формы. Ее следует разбить на две части, а затем соединить их с помощью ключа.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Информация о клиенте</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID покупателя</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ФИО</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Мобильный телефон</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Домашний телефон</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">44 888 77 77</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-77-77</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Информация о заказах</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID заказа</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID клиента</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Заказ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ноутбук Asus G53</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Телефон Nokia 5310</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Наушники LG 700</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Такие таблицы соответствуют требованиям первой нормальной формы.</p>
</div>
<div class="sect5">
<h6 id="_вторая_нормальная_форма">Вторая нормальная форма</h6>
<div class="paragraph">
<p><strong>Правило второй нормальной формы</strong> звучит следующим образом: отношение соответствует второй нормальной форме, если оно соответствует первой нормальной форме и каждый не ключевой атрибут неприводимо зависит от первичного ключа.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ФИО</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Должность</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Подразделение</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Программист</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Отдел разработки ПО</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Бухгалтер</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Бухгалтерия</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Борисов Борис</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Продавец</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Отдел реализации</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Допустим в организации каждому сотруднику присваивается уникальный табельный номер, который никогда не будет изменен. Таким образом, чтобы привести эту таблицу ко второй нормальной форме, необходимо добавить в нее еще один атрибут, т.е. столбец с табельным номером, который будет выступать первичным ключом.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Табельный номер</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ФИО</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Должность</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Подразделение</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">660</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Программист</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Отдел разработки ПО</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">212</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Бухгалтер</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Бухгалтерия</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Борисов Борис</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Продавец</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Отдел реализации</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_третья_нормальная_форма">Третья нормальная форма</h6>
<div class="paragraph">
<p><strong>Правило третьей нормальной формы</strong> звучит следующим образом: отношение находится в третьей нормальной форме, когда находится во второй нормальной форме и каждый не ключевой атрибут не транзитивно зависит от первичного ключа.</p>
</div>
<div class="paragraph">
<p>Иначе говоря, третья нормальная форма требует выносить все не ключевые поля, содержимое которых может относиться к нескольким записям таблицы в отдельные таблицы.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CourseID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Course</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TeacherID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Teacher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Математика</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Алгоритмы</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Такую ненормализованную таблицу требуется разбить на две разные таблицы:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TeacherID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Teacher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Таким образом в первой таблице TeacherID является ключом, явный указывающий на преподавателя.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CourseID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Course</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TeacherID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Математика</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Алгоритмы</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_нормальная_форма_бойса_кодда">Нормальная форма Бойса-Кодда</h6>
<div class="paragraph">
<p><strong>Требование нормальной формы Бойса-Кодда</strong> звучит следующим образом: таблица должна находиться в третьей нормальной форме и ключевые атрибуты составного ключа не должны зависеть от неключевых атрибутов. Отсюда следует, что требования нормальной формы Бойса-Кодда предъявляются только к таблицам, у которых первичный ключ составной.</p>
</div>
<div class="paragraph">
<p><strong>Пример</strong></p>
</div>
<div class="paragraph">
<p>Представим, что у нас есть организация, которая реализует множество различных проектов. При этом в каждом проекте работа ведётся по нескольким функциональным направлениям, в каждом из которых есть свой куратор. Сотрудник может быть куратором только того направления, на котором он специализируется, т.е. если сотрудник программист, он не может курировать в проекте направление, связанное с бухгалтерией.</p>
</div>
<div class="paragraph">
<p>Допустим, что нам нужно хранить информацию о кураторах всех проектов по каждому направлению в таблице, где <strong>первичный ключ составной</strong> «Проект + Направление:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Проект</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Направление</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Куратор</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Разработка</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Бухгалтерия</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Разработка</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Реализация</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Андреев Андрей</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>В данном случае таблица не находится в нормальной форме Бойса-Кодда, дело в том, что зная куратора, можно четко определить, какое направление он курирует, иными словами, часть составного ключа, т.е. «Направление», зависит от неключевого атрибута, т.е. «Куратора». Чтобы привести данную таблицу к нормальной форме Бойса-Кодда, необходимо сделать декомпозицию данного отношения, т.е. разбить эту таблицу на несколько таблиц.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Таблица кураторов</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Идентификатор куратора</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ФИО</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Направление</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Егоров Егор</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Разработка</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Иванов Иван</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Бухгалтерия</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Андреев Андрей</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Реализация</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Таблица связи кураторов и проектов</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Проект</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Идентификатор куратора</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_продвинутый_sql">3.6. Продвинутый SQL</h3>
<div class="sect3">
<h4 id="_заявление_select_into">3.6.1. Заявление <code>SELECT INTO</code></h4>
<div class="paragraph">
<p>Оператор <code>SELECT INTO</code> копирует данные из одной таблицы в новую таблицу.</p>
</div>
<div class="sect4">
<h5 id="_синтаксис_select_into">Синтаксис <code>SELECT INTO</code></h5>
<div class="paragraph">
<p>Скопировать все столбцы в новую таблицу:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT *
INTO newtable [IN externaldb]
FROM oldtable
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Скопировать только несколько столбцов в новую таблицу:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT column1, column2, column3, ...
INTO newtable [IN externaldb]
FROM oldtable
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Новая таблица будет создана с именами и типами столбцов, как определено в старой таблице. Можно создавать новые имена столбцов, используя предложение <code>AS</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_примеры_sql_select_into">Примеры SQL <code>SELECT INTO</code></h5>
<div class="paragraph">
<p>Следующий оператор SQL создает резервную копию <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * INTO usersBackup001
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор использует предложение <code>IN</code> для копирования таблицы в новую таблицу в другой базе данных:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * INTO usersBackup001 IN 'backup.mdb'
FROM users;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следующий оператор копирует только несколько столбцов в новую таблицу:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT name, fullname INTO usersBackup001
FROM users;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_оператор_insert_into_select">3.6.2. Оператор <code>INSERT INTO SELECT</code></h4>
<div class="paragraph">
<p>Оператор <code>INSERT INTO SELECT</code> копирует данные из одной таблицы и вставляет ее в другую таблицу. <code>INSERT INTO SELECT</code> требует, чтобы типы данных в исходной и целевой таблицах соответствовали.</p>
</div>
<div class="paragraph">
<p>Синтаксис <code>INSERT IN SELECT</code>
Скопировать все столбцы из одной таблицы в другую:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">INSERT INTO table2
SELECT * FROM table1
WHERE condition;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Скопировать только несколько столбцов из одной таблицы в другую таблицу:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">INSERT INTO table2 (column1, column2, column3, ...)
SELECT column1, column2, column3, ...
FROM table1
WHERE condition;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_пример_sql_insert_into_select">Пример SQL <code>INSERT INTO SELECT</code></h5>
<div class="paragraph">
<p>Следующий оператор копирует <code>clients</code> в <code>users</code> (столбцы, которые не заполнены данными, будет содержать <code>NULL</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">INSERT INTO users (nme, fullname, balance)
SELECT nme, fullname, balance FROM clients;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_index">3.6.3. <code>CREATE INDEX</code></h4>
<div class="paragraph">
<p>Оператор <code>CREATE INDEX</code> используется для создания индексов в таблицах. Индексы используются для быстрого извлечения данных из базы данных. Пользователи не могут видеть индексы, они просто используются для ускорения поиска/запросов.</p>
</div>
<div class="sect4">
<h5 id="_синтаксис_create_index">Синтаксис <code>CREATE INDEX</code></h5>
<div class="paragraph">
<p><code>CREATE INDEX</code> создает индекс в таблице. Допускаются повторяющиеся значения:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE INDEX index_name
ON table_name (column1, column2, ...);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_синтаксис_create_unique_index">Синтаксис <code>CREATE UNIQUE INDEX</code></h5>
<div class="paragraph">
<p>Создает уникальный индекс в таблице. Дублирующие значения не допускаются:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE UNIQUE INDEX index_name
ON table_name (column1, column2, ...);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_пример_create_index">Пример <code>CREATE INDEX</code></h5>
<div class="paragraph">
<p>В приведенной ниже инструкции SQL создается индекс с именем <code>ind_name</code> в столбце <code>name</code> в таблице <code>users</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE INDEX ind_name
ON users (name);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если необходимо создать индекс в комбинации столбцов, можно указать имена столбцов в круглых скобках, разделенные запятыми:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE INDEX ind_name
ON users (name, fullname);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_оператор_drop_index">3.6.4. Оператор <code>DROP INDEX</code></h4>
<div class="paragraph">
<p>Оператор <code>DROP INDEX</code> используется для удаления индекса в таблице.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE table_name
DROP INDEX index_name;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_поле_auto_increment">3.6.5. Поле <code>AUTO INCREMENT</code></h4>
<div class="paragraph">
<p><code>Auto-increment</code> позволяет создавать уникальный номер автоматически, когда новая запись вставляется в таблицу. Часто это поле основного ключа, которое необходимо создать автоматически каждый раз, когда будет вставлена новая запись.</p>
</div>
<div class="sect4">
<h5 id="_синтаксис_для_mysql">Синтаксис для <code>MySQL</code></h5>
<div class="paragraph">
<p>Следующий оператор SQL определяет столбец <code>user_id</code> как поле первичного ключа с автоматическим приращением в таблице «users»:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE users (
user_id int NOT NULL AUTO_INCREMENT,
name varchar(255) NOT NULL,
fullname varchar(255),
balance int,
PRIMARY KEY (user_id)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>MySQL использует ключевое слово <code>AUTO_INCREMENT</code> для выполнения функции автоматического увеличения.</p>
</div>
<div class="paragraph">
<p>По умолчанию начальное значение для <code>AUTO_INCREMENT</code> равно <code>1</code>, и оно будет увеличиваться на 1 для каждой новой записи.</p>
</div>
<div class="paragraph">
<p>Чтобы последовательность <code>AUTO_INCREMENT</code> начиналась с другого значения, используйте следующий оператор:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE users AUTO_INCREMENT = 7;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы вставить новую запись в таблицу <code>user</code>, нам не нужно указывать значение для столбца <code>user_id</code>, так как уникальное значение будет добавляться автоматически:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">INSERT INTO users (name, fullname)
VALUES ('Том','Эдисон');</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_работа_с_датами">3.6.6. Работа с датами</h4>
<div class="paragraph">
<p>Пока ваши данные содержат только часть даты, ваши запросы будут работать должным образом. Однако, если задействована временная часть, она становится более сложной.</p>
</div>
<div class="sect4">
<h5 id="_типы_данных_sql_date">Типы данных <code>SQL Date</code></h5>
<div class="paragraph">
<p>MySQL имеет следующие типы данных для хранения даты или значения даты/времени в базе данных:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DATE</code> - формат: <code>YYYY-MM-DD</code></p>
</li>
<li>
<p><code>DATETIME</code> - формат: <code>YYYY-MM-DD HH:MI:SS</code></p>
</li>
<li>
<p><code>TIMESTAMP</code> - формат: <code>YYYY-MM-DD HH:MI:SS</code></p>
</li>
<li>
<p><code>YEAR</code> - формат: <code>YYYY</code> or <code>YY</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_операторы">3.6.7. Операторы</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Арифметические операторы SQL</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Оператор</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Добавление</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Вычитание</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Умножение</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Деление</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Модуль</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Побитовые операции SQL</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Оператор</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Побитовое М</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Побитовое ИЛИ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Операторы сравнения SQL</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Оператор</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Больше</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Меньше</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Больше или равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Меньше или равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Не равно</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Составные операторы SQL</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Оператор</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Добавить равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Вычесть равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Умножить равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Разделить равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Модуль равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Побитовое И равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^-=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Побитовое исключающее равно</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|*=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Побитовое ИЛИ равно</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Логические операторы SQL</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Оператор</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ALL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если все значения подзапроса являются <code>TRUE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если все условия, разделенные И, являются <code>TRUE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ANY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если какое-либо из значений подзапроса соответствует <code>TRUE</code> условию</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BETWEEN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если операнд находится в диапазоне сравнения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXISTS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если подзапрос возвращает одну или несколько записей</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если операнд равен одному из списка выражений</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIKE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если операнд соответствует шаблону</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NOT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Отображает запись, если условие (И) НЕ <code>TRUE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если любое из условий, разделенных <code>OR</code>, является <code>TRUE</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SOME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если какое-либо из значений подзапроса соответствует условию</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_функции">3.6.8. Функции</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Функции</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Функция</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASCII</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает числовой код, который представляет конкретный символ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHAR_LENGTH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает длину указанной строки (в символах)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHARACTER_LENGTH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает длину указанной строки (в символах)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONCAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Объединяет два или более выражения вместе</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONCAT_WS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Объединяет два или более выражения вместе и добавляет разделитель между ними</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FIELD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает позицию значения в списке значений</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FIND_IN_SET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает позицию строки в списке строк</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FORMAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Форматирует число как формат «<mark>, <mark></mark>. </mark>», округляя его до определенного количества знаков после запятой</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INSERT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Вставляет подстроку в строку в указанной позиции для определенного количества символов</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INSTR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает позицию первого вхождения строки в другую строку</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LCASE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует строку в нижний регистр</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LEFT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает подстроку из строки (начиная слева)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LENGTH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает длину указанной строки (в байтах)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOCATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает позицию первого вхождения подстроки в строку</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOWER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует строку в нижний регистр</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LPAD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает строку, которая добавлена в левую сторону с указанной строкой до определенной длины</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LTRIM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Удаляет ведущие пробелы из строки</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает подстроку из строки (начиная с любой позиции)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POSITION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает позицию первого вхождения подстроки в строку</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPEAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Повторяет строку определенное количество раз</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPLACE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Заменяет все вхождения указанной строки</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REVERSE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Отменяет строку и возвращает результат</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RIGHT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает подстроку из строки (начиная справа)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RPAD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает строку с правой строкой с определенной строкой до определенной длины</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RTRIM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Удаляет конечные пробелы из строки</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SPACE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает строку с заданным количеством пробелов</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRCMP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Проверяет, одинаковы ли две строки</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUBSTR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает подстроку из строки (начиная с любой позиции)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUBSTRING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает подстроку из строки (начиная с любой позиции)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUBSTRING_INDEX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает подстроку  string и перед integer вхождений delimiter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRIM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Удаляет начальные и конечные пробелы из строки</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UCASE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует строку в верхний регистр</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UPPER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует строку в верхний регистр</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Числовые функции</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Функция</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ABS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает абсолютное значение числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACOS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает косинус дуги числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASIN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает синус дуги числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ATAN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает тангенс дуги числа или дуги касательной n и m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ATAN2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает тангенс дуги n и m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AVG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает среднее значение выражения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CEIL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает наименьшее целочисленное значение, которое больше или равно числу</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CEILING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает наименьшее целочисленное значение, которое больше или равно числу</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает косинус числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает котангенс числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COUNT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает количество записей в выбранном запросе</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEGREES</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует значение радиана в градусы</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DIV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для целочисленного деления</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает e, поднятый до степени числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOOR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает наибольшее целочисленное значение, которое меньше или равно числу</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GREATEST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает наибольшее значение в списке выражений</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LEAST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает наименьшее значение в списке выражений</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает натуральный логарифм числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает натуральный логарифм числа или логарифм числа к заданной базе</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает логарифм базы-10 числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает логарифм базы-2 числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает максимальное значение выражения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MIN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает минимальное значение выражения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MOD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает остаток n, деленный на m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает значение PI, отображаемое с шестью знаками после запятой</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POW</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает m, поднятую до n-й степени</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POWER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает m, поднятую до n-й степени</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RADIANS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует значение в градусах в радианы</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RAND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает случайное число или случайное число в пределах диапазона</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ROUND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает число, округленное до определенного количества знаков после запятой</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SIGN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает значение, обозначающее знак числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SIN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает синус числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQRT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает квадратный корень из числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает суммарное значение выражения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TAN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает тангенс числа</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRUNCATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает число, усеченное до определенного количества знаков после запятой</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Функции даты</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Функция</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATEDIFF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает дату после добавления определенного интервала времени / даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE_ADD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает время / дату-время после добавления определенного временного интервала</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE_FORMAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущую дату</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE_SUB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущую дату</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущее время</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYNAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущую дату и время</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYOFMONTH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущее время</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYOFWEEK</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает значение даты из выражения даты или даты и времени</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAYOFYEAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает разницу в днях между двумя значениями даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXTRACT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает дату после добавления определенного интервала времени / даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FROM_DAYS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Форматирует дату, указанную маской формата</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HOUR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает дату после вычитания определенного интервала времени / даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LAST_DAY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает дневную часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOCALTIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает имя дня недели для даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOCALTIMESTAMP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает дневную часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAKEDATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает индекс недели для значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAKETIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает день года для значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MICROSECOND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает части с даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MINUTE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает значение даты из числового представления дня</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MONTH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает часовую часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MONTHNAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает последний день месяца на заданную дату</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NOW</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущую дату и время</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PERIOD_ADD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущую дату и время</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PERIOD_DIFF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает дату определенного годового и дневного значения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUARTER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает время для определенного часа, минуты, второй комбинации</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SECOND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает микросекундную часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SEC_TO_TIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает минутную часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STR_TO_DATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает месячную часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUBDATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает полное название месяца для даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUBTIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущую дату и время</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SYSDATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Принимает период и добавляет к нему определенное количество месяцев</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает разницу в месяцах между двумя периодами</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIME_FORMAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает четвертную часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIME_TO_SEC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает вторую часть значения даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMEDIFF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует числовые секунды в значение времени</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMESTAMP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Принимает строку и возвращает дату, заданную маской формата</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TO_DAYS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает дату, после которой вычитается определенный интервал времени / даты</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WEEK</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает значение time / datetime после вычитания определенного временного интервала</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WEEKDAY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает текущую дату и время</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WEEKOFYEAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Извлекает значение времени из выражения time / datetime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>YEAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Форматирует время, указанное маской формата</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>YEARWEEK</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует значение времени в числовые секунды</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Расширенные функции</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Функция</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BIN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует десятичное число в двоичное число</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BINARY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует значение в двоичную строку</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CASE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Позволяет вам оценить условия и вернуть значение при выполнении первого условия</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CAST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует значение из одного типа данных в другой тип данных</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COALESCE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает первое ненулевое выражение в списке</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONNECTION_ID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает уникальный идентификатор соединения для текущего соединения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует число из одной базы чисел в другую</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONVERT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Преобразует значение из одного типа данных в другой или один набор символов в другой</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CURRENT_USER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает имя пользователя и имя хоста для учетной записи MySQL, используемой сервером, для проверки подлинности текущего клиента</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATABASE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает имя базы данных по умолчанию</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает одно значение, если условие TRUE или другое значение, если условие FALSE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IFNULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Позволяет вернуть альтернативное значение, если выражение равно NULL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ISNULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Проверяет, является ли выражение NULL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LAST_INSERT_ID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает первое значение AUTO_INCREMENT, заданное последним оператором INSERT или UPDATE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULLIF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сравнивает два выражения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SESSION_USER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает имя пользователя и имя хоста для текущего пользователя MySQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SYSTEM_USER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает имя пользователя и имя хоста для текущего пользователя MySQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>USER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает имя пользователя и имя хоста для текущего пользователя MySQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VERSION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращает версию базы данных MySQL</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_блокировки">3.6.9. Блокировки</h4>
<div class="paragraph">
<p><strong>Блокировки</strong> - это механизм поддержки требований об изолированности транзакций.</p>
</div>
<div class="paragraph">
<p>Одновременный конкурентный доступ может вызывать разные отрицательные эффекты, например <strong>чтение несуществующих данных</strong> или <strong>потерю модифицированных данных</strong>.</p>
</div>
<div class="paragraph">
<p>Рассмотрим следующий практический пример: Пользователь №1 из отдела кадров получает извещение, что сотрудник "Егор Егоров" поменял место жительства. Он вносит соответствующее изменение в базу данных для данного сотрудника, но при просмотре другой информации об этом сотруднике он понимает, что изменил адрес не того человека. Он нажимает кнопку отмены, уверенный в том, что данные после отмены операции изменения адреса уже не содержат никакой ошибки. В то же самое время пользователь №2 в отделе проектирования обращается к данным второго сотрудника с именем Егор Егоров, чтобы отправить ему домой последнюю техническую документацию, поскольку этот служащий редко бывает в офисе. Однако пользователь №2 обратился к базе данных после того, как адрес этого второго сотрудника с именем Егор Егоров был ошибочно изменен, но до того, как он был исправлен. В результате письмо отправляется не тому адресату. Чтобы предотвратить подобные проблемы, каждая система управления базами данных должна обладать механизмом для управления одновременным доступом к данным всеми пользователями. Для обеспечения согласованности данных в случае одновременного обращения к данным несколькими пользователями, применяют блокировки. Каждая прикладная программа блокирует требуемые ей данные, что гарантирует, что никакая другая программа не сможет модифицировать эти данные. Когда другая прикладная программа пытается получить доступ к заблокированным данным для их модификации, то система или завершает эту попытку ошибкой, или заставляет программу ожидать снятия блокировки.</p>
</div>
<div class="paragraph">
<p>Режимы блокировки определяют разные типы блокировок. Выбор определенного режима блокировки зависит от типа ресурса, который требуется заблокировать. Для блокировок ресурсов уровня строки и страницы применяются следующие три типа блокировок:</p>
</div>
<div class="sect4">
<h5 id="_разделяемая_блокировка_shared_lock">Разделяемая блокировка (shared lock)</h5>
<div class="paragraph">
<p>Резервирует ресурс только для чтения. Другие процессы не могут изменять заблокированный таким образом ресурс, но несколько процессов могут одновременно считывать информацию или накладывать разделяемую блокировку на один и тот же ресурс. Иными словами, чтение ресурса с разделяемой блокировкой могут одновременно выполнять несколько процессов.</p>
</div>
</div>
<div class="sect4">
<h5 id="_монопольная_блокировка_exclusive_lock">Монопольная блокировка (exclusive lock)</h5>
<div class="paragraph">
<p>Резервирует страницу или строку для монопольного использования одной транзакции. Блокировка этого типа применяется такими инструкциями как <em>INSERT</em>, <em>UPDATE</em> и <em>DELETE</em>, которые модифицируют ресурс. Монопольную блокировку нельзя установить, если на ресурс уже установлена разделяемая или монопольная блокировка другим процессом, т.е. на ресурс может быть установлена только одна монопольная блокировка.</p>
</div>
</div>
<div class="sect4">
<h5 id="_блокировка_обновления_update_lock">Блокировка обновления (update lock)</h5>
<div class="paragraph">
<p>Является промежуточной между разделяемой блокировкой и монопольной. Блокировка обновления устанавливается при намерении транзакции изменить данные, но при этом само изменение не происходит. В этом случае другим транзакциям разрешается устанавливать разделяемые блокировки, но не позволяется устанавливать монопольные блокировки, до тех пор пока транзакция не завершится.</p>
</div>
</div>
<div class="sect4">
<h5 id="_блокировки_намерения">Блокировки намерения</h5>
<div class="paragraph">
<p>Чтобы наложить монопольную блокировку на страницу данных, сервер должен убедиться, что ни на одну из записей, входящих в эту страницу, никакая блокировка не наложена. То есть необходимо перебрать все записи, входящие в страницу, и проверить их на наличие блокировок. То же самое, только в гораздо большем объеме, необходимо делать и для таблицы. Это было бы достаточно дорогостоящей операцией, но тут на помощь приходят блокировки намерения. Прежде чем ставить блокировку на конкретную запись, ставится соответствующая блокировка намерения на таблицу и страницу. Таким образом, отпадает необходимость проверять все записи, достаточно проверить, есть ли блокировка намерения на соответствующем уровне иерархии.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sql_транзакции">3.6.10. SQL-транзакции</h4>
<div class="paragraph">
<p><strong>Транзакция</strong> представляет собой единицу работы, которая выполняется с базой данных.</p>
</div>
<div class="paragraph">
<p>Транзакцию можно рассматривать как внесение одного или нескольких изменений в базу данных. Например, если необходимо создать запись или выполнить обновление, удаление записи из таблицы, то выполняется транзакция в этой таблице.</p>
</div>
<div class="sect4">
<h5 id="_свойства_транзакций">Свойства транзакций</h5>
<div class="paragraph">
<p>Транзакции имеют следующие четыре стандартных свойств, как правило, называют аббревиатурой <strong>ACID</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Atomicity</strong> – гарантирует, что все операции в рамках единицы работы завершены успешно, иначе транзакция прерывается в точке выхода из строя, и все предыдущие операции откатываются в прежнее состояние.</p>
</li>
<li>
<p><strong>Consistency</strong> – гарантирует, что база данных правильно изменяет состояния на более успешное совершенные транзакции.</p>
</li>
<li>
<p><strong>Isolation</strong> – позволяет транзакции работать независимо и прозрачно друг с другом.</p>
</li>
<li>
<p><strong>Durability</strong> – гарантирует, что результат или эффект зафиксированной транзакции сохраняется в случае сбоя системы.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_управление_транзакцией">Управление транзакцией</h5>
<div class="paragraph">
<p>Следующие команды используются для управления операциями.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>COMMIT</code> – для сохранения изменений.</p>
</li>
<li>
<p><code>ROLLBACK</code> – откат изменений.</p>
</li>
<li>
<p><code>SAVEPOINT</code> – создает точки внутри групп операций, которые следует откатить.</p>
</li>
<li>
<p><code>SET TRANSACTION</code> – устанавливает характеристики транзакции.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_уровни_изоляции">Уровни изоляции</h5>
<div class="paragraph">
<p>Чаще всего транзакции не должна зависеть от других транзакций, но применение жестких ограничений (блокировок) приводит к эффекту выстраивания в очередь транзакций на выполнение, что замедляет производительность системы.
Но бывают случаи, когда жесткие ограничения не нужны, поэтому существуют <strong>уровни изоляции</strong>, которые определяют степень параллелизма транзакций.
Существуют четыре вида изоляции:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Read uncommitted</strong>;</p>
</li>
<li>
<p><strong>Read committed</strong>;</p>
</li>
<li>
<p><strong>Repeatable read</strong>;</p>
</li>
<li>
<p><strong>Serializable</strong>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_read_uncommitted_dirty_read">Read uncommitted (Dirty read)</h6>
<div class="paragraph">
<p>Позволяет читать данные незафиксированных транзакций.
<strong>Пример</strong>: первая транзакция ввела данные, но не зафиксировала изменения, вторая прочитала, но первая отменила свои изменения данных.
В таком случае, получилась ситуация, в которой вторая транзакция прочитала несуществующие данные. Такой эффект называют <strong>грязным чтением</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_read_committed">Read Committed</h6>
<div class="paragraph">
<p>При таком уровне изоляции транзакции не дадут прочитать данные, которые не зафиксировала другая транзакция после изменения.</p>
</div>
<div class="paragraph">
<p>Если первая транзакция один раз прочитала данные, а вторая транзакция сразу же их изменила и зафиксировала, то повторное чтение данных первой транзакции вернет измененные значения.
В таком случае может возникнуть ситуация, при которой первая транзакция, к концу своего выполнения, обладает недостоверной информацией, которая может повлиять на вносимые данные.</p>
</div>
</div>
<div class="sect5">
<h6 id="_repeatable_read">Repeatable Read</h6>
<div class="paragraph">
<p>Изменение данных, которые ранее прочитала первая транзакция, другими транзакциями до завершения первой невозможно.
Однако имеет место ситуация, когда другие транзакции будут не изменять, а добавлять новые данные, удовлетворяющие условию выборки первой транзакции по определенному условию.
В таком случае повторная выборка первой транзакции вернет новые значения.</p>
</div>
</div>
<div class="sect5">
<h6 id="_serializable">Serializable</h6>
<div class="paragraph">
<p><strong>Serializable</strong> - уровень изоляции который бьет по производительности системы, но позволяет избежать проблем с чтением данных.
При таком уровне транзакции работают последовательно.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_объекты_бд">3.7. Объекты БД</h3>
<div class="sect3">
<h4 id="_виды_объектов_бд">3.7.1. Виды объектов БД</h4>
<div class="paragraph">
<p><strong>Объектами баз данных</strong> называют их структурные составляющие, такие, как <strong>схемы</strong> (<strong>schema</strong>), <strong>таблицы</strong> (<strong>table</strong>), <strong>представления</strong> (<strong>view</strong>), <strong>функции</strong> (<strong>function</strong>), <strong>процедуры</strong> (<strong>procedure</strong>), <strong>триггеры</strong> (<strong>trigger</strong>), <strong>последовательности</strong> (<strong>sequence</strong>), <strong>ограничения</strong> (<strong>constraints</strong>). Они выполняют различные функции по хранению и обработке информации.</p>
</div>
<div class="sect4">
<h5 id="_схемы">Схемы</h5>
<div class="paragraph">
<p><strong>Схема</strong> (<strong>schema</strong>) — это логический контейнер таблиц и других объектов внутри базы данных, причем каждая база данных может иметь одну или несколько схем.</p>
</div>
<div class="paragraph">
<p>Схемы применяются, чтобы объединить объекты базы данных в логические группы для облегчения управления ими и избежания конфликта имен различных приложений внутри схемы.</p>
</div>
<div class="paragraph">
<div class="title">Схемы</div>
<p><span class="image"><img src="../assets/img/bd-object/postgresql-schema.png" alt="postgresql schema"></span></p>
</div>
<div class="sect5">
<h6 id="_создание_схемы_сreate_schema">Создание схемы (<code>СREATE SCHEMA</code>)</h6>
<div class="paragraph">
<p>Для создания схемы необходимо использовать следующий запрос:</p>
</div>
<div class="listingblock">
<div class="title">Создание схемы</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE SCHEMA имя_схемы;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Таблица, при создании без указания схемы, автоматически помещается в схему <code>public</code>, для создания таблицы в определенной схеме, необходимо указать её имя:</p>
</div>
<div class="listingblock">
<div class="title">Cоздание таблицы в определенной схеме</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE имя_схемы.имя_таблицы ( ... );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Часто бывает нужно создать схему, владельцем которой будет другой пользователь (это один из способов ограничения пользователей пространствами имён). Сделать это можно следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE SCHEMA имя_схемы AUTHORIZATION имя_пользователя;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Возможно опустить имя схемы, в этом случае именем схемы станет имя пользователя. Схемы с именами, начинающимися с <code>pg_</code>, являются системными - пользователям не разрешено использовать такие имена.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE SCHEMA IF NOT EXISTS имя_схемы AUTHORIZATION имя_пользователя;</code></pre>
</div>
</div>
<div class="paragraph">
<p>где <code>IF NOT EXISTS</code> означает <strong>не делать ничего</strong>  (только выдать замечание), если схема с таким именем уже существует.</p>
</div>
<div class="paragraph">
<p><strong>Пример</strong>, создание схемы, в которой сразу создаются таблица и представление:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE SCHEMA hollywood
CREATE TABLE films (title text, release date, awards text[])
CREATE VIEW winners AS
SELECT title, release FROM films WHERE awards IS NOT NULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы создать объекты в схеме или обратиться к ним, необходимо указать полное имя, состоящее из имён схемы и объекта, разделённых точкой:</p>
</div>
<div class="listingblock">
<div class="title">Правило обращения к объекту внутри схемы</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">схема.объект</code></pre>
</div>
</div>
<div class="paragraph">
<p>Есть ещё более общий синтаксис</p>
</div>
<div class="listingblock">
<div class="title">Обращение к объекту через базу данных</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">база_данных.схема.объект</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_схемы_drop_schema">Удаление схемы (<code>DROP SCHEMA</code>)</h6>
<div class="paragraph">
<p>Удалить схему, которая не содержит внутри себя объектов, можно следующим способом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP SCHEMA имя_схемы;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Удалить схему со всеми содержащимися в ней объектами:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP SCHEMA имя_схемы CASCADE;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>RESTRICT</code> позволяет отказать в удалении схемы, если она содержит какие-либо объекты. Это поведение по умолчанию.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP SCHEMA имя_схемы RESTRICT;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_схемы_alter_schema">Изменение схемы (<code>ALTER SCHEMA</code>)</h6>
<div class="paragraph">
<p><code>ALTER SCHEMA</code> — позволяет изменить определение схемы.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER SCHEMA имя RENAME TO новое_имя

ALTER SCHEMA имя OWNER TO { новый_владелец | CURRENT_USER | SESSION_USER }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>имя</code> - имя существующей схемы.</p>
</li>
<li>
<p><code>новое_имя</code> - новое имя схемы. Новое имя не может начинаться с <code>pg_</code>, так как такие имена зарезервированы для системных схем.</p>
</li>
<li>
<p><code>новый_владелец</code> - новый владелец схемы.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_схемы_и_права">Схемы и права</h6>
<div class="paragraph">
<p>По умолчанию пользователь не может обращаться к объектам в чужих схемах. Чтобы изменить это, владелец схемы должен дать пользователю право <code>USAGE</code> для данной схемы. Чтобы пользователи могли использовать объекты схемы, может понадобиться назначить дополнительные права на уровне объектов.</p>
</div>
<div class="paragraph">
<p>Пользователю также можно разрешить создавать объекты в схеме, не принадлежащей ему. Для этого ему нужно дать право <code>CREATE</code> в требуемой схеме. Требуется помнить, что по умолчанию все имеют права <code>CREATE</code> и <code>USAGE</code> в схеме <code>public</code>. Благодаря этому все пользователи могут подключаться к заданной базе данных и создавать объекты в её схеме <code>public</code>.</p>
</div>
<div class="paragraph">
<p>Некоторые шаблоны использования позволяют запретить это:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">REVOKE CREATE ON SCHEMA public FROM PUBLIC;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_таблицы_2">Таблицы</h5>
<div class="paragraph">
<p><strong>Таблицы</strong> используются для хранения данных, в базе данных может находиться несколько таблиц.</p>
</div>
<div class="paragraph">
<div class="title">Таблицы</div>
<p><span class="image"><img src="../assets/img/bd-object/postgresql-tables.png" alt="postgresql tables"></span></p>
</div>
<div class="sect5">
<h6 id="_создание_таблицы_create_table_2">Создание таблицы (<code>CREATE TABLE</code>)</h6>
<div class="paragraph">
<p>Для создания таблицы используется команда <code>CREATE TABLE</code>. В этой команде необходимо указать как минимум имя новой таблицы и имена, типы данных каждого столбца.</p>
</div>
<div class="paragraph">
<p><strong>Например</strong>:</p>
</div>
<div class="listingblock">
<div class="title">Создание таблицы</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE my_first_table (
    first_column text,
    second_column integer
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Число столбцов в таблице <strong>не может быть бесконечным</strong>. Это число ограничивается максимумом в пределах`от <code>250</code> до <code>1600</code>, в зависимости от типов столбцов. Однако, создавать таблицы с таким большим числом столбцов обычно не требуется, а если такая потребность возникает, это скорее признак сомнительного дизайна.</p>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_таблицы_drop_table">Удаление таблицы (<code>DROP TABLE</code>)</h6>
<div class="paragraph">
<p>Если таблица больше не нужна, можно удалить её, выполнив следующую команду <code>DROP TABLE</code>:</p>
</div>
<div class="listingblock">
<div class="title">Удаление таблицы</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP TABLE my_first_table;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_таблицы_alter_table">Изменение таблицы (<code>ALTER TABLE</code>)</h6>
<div class="paragraph">
<p><code>ALTER TABLE</code> меняет определение существующей таблицы.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE [ IF EXISTS ] [ ONLY ] имя [ * ]
действие [, ... ]

ALTER TABLE [ IF EXISTS ] [ ONLY ] имя [ * ]
RENAME [ COLUMN ] имя_столбца TO новое_имя_столбца

ALTER TABLE [ IF EXISTS ] [ ONLY ] имя [ * ]
RENAME CONSTRAINT имя_ограничения TO имя_нового_ограничения

ALTER TABLE [ IF EXISTS ] имя
RENAME TO новое_имя

ALTER TABLE [ IF EXISTS ] имя
SET SCHEMA новая_схема</code></pre>
</div>
</div>
<div class="paragraph">
<p>Действия могут быть различными, приведем несколько примеров:</p>
</div>
<div class="listingblock">
<div class="title">Действия</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ADD [ COLUMN ] [ IF NOT EXISTS ] имя_столбца тип_данных
[ COLLATE правило_сортировки ] [ ограничение_столбца [ ... ] ]

DROP [ COLUMN ] [ IF EXISTS ] имя_столбца [ RESTRICT | CASCADE ]

ADD ограничение_таблицы [ NOT VALID ]

DROP CONSTRAINT [ IF EXISTS ] имя_ограничения [ RESTRICT | CASCADE ]

DISABLE TRIGGER [ имя_триггера | ALL | USER ]

ENABLE TRIGGER [ имя_триггера | ALL | USER ]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_представления_view">Представления (View)</h5>
<div class="paragraph">
<p><strong>Представления</strong> (<strong>View</strong>) - это именованные <strong>правила выборки данных</strong>.
Они предназначены для извлечения данных из одной или нескольких таблиц, на которые основываются.</p>
</div>
<div class="paragraph">
<p>Еще можно сказать, что <strong>представление это виртуальная таблица</strong>, которая используется для упрощения сложных запросов и обеспечения безопасности для набора записей.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/bd-object/postgresql-views.png" alt="postgresql views"></span></p>
</div>
<div class="paragraph">
<p><strong>Преимущества представления</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Обеспечивают независимость пользовательских программ от изменения логической структуры базы данных.</p>
</li>
<li>
<p>Возможность различным пользователям по-разному видеть одни и те же данные.</p>
</li>
<li>
<p>Дополнительный механизм для управления санкционированным доступом.
Представления защищают данные, так как могут дать доступ к части таблицы, а не ко всей таблице.</p>
</li>
<li>
<p>Повторное использование написанного запроса.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_создание_представления_create_view">Создание представления (<code>CREATE VIEW</code>)</h6>
<div class="paragraph">
<p>Предположим, что появилась необходимость вывести список из названий городов, но нет потребности каждый раз вводить весь запрос.
Можно создать <strong>представление</strong> по данному запросу, фактически присвоить имя запросу, а затем обращаться к нему как к обычной таблице:</p>
</div>
<div class="listingblock">
<div class="title">Создание и использование представления:</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE VIEW myview AS
    SELECT name
    FROM cities;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь получить список названий (<code>name</code>) всех городов можно через представление используя следующий запрос:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * FROM myview;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для изменения представления можно воспользоваться запросом:</p>
</div>
<div class="listingblock">
<div class="title">Изменение представления благодаря <code>OR REPLACE</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE OR REPLACE VIEW myview AS
    SELECT name, id
    FROM cities;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Команда <code>CREATE OR REPLACE VIEW</code> действует подобным образом, но если представление с этим именем уже существует, оно заменяется.
Новый запрос должен выдавать те же столбцы, что выдавал запрос, ранее определённый для этого представления, (то есть, столбцы с такими же именами должны иметь те же типы данных и следовать в том же порядке), но может добавить несколько новых столбцов в конце списка.
Вычисления, в результате которых формируются столбцы представления, могут быть совершенно другими.</p>
</div>
<div class="paragraph">
<p>Это означает, что <strong>возникнет ошибка</strong>, если переопределить представление следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE OR REPLACE VIEW myview AS
    SELECT id, name
    FROM cities;

ERROR: ОШИБКА:  изменить имя столбца "name" на "id" в представлении нельзя</code></pre>
</div>
</div>
<div class="paragraph">
<p>Или при попытке исключить столбец:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE OR REPLACE VIEW myview AS
    SELECT id
    FROM cities;

ERROR: ОШИБКА:  удалять столбцы из представления нельзя</code></pre>
</div>
</div>
<div class="paragraph">
<p>Рассмотрим механизм создания представления поподробнее.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис создания представления</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE [ OR REPLACE ] [ TEMP | TEMPORARY ] [ RECURSIVE ] VIEW имя [ ( имя_столбца
[, ...] ) ]
[ WITH ( имя_параметра_представления [= значение_параметра_представления]
[, ... ] ) ]
AS запрос
[ WITH [ CASCADED | LOCAL ] CHECK OPTION ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TEMPORARY</code> или <code>TEMP</code> - с такими параметрами представление создаётся как временное. Временные представления автоматически удаляются в конце сеанса. Существующее постоянное представление с тем же именем не будет видно в текущем сеансе, пока существует временное, однако к нему можно обратиться, дополнив имя указанием схемы. Если в определении представления задействованы временные таблицы, представление так же создаётся как временное (вне зависимости от присутствия явного указания <code>TEMPORARY</code>).</p>
</li>
<li>
<p><code>RECURSIVE</code> - создаёт рекурсивное представление.</p>
</li>
<li>
<p><code>запрос</code> - команда <code>SELECT</code> или <code>VALUES</code>, которая выдаёт столбцы и строки представления.</p>
</li>
<li>
<p><code>WITH [ CASCADED | LOCAL ] CHECK OPTION</code> - это указание управляет поведением автоматически изменяемых представлений. Если оно присутствует, при выполнении операций <code>INSERT</code> и <code>UPDATE</code> с этим представлением будет проверяться, удовлетворяют ли новые строки условию, определяющему представление (то есть, проверяется, будут ли новые строки видны через это представление). Если они не удовлетворяют условию, операция не будет выполнена. Если указание <code>CHECK OPTION</code> отсутствует, команды <code>INSERT</code> и <code>UPDATE</code> смогут создавать в этом представлении строки, которые не будут видны в нём.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Поддерживаются следующие варианты проверки:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LOCAL</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Новые строки проверяются только по условиям, определённым непосредственно в самом представлении. Любые условия, определённые в нижележащих базовых представлениях, не проверяются (если только в них нет указания <code>CHECK OPTION</code>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CASCADED</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Новые строки проверяются по условиям данного представления и всех нижележащих базовых. Если указано <code>CHECK OPTION</code>, а <code>LOCAL</code> и <code>CASCADED</code> опущено, подразумевается указание <code>CASCADED</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_представления_drop_view">Удаление представления (<code>DROP VIEW</code>)</h6>
<div class="paragraph">
<p>Удалить представление можно следующим образом:</p>
</div>
<div class="listingblock">
<div class="title">Удаление представления</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP VIEW имя_представления;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Удаление представления с объектами, зависящие от данного представления</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP VIEW имя_представления CASCADE;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Отказать в удалении представления, если от него зависят какие-либо объекты. Это поведение по умолчанию</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP VIEW имя_представления RESTRICT;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_определения_представления_alter_view">Изменение определения представления (<code>ALTER VIEW</code>)</h6>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER VIEW [ IF EXISTS ] имя ALTER [ COLUMN ] имя_столбца SET DEFAULT выражение

ALTER VIEW [ IF EXISTS ] имя ALTER [ COLUMN ] имя_столбца DROP DEFAULT

ALTER VIEW [ IF EXISTS ] имя OWNER TO { новый_владелец | CURRENT_USER | SESSION_USER }

ALTER VIEW [ IF EXISTS ] имя RENAME TO новое_имя

ALTER VIEW [ IF EXISTS ] имя SET SCHEMA новая_схема

ALTER VIEW [ IF EXISTS ] имя SET ( имя_параметра_представления
[= значение_параметра_представления] [, ... ] )

ALTER VIEW [ IF EXISTS ] имя RESET ( имя_параметра_представления [, ... ] )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Выполнить <code>ALTER VIEW</code> может только владелец представления. Чтобы сменить схему представления, необходимо также иметь право <code>CREATE</code> в новой схеме. Чтобы сменить владельца, требуется также быть непосредственным или опосредованным членом новой роли, а эта роль должна иметь право <code>CREATE</code> в схеме представления.</p>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>имя</code> - имя существующего представления (возможно, дополненное схемой).</p>
</li>
<li>
<p><code>IF EXISTS</code> - не считать ошибкой, если представление не существует.
В этом случае будет выдано замечание.</p>
</li>
<li>
<p><code>SET/DROP DEFAULT</code> - эти формы устанавливают или удаляют значение по умолчанию в заданном столбце.
Значение по умолчанию подставляется в команды <code>INSERT</code> и <code>UPDATE</code>, вносящие данные в представление, до применения каких-либо правил или триггеров в этом представлении.
Таким образом, значения по умолчанию в представлении имеют приоритет перед значениями по умолчанию в нижележащих отношениях.</p>
</li>
<li>
<p><code>новый_владелец</code> - имя пользователя, назначаемого новым владельцем представления.</p>
</li>
<li>
<p><code>новое_имя</code> - новое имя представления.</p>
</li>
<li>
<p><code>новая_схема</code> - новая схема представления.</p>
</li>
<li>
<p><code>SET</code> и <code>RESET</code> - устанавливает или сбрасывает параметры представления.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_материализованное_представление_matview">Материализованное представление (matview)</h5>
<div class="paragraph">
<p><strong>Материализованное представление</strong> — это объект базы данных, который содержит результаты запроса.</p>
</div>
<div class="paragraph">
<p>Материализованное представление похоже на представление базы данных, за исключением того, что оно физически хранится на диске и обновляется вручную.
<strong>Matview</strong> хранит результаты запроса в собственной табличной структуре, из которой можно запрашивать данные.
<strong>Невозможно добавлять или удалять строки</strong>, но в остальное время он ведет себя как настоящая таблица.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Разница <strong>vies</strong> и <strong>matview</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Что сравниваем</th>
<th class="tableblock halign-left valign-top">VIEW</th>
<th class="tableblock halign-left valign-top">MATVIEW</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Способ хранения</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VIEW никогда не сохраняется, он только отображается.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Материализованное представление хранится на диске.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Способ обновления</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Представление обновляется каждый раз, когда используется виртуальная таблица (представление).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Материализованное представление должно обновляться вручную или с использованием триггеров.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Скорость</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Медленная обработка.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Быстрая обработка.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Использованием памяти</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Просмотр не требует места в памяти.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Материализованный вид использует пространство памяти.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Создание материализованного представления</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE MATERIALIZED VIEW [ IF NOT EXISTS ] имя_таблицы
    [ (имя_столбца [, ...] ) ]
    [ WITH ( параметр_хранения [= значение] [, ... ] ) ]
    [ TABLESPACE табл_пространство ]
AS запрос
    [ WITH [ NO ] DATA ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>IF NOT EXISTS</code> - не считать ошибкой, если материализованное представление с таким именем уже существует. В этом случае будет выдано замечание. Заметьте, что нет никакой гарантии, что существующее материализованное представление как-то соотносится с тем, которое могло бы быть создано.</p>
</li>
<li>
<p><code>имя_таблицы</code> - имя создаваемого материализованного представления (возможно, дополненное схемой).</p>
</li>
<li>
<p><code>имя_столбца</code> - имя столбца в создаваемом материализованном представлении. Если имена столбцов не заданы явно, они определяются по именам столбцов результата запроса.</p>
</li>
<li>
<p><code>WITH ( параметр_хранения [= значение] [, &#8230;&#8203; ] )</code>
Это предложение задаёт дополнительные параметры хранения для создаваемого материализованного представления. Все параметры, которые поддерживает <code>CREATE TABLE</code>, поддерживает и <code>CREATE MATERIALIZED VIEW</code>.</p>
</li>
<li>
<p><code>TABLESPACE (табл_пространство)</code> — имя табличного пространства, в котором будет создано материализованное представление.</p>
</li>
<li>
<p><code>запрос</code> - команды <code>SELECT</code> или <code>VALUES</code>. Эти команды будут выполняться с ограничениями по безопасности. В частности, будут запрещены вызовы функций, которые сами создают временные таблицы.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_удаление_материализованного_представления_drop_materialized_view">Удаление материализованного представления (<code>DROP MATERIALIZED VIEW</code>)</h6>
<div class="listingblock">
<div class="title">Удаление материализованного представления</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP MATERIALIZED VIEW [ IF EXISTS ] имя [, ...] [ CASCADE | RESTRICT ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>где</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CASCADE</code> - автоматически удалять объекты, зависящие от данного материализованного представления (например, другие материализованные или обычные представления), и, в свою очередь, все зависящие от них объекты.</p>
</li>
<li>
<p><code>RESTRICT</code> - отказать в удалении материализованного представления, если от него зависят какие-либо объекты. Это поведение по умолчанию.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_материализованного_представления_alter_materialized_view">Изменение материализованного представления (<code>ALTER MATERIALIZED VIEW</code>)</h6>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER MATERIALIZED VIEW [ IF EXISTS ] имя
действие [, ... ]

ALTER MATERIALIZED VIEW имя
DEPENDS ON EXTENSION имя_расширения

ALTER MATERIALIZED VIEW [ IF EXISTS ] имя
RENAME [ COLUMN ] имя_столбца TO новое_имя_столбца

ALTER MATERIALIZED VIEW [ IF EXISTS ] имя
RENAME TO новое_имя

ALTER MATERIALIZED VIEW [ IF EXISTS ] имя
SET SCHEMA новая_схема</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Возможные действия</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER [ COLUMN ] имя_столбца SET STATISTICS integer

ALTER [ COLUMN ] имя_столбца SET ( атрибут = значение [, ... ] )

ALTER [ COLUMN ] имя_столбца RESET ( атрибут [, ... ] )

SET ( параметр_хранения [= значение] [, ... ] )

RESET ( параметр_хранения [, ... ] )

OWNER TO { новый_владелец | CURRENT_USER | SESSION_USER }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ALTER MATERIALIZED VIEW</code> изменяет различные расширенные свойства существующего материализованного представления.</p>
</div>
<div class="paragraph">
<p>Выполнить <code>ALTER MATERIALIZED VIEW</code> может только владелец материализованного представления. Чтобы сменить схему материализованного представления, необходимо также иметь право <code>CREATE</code> в новой схеме. Чтобы сменить владельца, требуется также быть непосредственным или опосредованным членом новой роли, а эта роль должна иметь право <code>CREATE</code> в схеме материализованного представления.</p>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>имя</code> - имя существующего материализованного представления (возможно, дополненное схемой).</p>
</li>
<li>
<p><code>имя_столбца</code> - имя нового или существующего столбца.</p>
</li>
<li>
<p><code>имя_расширения</code> - имя расширения, от которого будет зависеть материализованное представление.</p>
</li>
<li>
<p><code>новое_имя_столбца</code> - новое имя существующего столбца.</p>
</li>
<li>
<p><code>новый_владелец</code> - имя пользователя, назначаемого новым владельцем материализованного представления.</p>
</li>
<li>
<p><code>новое_имя</code> - новое имя материализованного представления.</p>
</li>
<li>
<p><code>новая_схема</code> - новая схема материализованного представления.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_замена_содержимого_материализованного_представления_refresh_materialized_view">Замена содержимого материализованного представления (<code>REFRESH MATERIALIZED VIEW</code>)</h6>
<div class="listingblock">
<div class="title">Cинтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">REFRESH MATERIALIZED VIEW [ CONCURRENTLY ] имя
[ WITH [ NO ] DATA ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>REFRESH MATERIALIZED VIEW</code> полностью заменяет содержимое материализованного представления. Эту команду разрешено выполнять только владельцам материализованного представления. Старое его содержимое при этом аннулируется. Если добавлено указание <code>WITH DATA</code> (или нет никакого), нижележащий запрос выполняется и выдаёт новые данные, так что материализованное представление остаётся в сканируемом состоянии. Если указано <code>WITH NO DATA</code>, новые данные не выдаются, и оно оказывается в несканируемом состоянии. Указать <code>CONCURRENTLY</code> вместе с <code>WITH NO DATA</code> нельзя.</p>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONCURRENTLY</code> - обновить материализованное представление, не блокируя параллельные выборки из него. Без данного параметра обновление, затрагивающее много строк, обычно задействует меньше ресурсов и выполнится быстрее, но может препятствовать чтению этого материализованного представления другими сеансами. При этом данный режим может быть быстрее при небольшом количестве строк. Данный параметр допускается, только если в материализованном представлении есть хотя бы один индекс <code>UNIQUE</code>, построенный только по именам столбцов и включающий все строки (то есть это не должен быть индекс по выражению или индекс, содержащий <code>WHERE</code>). Этот параметр нельзя использовать, когда материализованное представление ещё не наполнено. Даже с этим параметром в один момент времени допускается только одно обновление (<code>REFRESH</code>) материализованного представления.</p>
</li>
<li>
<p><code>имя</code> - имя (возможно, дополненное схемой) материализованного представления, подлежащего обновлению.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_функции_2">Функции</h5>
<div class="paragraph">
<p><strong>Функция</strong> — это многократно используемый блок кода SQL, который возвращает скалярное значение списка записей.</p>
</div>
<div class="paragraph">
<div class="title">Функции</div>
<p><span class="image"><img src="../assets/img/bd-object/postgresql-functions.png" alt="postgresql functions"></span></p>
</div>
<div class="sect5">
<h6 id="_создание_функции_create_function">Создание функции (<code>CREATE FUNCTION</code>)</h6>
<div class="paragraph">
<p>Чтобы заменить текущее определение существующей функции, используется команда <code>CREATE OR REPLACE FUNCTION</code>. Но следует учесть, что она не позволяет изменить имя или аргументы функции (если попытаться сделать это, на самом деле будет создана новая, независимая функция). Кроме того, <code>CREATE OR REPLACE FUNCTION</code> не позволит изменить тип результата существующей функции. Чтобы сделать это, придётся удалить функцию и создать её заново. Если удалить и затем вновь создадать функцию, новая функция станет другой сущностью, отличной от старой - потребуется так же удалить существующие правила, представления, триггеры, ссылающиеся на старую функцию. Поэтому, чтобы изменить определение функции, сохраняя ссылающиеся на неё объекты, следует использовать <code>CREATE OR REPLACE FUNCTION</code>.</p>
</div>
<div class="paragraph">
<p>Владельцем функции становится создавший её пользователь. Чтобы создать функцию, необходимо иметь право <code>USAGE</code> для типов её аргументов и возвращаемого типа.</p>
</div>
<div class="listingblock">
<div class="title">Cинтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE [ OR REPLACE ] FUNCTION
    имя ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента [ { DEFAULT |
= } выражение_по_умолчанию ] [, ...] ] )
    [ RETURNS тип_результата
    | RETURNS TABLE ( имя_столбца тип_столбца [, ...] ) ]
{ LANGUAGE имя_языка
    | TRANSFORM { FOR TYPE имя_типа } [, ... ]
    | WINDOW
    | { IMMUTABLE | STABLE | VOLATILE }
    | [ NOT ] LEAKPROOF
    | { CALLED ON NULL INPUT | RETURNS NULL ON NULL INPUT | STRICT }
    | { [ EXTERNAL ] SECURITY INVOKER | [ EXTERNAL ] SECURITY DEFINER }
    | PARALLEL { UNSAFE | RESTRICTED | SAFE }
    | COST стоимость_выполнения
    | ROWS строк_в_результате
    | SUPPORT вспомогательная_функция
    | SET параметр_конфигурации { TO значение | = значение | FROM CURRENT }
    | AS 'определение'
    | AS 'объектный_файл', 'объектный_символ'
} ...</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Основные параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>имя</code> - имя создаваемой функции (возможно, дополненное схемой).</p>
</li>
<li>
<p><code>режим_аргумента</code> - режим аргумента: <code>IN</code> (входной), <code>OUT</code> (выходной), <code>INOUT</code> (входной и выходной) или <code>VARIADIC</code> (переменный). По умолчанию подразумевается <code>IN</code>. За единственным аргументом <code>VARIADIC</code> могут следовать только аргументы <code>OUT</code>. Кроме того, аргументы <code>OUT</code> и <code>INOUT</code> нельзя использовать с предложением <code>RETURNS TABLE</code>.</p>
</li>
<li>
<p><code>имя_аргумента</code> - имя аргумента.</p>
</li>
<li>
<p><code>тип_аргумента</code> - тип данных аргумента функции (возможно, дополненный схемой), при наличии аргументов. Тип аргументов может быть базовым, составным или доменным, либо это может быть ссылка на столбец таблицы.</p>
</li>
<li>
<p><code>выражение_по_умолчанию</code> - выражение, используемое для вычисления значения по умолчанию, если параметр не задан явно. Результат выражения должен сводиться к типу соответствующего параметра.</p>
</li>
<li>
<p><code>тип_результата</code> - тип возвращаемых данных (возможно, дополненный схемой). Это может быть базовый, составной или доменный тип, либо ссылка на тип столбца таблицы.</p>
</li>
<li>
<p><code>имя_столбца</code> - имя выходного столбца в записи <code>RETURNS TABLE</code>.</p>
</li>
<li>
<p><code>тип_столбца</code> - тип данных выходного столбца в записи <code>RETURNS TABLE</code>.</p>
</li>
<li>
<p><code>имя_языка</code> - имя языка, на котором реализована функция.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Пример</strong>:</p>
</div>
<div class="listingblock">
<div class="title">Пример создания функции на языке <code>SQL</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE FUNCTION add(integer, integer) RETURNS integer
    AS 'select $1 + $2;'
    LANGUAGE SQL
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Пример создания функции на языке <code>PL/pgSQL</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE FUNCTION add(integer, integer) RETURNS integer AS $$
    BEGIN
    RETURN $1 + $2;
    END; $$
    LANGUAGE plpgsql
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Вызов функции <code>add</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * FROM add(100,12);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ответом функции будет значение <code>112</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_функции_drop_function">Удаление функции (<code>DROP FUNCTION</code>)</h6>
<div class="paragraph">
<p><code>DROP FUNCTION</code> удаляет определение существующей функции. Пользователь, выполняющий эту команду, должен быть владельцем функции. Помимо имени функции требуется указать типы её аргументов, так как в базе данных могут существовать несколько функций с одним именем, но с разными списками аргументов.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP FUNCTION [ IF EXISTS ] имя [ ( [ [ режим_аргумента ] [ имя_аргумента
] тип_аргумента [, ...] ] ) ] [, ...]
[ CASCADE | RESTRICT ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>имя</code> - имя существующей функции (возможно, дополненное схемой). Если список аргументов не указан, имя функции должно быть уникальным в её схеме.</p>
</li>
<li>
<p><code>режим_аргумента</code> - режим аргумента: <code>IN</code>, <code>OUT</code>, <code>INOUT</code> или <code>VARIADIC</code>. По умолчанию подразумевается <code>IN</code>. Заметьте, что <code>DROP FUNCTION</code> не учитывает аргументы <code>OUT</code>, так как для идентификации функции нужны только типы входных аргументов.
Поэтому достаточно перечислить только аргументы <code>IN</code>, <code>INOUT</code> и <code>VARIADIC</code>.</p>
</li>
<li>
<p><code>имя_аргумента</code> - имя аргумента.</p>
</li>
<li>
<p><code>тип_аргумента</code> - тип данных аргументов функции (возможно, дополненный именем схемы), если таковые имеются.</p>
</li>
<li>
<p><code>CASCADE</code> - автоматически удалять объекты, зависящие от данной функции (например, операторы или триггеры), и, в свою очередь, все зависящие от них объекты.</p>
</li>
<li>
<p><code>RESTRICT</code> - отказать в удалении функции, если от неё зависят какие-либо объекты. Это поведение по умолчанию.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_изменить_определение_функции_alter_function">Изменить определение функции (<code>ALTER FUNCTION</code>)</h6>
<div class="paragraph">
<p><code>ALTER FUNCTION</code> позволяет изменить определение функции</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER FUNCTION имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
действие [ ... ] [ RESTRICT ]

ALTER FUNCTION имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
RENAME TO новое_имя

ALTER FUNCTION имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
OWNER TO { новый_владелец | CURRENT_USER | SESSION_USER }

ALTER FUNCTION имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
SET SCHEMA новая_схема

ALTER FUNCTION имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
[ NO ] DEPENDS ON EXTENSION имя_расширения</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Примеры</strong>:</p>
</div>
<div class="listingblock">
<div class="title">Переименование функции</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER FUNCTION sqrt(integer) RENAME TO square_root;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Смена владельца функции</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER FUNCTION sqrt(integer) OWNER TO joe;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_хранимые_процедуры">Хранимые процедуры</h5>
<div class="paragraph">
<p>Когда с данными нужно делать одни и те же действия очень часто на помощь приходят процедуры.</p>
</div>
<div class="paragraph">
<p><strong>Процедуры</strong> (<strong>procedure</strong>) - это блок операторов написанных на процедурном расширении языка <code>SQL</code> в контексте конкретной <strong>СУБД</strong>. Процедуры хранятся в базе данных в специально приспособленных для этого системных таблицах. Процедуры и функции могут быть вызваны на использование внутри базы данных или из клиентского приложения, но не возвращают результат, а функции возвращают.</p>
</div>
<div class="paragraph">
<p>Процедура является объектом базы данных, подобный функции, но имеющий следующие отличия:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Процедуры определяются командой <code>CREATE PROCEDURE</code>.</p>
</li>
<li>
<p>Процедуры, в отличие от функций, не возвращают значение; поэтому в <code>CREATE PROCEDURE</code> отсутствует предложение <code>RETURNS</code>. Однако процедуры могут выдавать данные в вызывающий код через выходные параметры.</p>
</li>
<li>
<p>Процедуры вызываются отдельно командой <code>CALL</code>.</p>
</li>
<li>
<p>Процедура, в отличие от функции, может фиксировать или откатывать транзакции во время её выполнения (а затем автоматически начинать новую транзакцию), если вызывающая команда <code>CALL</code> находится не в явном блоке транзакции.</p>
</li>
<li>
<p>Некоторые атрибуты функций (например, <code>STRICT</code>) неприменимы к процедурам.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_создание_процедуры_create_procedure">Создание процедуры (<code>CREATE PROCEDURE</code>)</h6>
<div class="listingblock">
<div class="title">Cинтаксис создания процедуры</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE [ OR REPLACE ] PROCEDURE
    имя ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента [   { DEFAULT |
    = } выражение_по_умолчанию ] [, ...] ] )
 { LANGUAGE имя_языка
    | TRANSFORM { FOR TYPE имя_типа } [, ... ]
    | [ EXTERNAL ] SECURITY INVOKER | [ EXTERNAL ] SECURITY DEFINER
    | SET параметр_конфигурации { TO значение | = значение | FROM   CURRENT }
    | AS 'определение'
    | AS 'объектный_файл', 'объектный_символ'
 } ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Команда <code>CREATE PROCEDURE</code> определяет новую процедуру, в тоже время <code>CREATE OR REPLACE PROCEDURE</code> создаёт новую процедуру либо заменяет определение уже существующей.</p>
</div>
<div class="paragraph">
<p>Чтобы определить процедуру, необходимо иметь право <code>USAGE</code> для соответствующего языка. Если указано имя схемы, процедура создаётся в заданной схеме, в противном случае — в текущей. Имя новой процедуры должно отличаться от имён существующих процедур и функций с такими же типами аргументов в этой схеме. Однако процедуры и функции с аргументами разных типов могут иметь одно имя (это называется перегрузкой).</p>
</div>
<div class="paragraph">
<p>Команда <code>CREATE OR REPLACE PROCEDURE</code> предназначена для изменения текущего определения существующей процедуры. С её помощью нельзя изменить имя или типы аргументов (если попытаться сделать это, будет создана новая отдельная процедура). Когда команда <code>CREATE OR REPLACE PROCEDURE</code> заменяет существующую процедуру, владелец и права доступа к этой процедуре не меняются. Все другие свойства процедуры получают значения, задаваемые командой явно или по умолчанию. Чтобы заменить процедуру, необходимо быть её владельцем (или быть членом роли-владельца). Владельцем процедуры становится создавший её пользователь. Чтобы создать процедуру, необходимо иметь право <code>USAGE</code> для типов её аргументов.</p>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>имя</code> - имя создаваемой процедуры.</p>
</li>
<li>
<p><code>режим_аргумента</code> - режим аргумента: <code>IN</code>, <code>INOUT</code> или <code>VARIADIC</code>. По умолчанию подразумевается <code>IN</code>. (Режим <code>OUT</code> для процедур в настоящее время не поддерживается. Используйте вместо него <code>INOUT</code>).</p>
</li>
<li>
<p><code>имя_аргумента</code> - имя аргумента.</p>
</li>
<li>
<p><code>тип_аргумента</code> - тип данных аргумента процедуры (возможно, дополненный схемой), при наличии аргументов. Тип аргументов может быть базовым, составным или доменным, либо это может быть ссылка на столбец таблицы.</p>
</li>
<li>
<p><code>выражение_по_умолчанию</code> - выражение, используемое для вычисления значения по умолчанию, если параметр не задан явно. Результат выражения должен сводиться к типу соответствующего параметра. Для всех входных параметров, следующих за параметром с определённым значением по умолчанию, также должны быть определены значения по умолчанию.</p>
</li>
<li>
<p><code>имя_языка</code> - имя языка, на котором реализована функция.</p>
</li>
<li>
<p><code>TRANSFORM { FOR TYPE имя_типа } [, &#8230;&#8203; ] }</code> - устанавливает список трансформаций, которые должны применяться при вызове процедуры. Трансформации выполняют преобразования между типами <code>SQL</code> и типами данных, специфичными для языков. Преобразования встроенных типов обычно жёстко предопределены в реализациях процедурных языков, так что их здесь указывать не нужно. Если реализация процедурного языка не может обработать тип и трансформация для него отсутствует, будет выполнено преобразование типов по умолчанию, но это зависит от реализации.</p>
</li>
<li>
<p><code>[EXTERNAL] SECURITY INVOKER</code> / <code>[EXTERNAL] SECURITY DEFINER</code> - характеристика <code>SECURITY INVOKER</code> (безопасность вызывающего) показывает, что процедура будет выполняться с правами пользователя, вызвавшего её. Этот вариант подразумевается по умолчанию. Вариант <code>SECURITY DEFINER</code> (безопасность определившего) обозначает, что процедура выполняется с правами пользователя, владеющего ей. Ключевое слово <code>EXTERNAL</code> допускается для соответствия стандарту <code>SQL</code>, но является необязательным, так как, в отличие от <code>SQL</code>, эта характеристика распространяется на все процедуры, а не только внешние. В процедуре с характеристикой <code>SECURITY DEFINER</code> не могут выполняться операторы управления транзакциями (например, <code>COMMIT</code> и <code>ROLLBACK</code> в некоторых языках).</p>
</li>
<li>
<p><code>параметр_конфигурации</code> \ <code>значение</code> - предложение <code>SET</code> определяет, что при вызове процедуры указанный параметр конфигурации должен принять заданное значение, а затем восстановить своё предыдущее значение при завершении процедуры. Предложение <code>SET FROM CURRENT</code> сохраняет в качестве значения, которое будет применено при входе в процедуру, значение, действующее в момент выполнения <code>CREATE PROCEDURE</code>. Если в определение процедуры добавлено <code>SET</code>, то действие команды <code>SET LOCAL</code>, выполняемой внутри процедуры для того же параметра, ограничивается телом процедуры: предыдущее значение параметра так же будет восстановлено при завершении процедуры. Однако обычная команда <code>SET</code> (без <code>LOCAL</code>) переопределяет предложение <code>SET</code>, как и предыдущую команду <code>SET LOCAL</code>: действие такой команды будет сохранено и после завершения процедуры, если только не произойдёт откат транзакции. Если к определению процедуры добавлено <code>SET</code>, то в этой процедуре не могут выполняться операторы управления транзакциями (например, <code>COMMIT</code> и <code>ROLLBACK</code> в некоторых языках).</p>
</li>
<li>
<p><code>определение</code> - строковая константа, определяющая реализацию процедуры; её значение зависит от языка. Это может быть имя внутренней процедуры, путь к объектному файлу, команда <code>SQL</code> или код на процедурном языке. Часто бывает полезно заключать определение процедуры в доллары, а не в традиционные апострофы. Если не использовать доллары, все апострофы и обратные косые черты в определении процедуры придётся экранировать, дублируя их.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Пример</strong></p>
</div>
<div class="listingblock">
<div class="title">Пример создания процедуры</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE PROCEDURE insert_data(a integer, b varchar)
    LANGUAGE SQL
    AS $$
    insert into table_name VALUES (a,b);
    $$;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Процедура <code>insert_data</code> после вызова, занесет в таблицу значения <code>a</code> и <code>b</code>.</p>
</div>
<div class="paragraph">
<p>Чтобы вызвать процедуру воспользуйтесь командой <code>CALL</code>:</p>
</div>
<div class="listingblock">
<div class="title">Вызов процедуры</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CALL insert_data(1, 'data');</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_процедуры_drop_procedure">Удаление процедуры (<code>DROP PROCEDURE</code>)</h6>
<div class="paragraph">
<p>Чтобы удалить процедуры, необходимо воспользоваться командой <code>DROP PROCEDURE</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP PROCEDURE [ IF EXISTS ] имя [ ( [ [ режим_аргумента ] [ имя_аргумента
 ] тип_аргумента [, ...] ] ) ] [, ...]
 [ CASCADE | RESTRICT ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>DROP PROCEDURE</code> удаляет определение существующей процедуры. Пользователь, выполняющий эту команду, должен быть владельцем процедуры. Помимо имени процедуры требуется указать типы её аргументов, так как в базе данных могут существовать несколько процедур с одним именем, но с разными списками аргументов.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Параметры</strong>:</p>
</li>
<li>
<p><code>IF EXISTS</code> - не считать ошибкой, если процедура не существует. В этом случае будет выдано замечание.</p>
</li>
<li>
<p><code>имя</code> - имя существующей процедуры (возможно, дополненное схемой). Если список аргументов не указан, имя процедуры должно быть уникальным в её схеме.</p>
</li>
<li>
<p><code>режим_аргумента</code> - режим аргумента: <code>IN</code> или <code>VARIADIC</code>. По умолчанию подразумевается <code>IN</code>.</p>
</li>
<li>
<p><code>имя_аргумента</code> - имя аргумента.</p>
</li>
<li>
<p><code>тип_аргумента</code> - тип данных аргументов процедуры (возможно, дополненный именем схемы), если таковые имеются.</p>
</li>
<li>
<p><code>CASCADE</code> - автоматически удалять объекты, зависящие от данной процедуры, и, в свою очередь, все зависящие от них объекты.</p>
</li>
<li>
<p><code>RESTRICT</code> - отказать в удалении процедуры, если от неё зависят какие-либо объекты. Это поведение по умолчанию.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_процедуры_alter_procedure">Изменение процедуры (<code>ALTER PROCEDURE</code>)</h6>
<div class="paragraph">
<p><code>ALTER PROCEDURE</code> позволяет изменить определение процедуры. Выполнить <code>ALTER PROCEDURE</code> может только владелец процедуры. Чтобы сменить схему процедуры, необходимо также иметь право <code>CREATE</code> в новой схеме. Чтобы сменить владельца, требуется также быть непосредственным или опосредованным членом новой роли, а эта роль должна иметь право <code>CREATE</code> в схеме представления.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER PROCEDURE имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
действие [ ... ] [ RESTRICT ]

ALTER PROCEDURE имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
RENAME TO новое_имя

ALTER PROCEDURE имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
OWNER TO { новый_владелец | CURRENT_USER | SESSION_USER }

ALTER PROCEDURE имя [ ( [ [ режим_аргумента ] [ имя_аргумента ] тип_аргумента
[, ...] ] ) ]
SET SCHEMA новая_схема</code></pre>
</div>
</div>
<div class="paragraph">
<p>Где действие может быть следующим:</p>
</div>
<div class="listingblock">
<div class="title">Возможные действия</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SET параметр_конфигурации { TO | = } { значение | DEFAULT }

SET параметр_конфигурации FROM CURRENT

RESET параметр_конфигурации

RESET ALL</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>новое_имя</code> - новое имя процедуры.</p>
</li>
<li>
<p><code>новый_владелец</code> - новый владелец процедуры. Заметьте, что если процедура помечена как <code>SECURITY DEFINER</code>, в дальнейшем она будет выполняться от имени нового владельца.</p>
</li>
<li>
<p><code>новая_схема</code> - новая схема процедуры.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Переименование процедуры <code>procedure_name</code> с двумя аргументами типа <code>integer</code> в <code>new_procedure_name</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER PROCEDURE procedure_name(integer, integer) RENAME TO new_procedure_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Смена владельца процедуры <code>procedure_name</code> с двумя аргументами типа <code>integer</code> на <code>user_name</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER PROCEDURE procedure_name(integer, integer) OWNER TO user_name;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_триггеры">Триггеры</h5>
<div class="paragraph">
<p><strong>Триггер</strong> (<strong>trigger)</strong> - процедура, отличается от обычной тем, что она вызывается автоматически, при некотором событии в базе данных. Триггеры применяются для гарантированного выполнения определенных действий при возникновении событий. Триггеры носят глобальный характер и не зависят от причин и способов появления событий, на который они срабатывают.</p>
</div>
<div class="paragraph">
<p>Триггерные функции могут быть написаны на большинстве доступных процедурных языков,  включая <strong>PL/pgSQL</strong>, <strong>PL/Tcl</strong>, <strong>PL/Perl</strong> и <strong>PL/Python</strong>. В настоящее время невозможно написать  триггерную функцию на чистом <strong>SQL</strong>.</p>
</div>
<div class="paragraph">
<div class="title">Триггеры</div>
<p><span class="image"><img src="../assets/img/bd-object/postgresql-triggers.png" alt="postgresql triggers"></span></p>
</div>
<div class="paragraph">
<p>В <strong>PostgreSQL</strong> триггеры создаются на основе существующих функции, т.е. сначала командой <code>CREATE FUNCTION</code> определяется триггерная функция, затем на ее основе командой <code>CREATE TRIGGER</code> определяется собственно триггер.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис определения триггера</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TRIGGER триггер
    { BEFORE | AFTER } { событие [ OR событие ] } ON таблица
    FOR EACH { ROW |  STATEMENT }
    WHEN(условие)
    EXECUTE PROCEDURE функция ( аргументы );</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Параметры</strong>:</p>
</li>
<li>
<p><code>{ BEFORE | AFTER }</code> - ключевое слово <code>BEFORE</code> означает, что функция должна выполняться перед попыткой выполнения операции, включая все встроенные проверки ограничений данных, реализуемые при выполнении команд <code>INSERT</code> и <code>DELETE</code>. Ключевое слово <code>AFTER</code> означает, что функция вызывается после завершения операции, приводящей в действие триггер.</p>
</li>
<li>
<p><code>{ событие [ OR событие &#8230;&#8203; ] }</code> - события, поддерживаемые в <strong>PostgreSQL</strong>: <code>INSERT</code>, <code>UPDATE</code> или <code>DELETE</code>. При перечислении нескольких событий в качестве разделителя используется ключевое слово <code>OR</code>.</p>
</li>
<li>
<p><code>FOR EACH { ROW | STATEMENT }</code> - ключевое слово, следующее за конструкцией <code>FOR EACH</code> и определяющее количество вызовов функции при наступлении указанного события. Ключевое слово <code>ROW</code> означает, что функция вызывается для каждой модифицируемой записи. Если функция должна вызываться всего один раз для всей команды, используется ключевое слово <code>STATEMENT</code>.</p>
</li>
<li>
<p><code>WHEN</code> - необязательный параметр. В определении триггера можно указать логическое условие <code>WHEN</code>, которое определит, вызывать триггер или нет. В триггерах на уровне строк условия <code>WHEN</code> могут проверять старые и/или новые значения столбцов в строке. Триггеры на уровне оператора так же могут содержать условие <code>WHEN</code>, хотя для них это не столь полезно, так как в этом условии нельзя ссылаться на какие-либо значения в таблице.</p>
</li>
<li>
<p><code>EXECUTE PROCEDURE функция ( аргументы )</code>- имя вызываемой функции с аргументами. На практике аргументы при вызове триггерных функций не используются.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Синтаксис определения триггерной функции</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE FUNCTION функция () RETURNS trigger AS '
    BEGIN
    команды;
    return NEW | OLD;
    END;'
LANGUAGE  plpgsql;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cпециальные переменные, доступные в триггерных функциях:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NEW</code> - Новые значения полей записи базы данных, созданной командой <code>INSERT</code> или обновленной командой <code>UPDATE</code>, при срабатывании триггера уровня записи <code>ROW</code>. В триггерах уровня оператора и для команды <code>DELETE</code> эта переменная имеет значение <code>null</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Внимание !!!</strong> Переменная <code>NEW</code> доступна только при операциях <code>INSERT</code> и <code>UPDATE</code>. Поля записи <code>NEW</code> могут быть изменены триггером. В триггерах уровня оператора и для команды <code>INSERT</code> эта  переменная имеет значение <code>null</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OLD</code> - Старые значения полей записи базы данных, содержавшиеся в записи перед выполнением команды <code>DELETE</code> или <code>UPDATE</code> при срабатывании триггера уровня записи <code>ROW</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Внимание !!!</strong> Переменная <code>OLD</code> доступна только при операциях <code>DELETE</code> и <code>UPDATE</code>. Поля записи <code>OLD</code> можно использовать только для чтения, изменять нельзя.</p>
</div>
<div class="paragraph">
<p>К отдельным полям записей <code>NEW</code> и <code>OLD</code> в триггерных процедурах обращаются следующим образом: <code>NEW.names</code>, <code>OLD.rg</code>.</p>
</div>
<div class="paragraph">
<p><strong>Указания по возврату из тригеров:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Триггерная функция должна возвращать <code>NULL</code> или запись, соответствующую структуре таблицы, на которую будет вешаться триггер!</p>
</li>
<li>
<p>Если <code>BEFORE</code>-триггер возвращает <code>NULL</code>, то сама операция и <code>AFTER</code>-триггер будут отменены.</p>
</li>
<li>
<p><code>BEFORE</code>-триггер может изменить строку (<code>INSERT</code> \ <code>UPDATE</code>) через <code>NEW</code> и тогда операция и <code>AFTER</code>-триггеры` будут работать с заменённой строкой.</p>
</li>
<li>
<p>Если <code>BEFORE</code>-триггер` не "хочет" изменять строку, то надо просто вернуть <code>OLD</code>.</p>
</li>
<li>
<p><code>NEW</code> = <code>null</code> при <code>DELETE</code>, так что если <code>BEFORE</code>-триггер хочет дать ход <code>DELETE</code>, надо вернуть <code>OLD</code>.</p>
</li>
<li>
<p>Возвращаемое значение из построчного <code>AFTER</code>-триггера (или из <code>BEFORE</code> и из <code>AFTER</code>-триггеров на утверждения) игнорируется &#8658; можно возвращать <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Пример</strong>:</p>
</div>
<div class="listingblock">
<div class="title">Создаем триггер</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TRIGGER tr
    AFTER
    INSERT ON table_name
    FOR EACH ROW
    EXECUTE PROCEDURE func();</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Создаем функцию</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE OR REPLACE FUNCTION func() RETURNS trigger AS '
    BEGIN
    delete from table_name where age = 1;
    return NEW;
    END;'
LANGUAGE plpgsql;</code></pre>
</div>
</div>
<div class="paragraph">
<p>После внесения данных в таблицу <code>table_name</code> вызывается функция <code>func()</code>, которая удалит из таблицы значения <code>age = 1</code>;</p>
</div>
<div class="paragraph">
<p>Если есть несколько триггеров на одно и то же событие для одной и той же таблицы, то они  будут вызываться в алфавитном порядке по имени триггера.</p>
</div>
<div class="sect5">
<h6 id="_удаление_триггера_drop_trigger">Удаление триггера (<code>DROP TRIGGER</code>)</h6>
<div class="paragraph">
<p><code>DROP TRIGGER</code> удаляет существующее определение триггера. Пользователь, выполняющий эту команду, должен быть владельцем таблицы, для которой определён данный триггер.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP TRIGGER [ IF EXISTS ] имя ON имя_таблицы [ CASCADE | RESTRICT ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>IF EXISTS</code> - не считать ошибкой, если триггер не существует. В этом случае будет выдано замечание.</p>
</li>
<li>
<p><code>имя</code> - имя триггера, подлежащего удалению.</p>
</li>
<li>
<p><code>имя_таблицы</code> - имя (возможно, дополненное схемой) таблицы, для которой определён триггер.</p>
</li>
<li>
<p><code>CASCADE</code> - автоматически удалять объекты, зависящие от данного триггера, и, в свою очередь, все зависящие от них объекты .</p>
</li>
<li>
<p><code>RESTRICT</code> - Отказать в удалении триггера, если от него зависят какие-либо объекты. Это поведение по умолчанию.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_определения_триггера_alter_trigger">Изменение определения триггера (<code>ALTER TRIGGER</code>)</h6>
<div class="paragraph">
<p>Изменять свойства триггера может только владелец таблицы, с которой работает триггер следующим запросом:</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TRIGGER имя ON имя_таблицы RENAME TO новое_имя

ALTER TRIGGER имя ON имя_таблицы [ NO ] DEPENDS ON EXTENSION имя_расширения</code></pre>
</div>
</div>
<div class="paragraph">
<p>Предложение <code>RENAME</code> переименовывает данный триггер, не затрагивая его определение. Предложение <code>DEPENDS ON EXTENSION</code> помечает триггер как зависимый от расширения, так что при удалении расширения будет автоматически удаляться и триггер.</p>
</div>
<div class="paragraph">
<p><strong>Параметры</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Имя</code> - имя существующего триггера, подлежащего изменению.</p>
</li>
<li>
<p><code>Имя_таблицы</code> - имя таблицы, с которой работает триггер.</p>
</li>
<li>
<p><code>Новое_имя</code> - новое имя триггера.</p>
</li>
<li>
<p><code>Имя_расширения</code> - имя расширения, от которого будет зависеть триггер (или не будет, если указано <code>NO</code>).
Триггер, помеченный как зависимый от расширения, автоматически удаляется при удалении расширения.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_последовательности_sequence">Последовательности (<code>Sequence</code>)</h5>
<div class="paragraph">
<p>Последовательности используются для управления столбцами с автоинкрементом, которые определены в таблице, как <code>SERIAL</code>.</p>
</div>
<div class="paragraph">
<div class="title">Последовательности (<code>Sequence</code>)</div>
<p><span class="image"><img src="../assets/img/bd-object/postgresql-sequence.png" alt="postgresql sequence"></span>]</p>
</div>
<div class="sect5">
<h6 id="_создание_последовательности_create_sequence">Создание последовательности (<code>CREATE SEQUENCE</code>)</h6>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE [ TEMPORARY | TEMP ] SEQUENCE [ IF NOT EXISTS ] имя
    [ AS тип_данных ]
    [ INCREMENT [ BY ] шаг ]
    [ MINVALUE мин_значение | NO MINVALUE ] [ MAXVALUE макс_значение | NO MAXVALUE ]
    [ START [ WITH ] начало ] [ CACHE кеш ] [ [ NO ] CYCLE ]
    [ OWNED BY { имя_таблицы.имя_столбца | NONE } ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Такой запрос создаёт генератор последовательности. Эта операция включает создание и инициализацию специальной таблицы имя, содержащей одну строку. Владельцем генератора будет пользователь, выполняющий эту команду. Если указано имя схемы, последовательность создаётся в заданной схеме, в противном случае — в текущей. Временные последовательности существуют в специальной схеме, так что при создании таких последовательностей имя схемы задать нельзя. Имя последовательности должно отличаться от имён других последовательностей, таблиц, индексов, представлений или сторонних таблиц, уже существующих в этой схеме.</p>
</div>
<div class="paragraph">
<p>Хотя непосредственно изменить значение последовательности нельзя, получить её параметры и текущее состояние можно таким запросом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * FROM name;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TEMPORARY</code> или <code>TEMP</code> - если указано, объект последовательности создаётся только для данного сеанса и автоматически удаляется при завершении сеанса. Существующая постоянная последовательность с тем же именем не будут видна (в этом сеансе), пока существует временная, однако к ней можно обратиться, дополнив имя указанием схемы.</p>
</li>
<li>
<p><code>IF NOT EXISTS</code> - не считать ошибкой, если отношение с таким именем уже существует. В этом случае будет выдано замечание. Заметьте, что нет никакой гарантии, что существующее отношение как-то соотносится с последовательностью, которая могла бы быть создана — это может быть даже не последовательность.</p>
</li>
<li>
<p><code>тип_данных</code> - необязательное предложение <code>AS</code> тип_данных задаёт тип данных для последовательности. Допустимые типы: <em>smallint</em>, <em>integer</em> и <em>bigint</em>. По умолчанию устанавливается тип <em>bigint</em>. От типа данных зависят принимаемые по умолчанию минимальное и максимальное значения последовательности.</p>
</li>
<li>
<p><code>шаг</code> - необязательное предложение <code>INCREMENT BY</code> шаг определяет, какое число будет добавляться к текущему значению последовательности для получения нового значения. С положительным шагом последовательность будет возрастающей, а с отрицательным — убывающей. Значение по умолчанию: <code>1</code>.</p>
</li>
<li>
<p><code>мин_значение</code> - Необязательное предложение <code>MINVALUE</code> определяет наименьшее число, которое будет генерировать последовательность. Если это предложение опущено либо указано <code>NO MINVALUE</code>, используется значение по умолчанию: <code>1</code> для возвращающей последовательности или минимальное значение типа данных — для убывающей.</p>
</li>
<li>
<p><code>макс_значения</code> - Необязательное предложение <code>MAXVALUE</code> определяет наибольшее число, которое будет генерировать последовательность. Если это предложение опущено либо указано <code>NO MAXVALUE</code>, используется значение по умолчанию: максимальное значение типа данных для возрастающей последовательности или <code>-1</code> — для убывающей</p>
</li>
<li>
<p><code>начало</code> - необязательное предложение <code>START WITH</code> начало позволяет запустить последовательность с любого значения. По умолчанию началом считается мин_значение для возрастающих последовательностей и максимальное значение для убывающих.</p>
</li>
<li>
<p><code>кеш</code> - необязательное предложение <code>CACHE</code> кеш определяет, сколько чисел последовательности будет выделяться и сохраняться в памяти для ускорения доступа к ним. Минимальное значение равно 1 (за один раз генерируется только одно значение, т. е. кеширования нет), и оно же предполагается по умолчанию.</p>
</li>
<li>
<p><code>CYCLE / NO CYCLE</code> - параметр <code>CYCLE</code> позволяет зациклить последовательность при достижении макс_значения или мин_значения для возрастающей или убывающей последовательности, соответственно. Когда этот предел достигается, следующим числом этих последовательностей будет соответственно мин_значение или макс_значение. Если указывается <code>NO CYCLE</code>, при каждом вызове <code>nextval</code> после достижения предельного значения будет возникать о</p>
</li>
<li>
<p><code>OWNED BY имя_таблицы.имя_столбца / OWNED BY NONE</code> - предложение <code>OWNED BY</code> позволяет связать последовательность с определённым столбцом таблицы так, чтобы при удалении этого столбца (или всей таблицы) последовательность удалялась автоматически.Указанная таблица должна иметь того же владельца и находиться в той же схеме, что и последовательность. Подразумеваемое по умолчанию предложение <code>OWNED BY NONE</code> указывает, что такая связь не устанавливается.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Примеры</strong>:</p>
</div>
<div class="paragraph">
<p>Создание возрастающей последовательности с именем <code>serial</code>, с начальным значением <code>101</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE SEQUENCE serial START 101;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Использование этой последовательности в команде <code>INSERT</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">INSERT INTO table_name VALUES (nextval('serial'), 'nothing');</code></pre>
</div>
</div>
<div class="paragraph">
<p>Добавив через такой запрос в таблицу значения, последовательность увеличится на единицу и <code>nextval('serial') = 102</code>;</p>
</div>
<div class="paragraph">
<p>Чтобы узнать следующий номер этой последовательности выполните запрос:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">SELECT * FROM serial;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_последовательности_drop_sequence">Удаление последовательности (<code>DROP SEQUENCE</code>)</h6>
<div class="paragraph">
<p>Удалить последовательность может только её владелец или суперпользователь, для этого воспользуйтесь запросом:</p>
</div>
<div class="listingblock">
<div class="title">Для удаления последовательности</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP SEQUENCE [ IF EXISTS ] имя [, ...] [ CASCADE | RESTRICT ]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>IF EXISTS</code> - не считать ошибкой, если последовательность не существует. В этом случае будет выдано замечание.</p>
</li>
<li>
<p><code>имя</code> - имя последовательности (возможно, дополненное схемой).</p>
</li>
<li>
<p><code>CASCADE</code> - автоматически удалять объекты, зависящие от данной последовательности, и, в свою очередь, все зависящие от них объекты.</p>
</li>
<li>
<p><code>RESTRICT</code> - отказать в удалении последовательности, если от неё зависят какие-либо объекты. Это поведение по умолчанию</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_определение_генератора_последовательности_alter_sequence">Изменение определение генератора последовательности (<code>ALTER SEQUENCE</code>)</h6>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER SEQUENCE [ IF EXISTS ] имя
    [ AS тип_данных ]
    [ INCREMENT [ BY ] шаг ]
    [ MINVALUE мин_значение | NO MINVALUE ] [ MAXVALUE макс_значение | NO MAXVALUE ]
    [ START [ WITH ] начало ]
    [ RESTART [ [ WITH ] перезапуск ] ]
    [ CACHE кеш ] [ [ NO ] CYCLE ]
    [ OWNED BY { имя_таблицы.имя_столбца | NONE } ]

    ALTER SEQUENCE [ IF EXISTS ] имя OWNER TO { новый_владелец | CURRENT_USER |
    SESSION_USER }

    ALTER SEQUENCE [ IF EXISTS ] имя RENAME TO новое_имя

    ALTER SEQUENCE [ IF EXISTS ] имя SET SCHEMA новая_схема</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ALTER SEQUENCE</code> меняет параметры существующего генератора последовательности. Параметры, не определяемые явно в команде <code>ALTER SEQUENCE</code>, сохраняют свои предыдущие значения. Выполнить <code>ALTER SEQUENCE</code> может только владелец соответствующей последовательности. Чтобы сменить схему последовательности, необходимо также иметь право <code>CREATE</code> в новой схеме. Чтобы сменить владельца, необходимо быть непосредственным или опосредованным членом новой роли-владельца, а эта роль должна иметь право <code>CREATE</code> в схеме последовательности.</p>
</div>
<div class="paragraph">
<p>Дополнительные параметры, отсутствующие в запросе создания <code>sequence</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>новый_владелец</code> - имя пользователя, назначаемого новым владельцем последовательности.</p>
</li>
<li>
<p><code>новое_имя</code> - новое имя последовательности.</p>
</li>
<li>
<p><code>новая_схема</code> - новая схема последовательности.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ограничения_constraints">3.7.2. Ограничения (<code>Constraints</code>)</h4>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/bd-object/postgresql-constraints.png" alt="postgresql constraints"></span></p>
</div>
<div class="paragraph">
<p>С помощью ключевого слова <code>CONSTRAINT</code> можно задать имя для ограничений. В качестве ограничений могут использоваться <code>PRIMARY KEY</code>, <code>UNIQUE</code>, <code>CHECK</code>.</p>
</div>
<div class="sect4">
<h5 id="_ограничения_проверки">Ограничения-проверки</h5>
<div class="paragraph">
<p><strong>Ограничение-проверка</strong> — наиболее общий тип ограничений. В его определении можно указать, что значение данного столбца должно удовлетворять логическому выражению (проверке истинности). Например, цену товара можно ограничить положительными значениями так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer,
    name text,
    price numeric CHECK (price &gt; 0)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ограничение определяется после типа данных, как и значение по умолчанию. Значения по умолчанию и ограничения могут указываться в любом порядке. Ограничение-проверка состоит из ключевого слова <code>CHECK</code>, за которым идёт выражение в скобках. Это выражение должно включать столбец, для которого задаётся ограничение, иначе оно не имеет большого смысла.</p>
</div>
<div class="paragraph">
<p>Можно также присвоить ограничению отдельное имя. Это улучшит сообщения об ошибках и позволит ссылаться на это ограничение, когда понадобится изменить его. Имена ограничений можно задать на уровне столбцов. Они указываются после <code>CONSTRAINT</code> перед атрибутами:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer,
    name text,
    price numeric CONSTRAINT positive_price CHECK (price &gt; 0)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>То есть, чтобы создать именованное ограничение, напишите ключевое слово <code>CONSTRAINT</code>, а за ним идентификатор и собственно определение ограничения.</p>
</div>
<div class="paragraph">
<p>Ограничение-проверка может также ссылаться на несколько столбцов. Например, если необходимо хранить обычную цену и цену со скидкой, так можете гарантировать, что цена со скидкой будет всегда меньше обычной.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE table_name (
    product_no integer,
    name text,
    price numeric CHECK (price &gt; 0),
    discounted_price numeric CHECK (discounted_price &gt; 0),
    CHECK (price &gt; discounted_price)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот пример можно переписать иначе:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE table_name (
    product_no integer,
    name text,
    price numeric,
    CHECK (price &gt; 0),
    discounted_price numeric,
    CHECK (discounted_price &gt; 0),
    CHECK (price &gt; discounted_price)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>или так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE table_name (
    product_no integer,
    name text,
    price numeric CHECK (price &gt; 0),
    discounted_price numeric,
    CHECK (discounted_price &gt; 0 AND price &gt; discounted_price)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ограничениям таблицы можно присваивать имена так же, как и ограничениям столбцов:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE table_name (
    product_no integer,
    name text,
    price numeric,
    CHECK (price &gt; 0),
    discounted_price numeric,
    CHECK (discounted_price &gt; 0),
    CONSTRAINT valid_discount CHECK (price &gt; discounted_price)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Следует заметить, что ограничение-проверка удовлетворяется, если выражение принимает значение <code>true</code> или <code>NULL</code>. Так как результатом многих выражений с операндами <code>NULL</code> будет значение <code>NULL</code>, такие ограничения не будут препятствовать записи <code>NULL</code> в связанные столбцы. Чтобы гарантировать, что столбец не содержит значения <code>NULL</code>, можно использовать ограничение <code>NOT NULL</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ограничение_not_null_2">Ограничение <code>NOT NULL</code></h5>
<div class="paragraph">
<p>Ограничение <code>NOT NULL</code> просто указывает, что столбцу нельзя присваивать значение <code>NULL</code>.</p>
</div>
<div class="listingblock">
<div class="title">Синтаксис</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer NOT NULL,
    name text NOT NULL,
    price numeric
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ограничение <code>NOT NULL</code> всегда записывается как ограничение столбца и функционально эквивалентно ограничению <code>CHECK (имя_столбца IS NOT NULL)</code>, но в <strong>Postgres Pro</strong> явное ограничение <code>NOT NULL</code> работает более эффективно. Хотя у такой записи есть недостаток — назначить имя таким ограничениям нельзя.</p>
</div>
<div class="paragraph">
<p>Для столбца можно определить больше одного ограничения. Для этого их нужно просто указать одно за другим:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer NOT NULL,
    name text NOT NULL,
    price numeric NOT NULL CHECK (price &gt; 0)
);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ограничения_уникальности">Ограничения уникальности</h5>
<div class="paragraph">
<p>Ограничения уникальности гарантируют, что данные в определённом столбце или группе столбцов уникальны среди всех строк таблицы. Ограничение записывается так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer UNIQUE,
    name text,
    price numeric
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>или:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer,
    name text,
    price numeric,
    UNIQUE (product_no)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы определить ограничение уникальности для группы столбцов, запишите его в виде ограничения таблицы, перечислив имена столбцов через запятую:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE example (
    a integer,
    b integer,
    c integer,
    UNIQUE (a, c)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Такое ограничение указывает, что сочетание значений перечисленных столбцов должно быть уникально во всей таблице, тогда как значения каждого столбца по отдельности не должны быть (и обычно не будут) уникальными.</p>
</div>
<div class="paragraph">
<p>Можно назначить уникальному ограничению имя обычным образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer CONSTRAINT must_be_different UNIQUE,
    name text,
    price numeric
);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_первичный_ключ_primary_key">Первичный ключ (<code>PRIMARY KEY</code>)</h5>
<div class="paragraph">
<p>Ограничение первичного ключа означает, что образующий его столбец или группа столбцов может быть уникальным идентификатором строк в таблице. Для этого требуется, чтобы значения были одновременно уникальными и отличными от <code>NULL</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer PRIMARY KEY,
    name text,
    price numeric
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Первичные ключи могут включать несколько столбцов; синтаксис похож на запись ограничений уникальности:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE example (
    a integer,
    b integer,
    c integer,
    PRIMARY KEY (a, c)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>При добавлении первичного ключа автоматически создаётся уникальный индекс-B-дерево для столбца или группы столбцов, перечисленных в первичном ключе, и данные столбцы помечаются как <code>NOT NULL</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ограничение_внешнего_ключа_references">Ограничение внешнего ключа (<code>REFERENCES</code>)</h5>
<div class="paragraph">
<p>Ограничение внешнего ключа указывает, что значения столбца (или группы столбцов) должны соответствовать значениям в некоторой строке другой таблицы. Это называется ссылочной целостностью двух связанных таблиц.</p>
</div>
<div class="paragraph">
<p>Пусть у вас уже есть таблица продуктов:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE products (
    product_no integer PRIMARY KEY,
    name text,
    price numeric
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Предположим, что есть таблица с заказами этих продуктов. Чтобы в таблице заказов содержались только заказы действительно существующих продуктов, определим в ней ограничение внешнего ключа, ссылающееся на таблицу продуктов:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE orders (
    order_id integer PRIMARY KEY,
    product_no integer REFERENCES products (product_no),
    quantity integer
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>С таким ограничением создать заказ отсутствующим в таблице <code>products</code> (и не равным <code>NULL</code>), будет невозможно.</p>
</div>
<div class="paragraph">
<p>В такой схеме таблицу <code>orders</code> называют подчинённой таблицей, а <code>products</code> — главной. Соответственно, столбцы называют так же <code>подчинённым</code> и <code>главным</code> (или ссылающимся и целевым).</p>
</div>
<div class="paragraph">
<p>Предыдущую команду можно сократить так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE orders (
    order_id integer PRIMARY KEY,
    product_no integer REFERENCES products,
    quantity integer
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если опустить список столбцов, внешний ключ будет неявно связан с первичным ключом главной таблицы.</p>
</div>
<div class="paragraph">
<p>Внешний ключ также может ссылаться на группу столбцов. В этом случае его нужно записать в виде обычного ограничения таблицы.</p>
</div>
<div class="paragraph">
<p><strong>Например</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE TABLE t1 (
  a integer PRIMARY KEY,
  b integer,
  c integer,
  FOREIGN KEY (b, c) REFERENCES other_table (c1, c2)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Естественно, число и типы столбцов в ограничении должны соответствовать числу и типам целевых столбцов.</p>
</div>
<div class="sect5">
<h6 id="_добавление_ограничения_alter_table">Добавление ограничения (<code>ALTER TABLE</code>)</h6>
<div class="paragraph">
<p>Для добавления ограничения используется синтаксис ограничения таблицы. <strong>Например:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE products ADD CHECK (name &lt;&gt; '');

ALTER TABLE products ADD CONSTRAINT some_name UNIQUE (product_no);

ALTER TABLE products ADD FOREIGN KEY (product_group_id)
REFERENCES product_groups;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы добавить ограничение <code>NOT NULL</code>, которое нельзя записать в виде ограничения таблицы,  используется такой синтаксис:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE products ALTER COLUMN product_no SET NOT NULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ограничение проходит проверку автоматически и будет добавлено, только если ему  удовлетворяют данные таблицы.</p>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_ограничения_drop_constraint">Удаление ограничения (<code>DROP CONSTRAINT</code>)</h6>
<div class="paragraph">
<p>Для удаления ограничения необходимо знать его имя. Если ранее ограничению не присваивали имя, это  неявно сделала система, и необходимо выяснить его. Здесь может быть полезна команда <code>psql \d имя_таблицы</code> (или другие программы, показывающие подробную информацию о таблицах). Зная
имя, можно использовать команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE products DROP CONSTRAINT some_name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Как и при удалении столбца необходимо удалить ограничение с зависимыми объектами,  добавьте указание <code>CASCADE</code>. Примером такой зависимости может быть ограничение внешнего  ключа, связанное со столбцами ограничения первичного ключа. Так можно удалить ограничения любых типов, кроме <code>NOT NULL</code>.</p>
</div>
<div class="paragraph">
<p>Чтобы удалить ограничение <code>NOT NULL</code>, используйте команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER TABLE products ALTER COLUMN product_no DROP NOT NULL;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_права_доступа">3.7.3. Права доступа</h4>
<div class="paragraph">
<p>Когда в базе данных создаётся объект, ему назначается владелец. Владельцем обычно становится роль, с которой был выполнен оператор создания. Для большинства типов объектов в исходном состоянии только владелец (или суперпользователь) может делать с объектом всё что угодно. Чтобы разрешить использовать его другим ролям, нужно дать им права.</p>
</div>
<div class="sect4">
<h5 id="_добавление_нового_пользователя">Добавление нового пользователя</h5>
<div class="paragraph">
<p>Если в базе данных не существует пользователя, его можно создать следующим образом:</p>
</div>
<div class="listingblock">
<div class="title">Создание пользователя</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">CREATE USER user-name WITH PASSWORD 'password';</code></pre>
</div>
</div>
<div class="paragraph">
<p>где в таблице</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>user-name</code> - логин пользователя базы данных.</p>
</li>
<li>
<p><code>password</code> - пароль нового пользователя.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>На этом этапе новый пользователь не имеет никаких разрешений на работу с базами данных. Он не может войти в систему, поэтому нужно предоставить ему неограниченные права доступа, выполнить это можно через следующий запрос.</p>
</div>
<div class="sect5">
<h6 id="_присвоение_прав_доступа_grant">Присвоение прав доступа (<code>GRANT</code>)</h6>
<div class="listingblock">
<div class="title">Предоставление пользователю неограниченные права доступа</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">GRANT ALL PRIVILEGES ON table_name TO user-name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь пользователь получил новые права и может работать с базой данных.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_настройка_прав_доступа_для_пользователей">Настройка прав доступа для пользователей</h5>
<div class="paragraph">
<p>Предоставить другой уровень доступа к базам данных для пользователя возможно через следующую команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">GRANT [тип прав] ON [имя базы данных].[имя таблицы] TO user-name [ WITH GRANT OPTION ];</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если указано <code>WITH GRANT OPTION</code>, получатель права, в свою очередь, может давать его другим. Без  этого указания распоряжаться своим правом он не сможет. Группе <code>PUBLIC</code> право передачи права  дать нельзя.</p>
</div>
<div class="paragraph">
<p>В <strong>PostgreSQL</strong> права доступа бывают несколько типов:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ALL PRIVILEGES</code> – даёт пользователю полный доступ к заданной базе данных (если база данных не указана, то ко всем);</p>
</li>
<li>
<p><code>CREATE</code> – позволяет пользователю создавать базы данных/таблицы;</p>
</li>
<li>
<p><code>SELECT</code> – позволяет пользователю делать выборку данных;</p>
</li>
<li>
<p><code>INSERT</code> – позволяет пользователю добавлять новые записи в таблицы;</p>
</li>
<li>
<p><code>UPDATE</code> – позволяет пользователю изменять существующие записи в таблицах;</p>
</li>
<li>
<p><code>DELETE</code> – позволяет пользователю удалять записи из таблиц;</p>
</li>
<li>
<p><code>DROP</code> – позволяет пользователю удалять записи в базе данных/таблицах;</p>
</li>
<li>
<p><code>TRIGGER</code> - создание триггеров;</p>
</li>
<li>
<p><code>TRUNCATE</code> - очистка таблицы;</p>
</li>
<li>
<p><code>USAGE</code> - право на использование последовательностей и использовать объекты в конкретной схеме;</p>
</li>
<li>
<p><code>REFERENCES</code> - право ссылаться на таблицу;</p>
</li>
<li>
<p><code>CONNECT</code> - право на подключение к базе данных</p>
</li>
<li>
<p><code>TEMPORARY</code> - разрешает создавать в базе данных временные таблицы;</p>
</li>
<li>
<p><code>EXECUTE</code> - право на использование функции.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Право удалять объект или изменять его определение произвольным образом не считается назначаемым, оно неотъемлемо связано с владельцем, так что отозвать это право или дать его кому-то другому нельзя.</strong></p>
</div>
<div class="paragraph">
<p>Если необходимо назначить несколько видов прав доступа, можно разделить их запятыми, как в команде:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">GRANT UPDATE, DELETE ON table_name TO user-name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если необходимо забрать у пользователя права доступа:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">REVOKE [тип прав] ON [имя базы данных].[имя таблицы] FROM user-name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если необходимо отменить все привилегии у пользователя, введите команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">REVOKE ALL PRIVILEGES ON table_name FROM user-name;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_удаление_пользователей">Удаление пользователей</h6>
<div class="paragraph">
<p>Если на роль есть ссылки в какой-либо базе данных в кластере, возникнет ошибка и роль не будет удалена. Прежде чем удалять роль, необходимо удалить все принадлежащие ей объекты, а также лишить её данных ей прав для других объектов.</p>
</div>
<div class="paragraph">
<p>Удалить пользователя можно следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP ROLE user-name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>или</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">DROP USER user-name;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>DROP USER</code> — просто альтернативное написание команды <code>DROP ROLE</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_изменение_роли_в_базе_alter_role">Изменение роли в базе (<code>ALTER ROLE</code>)</h6>
<div class="paragraph">
<p>Изменение пароля пользователя:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER ROLE user_name WITH PASSWORD 'hu8jmn3';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Удаление пароля пользователя:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER ROLE user_name WITH PASSWORD NULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Переименовать пользователя:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">ALTER ROLE user1 RENAME TO user2;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_виды_ролей">Виды ролей</h5>
<div class="sect5">
<h6 id="_суперпользователи">Суперпользователи</h6>
<div class="paragraph">
<p><strong>Суперпользователи</strong> –  имеют полный доступ ко всем объектам (проверки не выполняются).</p>
</div>
</div>
<div class="sect5">
<h6 id="_владельцы">Владельцы</h6>
<div class="paragraph">
<p><strong>Владельцы</strong> – владельцем становиться тот, кто создал объект. Но право владения можно передать. Владелец имеет все привилегии на принадлежащий ему объект. Также создатель объекта обладает правом удалять его, и это право у него нельзя отнять.</p>
</div>
</div>
<div class="sect5">
<h6 id="_псевдо_роль_public">Псевдо роль public</h6>
<div class="paragraph">
<p>Псевдороль <code>public</code> не видна, но про неё следует знать. Это групповая роль, в которую включены все остальные  роли. Это означает, что все роли по умолчанию будут иметь привилегии наследуемые от <code>public</code>. Поэтому иногда у <code>public</code> отбирают некоторые привилегии, чтобы отнять их у всех пользователей.</p>
</div>
<div class="paragraph">
<p>Роль <code>public</code> по умолчанию имеет следующие привилегии для всех баз данных:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONNECT</code> – это означает что любая созданная роль сможет подключаться к базам данных;</p>
</li>
<li>
<p><code>TEMPORARY</code> – любая созданная роль сможет создавать временные объекты во всех база данных и объекты эти могут быть любого размера;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>для схемы <code>public</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CREATE</code> (создание объектов) – любая роль может создавать объекты в этой схеме;</p>
</li>
<li>
<p><code>USAGE</code> (доступ к объектам) – любая роль может использовать объекты в этой схеме;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>для всех функций:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EXECUTE</code> (выполнение) – любая роль может выполнять любую функцию. Ещё нужны ещё права <code>USAGE</code> на ту схему, в которой функция находится, и права к объектам к которым обращается функция. Это сделано для удобства, но снижает безопасность сервера баз данных.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_2">4. Java</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_github_keys">4.1. GitHub keys</h3>
<div class="sect3">
<h4 id="_ssh_key">4.1.1. SSH key</h4>
<div class="paragraph">
<p>С помощью протокола <strong>SSH</strong> можно подключаться и проходить проверку подлинности на удаленных серверах и службах. С помощью ключей <strong>SSH</strong> вы можете подключаться к <strong>GitHub</strong> без предоставления своего имени пользователя и личного маркера доступа при каждом посещении.</p>
</div>
<div class="paragraph">
<p>Для того чтобы использовать подключение с помощью протокола <strong>SSH</strong> необходимо сгенерировать <strong>SSH-KEY</strong>. В данном примере генерация происходит через <strong>GIT GUI</strong>.</p>
</div>
<div class="paragraph">
<p>Для генерации заходим <em>Git GUI Here</em>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-generate1.png" alt="ssh generate1"></span></p>
</div>
<div class="paragraph">
<p>В появившемся окне выбираем вкладку <em>Help</em> - <em>Show SSH Key</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-generate2.png" alt="ssh generate2"></span></p>
</div>
<div class="paragraph">
<p>Если, ключ не обнаружен, то производим генерацию ключа <em>Generate Key</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-generate3.png" alt="ssh generate3"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-generate4.png" alt="ssh generate4"></span></p>
</div>
<div class="paragraph">
<p>После того как ключ был сгенерирован или уже имелся, его нужно скопировать для установки в профиле. Для этого в настройки вашего профиля (<em>setting</em>).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-install-git1.png" alt="ssh install git1"></span></p>
</div>
<div class="paragraph">
<p>Далее ищем вкладку <em>SSH and GPG keys</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-install-git2.png" alt="ssh install git2"></span></p>
</div>
<div class="paragraph">
<p>Нажимаем <em>New SSH key</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-install-git3.png" alt="ssh install git3"></span></p>
</div>
<div class="paragraph">
<p>Вставляем имеющийся ключ и добавляем <em>Add SSH key</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/ssh-install-git4.png" alt="ssh install git4"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_gpg_key">4.1.2. GPG key</h4>
<div class="paragraph">
<p>С помощью <strong>GPG</strong> или <strong>S/MIME</strong> можно подписывать теги и коммиты. Эти теги или коммиты помечаются как проверенные на <strong>GitHub</strong>, чтобы другие люди могли быть уверены, что изменения происходят из надежного источника.</p>
</div>
<div class="paragraph">
<p>Сначала необходимо скачать и становить <a href="https://www.gnupg.org/download/"><strong>Gpg4win</strong></a></p>
</div>
<div class="paragraph">
<p>Затем заходим в Git Bush и вводим команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">gpg --full-generate-key</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-generate1.png" alt="gpg generate1"></span></p>
</div>
<div class="paragraph">
<p>Затем выбирая нужные настройки нажимаем <em>Enter</em> до тех пор, пока не попросит подтвердить корректность данных и если все верно подтверждаем набрав <code>Y</code></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-generate2.png" alt="gpg generate2"></span></p>
</div>
<div class="paragraph">
<p>Далее вводим свои данные: имя, email.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-generate3.png" alt="gpg generate3"></span></p>
</div>
<div class="paragraph">
<p>Если все верно - подтверждаем введенные данные набрав`О`.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-generate4.png" alt="gpg generate4"></span></p>
</div>
<div class="paragraph">
<p>Вводим пароль(секретное поле) и затем его подтверждаем</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-generate5.png" alt="gpg generate5"></span></p>
</div>
<div class="paragraph">
<p>После этого наши GPG ключи сгенерированы.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-generate6.png" alt="gpg generate6"></span></p>
</div>
<div class="paragraph">
<p>Чтобы посмотреть открытый и закрытый ключи необходимо ввести следующую команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">gpg --list-secret-keys --keyid-format=long
/Users/hubot/.gnupg/secring.gpg
------------------------------------
sec   4096R/3AA5C34371567BD2 2016-03-10 [expires: 2017-03-10]
uid                          Hubot
ssb   4096R/42B317FD4BA89E7A 2016-03-10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Далее введя команду <strong>gpg --armor --export &#8230;&#8203;</strong>, и подставив место &#8230;&#8203; свое значение получим</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">gpg --armor --export 3AA5C34371567BD2</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-install-git1.png" alt="gpg install git1"></span></p>
</div>
<div class="paragraph">
<p>После этого выделяем и копируем от <code>-----BEGIN PGP PUBLIC KEY BLOCK-----</code> до <code>-----END PGP PUBLIC KEY BLOCK-----</code></p>
</div>
<div class="paragraph">
<p>Далее, как и при добавлении <strong>SSH</strong> ключей заходим в свой профиль - <em>setting</em> - <em>SSH and GPG keys</em> и выбираем уже <em>New GPG key</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-install-git2.png" alt="gpg install git2"></span></p>
</div>
<div class="paragraph">
<p>И в появившемся окне вставляем скопированный ключ и добавляем его.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/github-keys/gpg-install-git3.png" alt="gpg install git3"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_liquibase">4.2. Liquibase</h3>
<div class="paragraph">
<p><strong>Liquibase</strong> представляет систему управления версиями базы данных, в основном это касается структуры и в меньшей степени содержимого базы.
При этом описание базы с одной стороны достаточно абстрактно и позволяет использовать на нижнем уровне различные СУБД, и с другой стороны всегда можно перейти на SQL-диалект конкретной СУБД, что достаточно гибко.</p>
</div>
<div class="paragraph">
<p><strong>Liquibase</strong> является устоявшимся проектом с открытым исходным кодом и активно используется за пределами своей родной Java среды и не требует глубоких знаний Java для работы. В качестве описания структуры базы и изменений базы исторически использовался <strong>XML</strong> формат, однако сейчас параллельно поддерживается <strong>YAML</strong> и <strong>JSON</strong>. Более подробно: <a href="https://docs.liquibase.com/home.html">Liquibase Docs</a></p>
</div>
<div class="paragraph">
<p>Использовать <strong>Liquibase</strong> можно различными способами:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>как консольное приложение</strong></p>
</li>
<li>
<p><strong>как java-library</strong> подключенная к проекту</p>
</li>
<li>
<p><strong>как встроенную задачу в CI/CD инструмент</strong></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_настройка_окружения">4.2.1. Настройка окружения</h4>
<div class="sect4">
<h5 id="_установка_и_настройка_субд">Установка и настройка СУБД</h5>
<div class="paragraph">
<p>Так как <strong>Liquibase</strong> систему управления версиями базы данных, то необходимо устанавливать и настраивать СУБД. Вместо этого можно использовать <strong>Docker Compose</strong> и следующий файл для запуска <strong>PostgreSQL</strong> как <strong>Docker Container</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">version: '3.7'

services:
  maven-liquibase-postgres:
    container_name: maven-liquibase-postgres-container
    image: postgres
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${POSTGRES_DATABASE:-maven-liquibase}
      POSTGRES_USER: ${POSTGRES_USER:-postgres}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-postgres}
    ports:
      - '5432:5432'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для запуска можно использовать команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">docker-compose up -d</code></pre>
</div>
</div>
<div class="paragraph">
<p>Далее, при работе с Liquibase, будет использоваться данная СУБД.</p>
</div>
</div>
<div class="sect4">
<h5 id="_проект_с_liquibase">Проект с Liquibase</h5>
<div class="paragraph">
<p>При разработке на Java наиболее удобным будет использование <strong>Apache Maven</strong> или <strong>Gradle</strong>.</p>
</div>
<div class="paragraph">
<p>В дальнейшем речь пойдет именно о <strong>Apache Maven</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Структура проекта</div>
<div class="content">
<pre>.
├── pom.xml
└── src
    └── main
        └── resources
            ├── data
            ├── liquibase.properties
            └── master.xml</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pom.xml</code> - содержит все необходимые зависимости, настройки для Liquibase</p>
</li>
<li>
<p><code>liquibase.properties</code> - файл с настройками соединения к базе (логин/пароль и возможно другие параметры)</p>
</li>
<li>
<p>xml-файл с изменениями базы (либо другие варианты: YAML, JSON, XML + SQL, YAML + SQL, JSON + SQL)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title"><code>pom.xml</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;by.rakovets.example&lt;/groupId&gt;
    &lt;artifactId&gt;liquibase-maven&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;packaging&gt;pom&lt;/packaging&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;log4j2.version&gt;2.14.1&lt;/log4j2.version&gt;
        &lt;liquibase.version&gt;4.5.0&lt;/liquibase.version&gt;
        &lt;postgresql.version&gt;42.3.0&lt;/postgresql.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;!--Logging--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
            &lt;version&gt;${log4j2.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
            &lt;version&gt;${log4j2.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;
            &lt;version&gt;${log4j2.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!--JDBC drivers--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;
            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;
            &lt;version&gt;${postgresql.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.liquibase&lt;/groupId&gt;
            &lt;artifactId&gt;liquibase-core&lt;/artifactId&gt;
            &lt;version&gt;${liquibase.version}&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.liquibase&lt;/groupId&gt;
                &lt;artifactId&gt;liquibase-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${liquibase.version}&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;propertyFile&gt;src/main/resources/liquibase.properties&lt;/propertyFile&gt;
                    &lt;changeLogFile&gt;src/main/resources/master.xml&lt;/changeLogFile&gt;
                    &lt;dataDir&gt;src/main/resources/data&lt;/dataDir&gt;
                    &lt;!-- log  --&gt;
                    &lt;verbose&gt;true&lt;/verbose&gt;
                    &lt;logging&gt;debug&lt;/logging&gt;
                    &lt;promptOnNonLocalDatabase&gt;false&lt;/promptOnNonLocalDatabase&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Файл с настройками соединения к базе</p>
</div>
<div class="listingblock">
<div class="title"><code>liquibase.properties</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">username=postgres
password=postgres
url=jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified</code></pre>
</div>
</div>
<div class="paragraph">
<p>Основным понятием liquibase являются так называемые <strong>changesets</strong> (<strong>изменения базы</strong>). Они могут включать в себя как изменения структуры, так и изменение данных. Для контроля примененных <strong>changesets</strong> <strong>Liquibase</strong> использует таблицы <code>databasechangelog</code> и <code>databasechangeloglock</code>.</p>
</div>
<div class="listingblock">
<div class="title">Main changeLogFile <code>master.xml</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.1" encoding="UTF-8" standalone="no"?&gt;
&lt;databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd"&gt;

    &lt;changeSet context="legacy" author="author (generated)" id="1"&gt;
        &lt;createTable tableName="test"&gt;
            &lt;column autoIncrement="true" name="id" type="SERIAL"&gt;
                &lt;constraints nullable="false"/&gt;
            &lt;/column&gt;
            &lt;column name="user_name" type="VARCHAR(255)"/&gt;
            &lt;column name="preferences" type="TEXT"/&gt;
        &lt;/createTable&gt;

        &lt;rollback&gt;
            &lt;dropTable tableName="test" /&gt;
        &lt;/rollback&gt;
    &lt;/changeSet&gt;
&lt;/databaseChangeLog&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_обновление_бд">4.2.2. Обновление БД</h4>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">mvn liquibase:update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь выполняется <code>liquibase:update</code> для базы указанной в <code>liquibase.properties</code> из <code>liquibase.url</code>, которая указана в стандартном JDBC формате.</p>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre>[INFO] Scanning for projects...
[INFO]
[INFO] ----------------&lt; by.rakovets.example:liquibase-maven &gt;-----------------
[INFO] Building liquibase-maven 1.0.0
[INFO] --------------------------------[ pom ]---------------------------------
[INFO]
[INFO] --- liquibase-maven-plugin:4.5.0:update (default-cli) @ liquibase-maven ---
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[project, pluginDescriptor]
[INFO] Parsing Liquibase Properties File
[INFO]   File: src/main/resources/liquibase.properties
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO]
[INFO] Liquibase Community 4.5.0 by Datical
[INFO] ####################################################
##   _     _             _ _                      ##
##  | |   (_)           (_) |                     ##
##  | |    _  __ _ _   _ _| |__   __ _ ___  ___   ##
##  | |   | |/ _` | | | | | '_ \ / _` / __|/ _ \  ##
##  | |___| | (_| | |_| | | |_) | (_| \__ \  __/  ##
##  \_____/_|\__, |\__,_|_|_.__/ \__,_|___/\___|  ##
##              | |                               ##
##              |_|                               ##
##                                                ##
##  Get documentation at docs.liquibase.com       ##
##  Get certified courses at learn.liquibase.com  ##
##  Free schema change activity reports at        ##
##      https://hub.liquibase.com                 ##
##                                                ##
####################################################
Starting Liquibase at 06:31:52 (version 4.5.0 #52 built at 2021-09-27 16:19+0000)
[INFO] Settings
----------------------------
[INFO]     driver: null
[INFO]     url: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO]     username: *****
[INFO]     password: *****
[INFO]     use empty password: false
[INFO]     properties file: src/main/resources/liquibase.properties
[INFO]     properties file will override? false
[INFO]     prompt on non-local database? false
[INFO]     clear checksums? false
[INFO]     changeLogDirectory: null
[INFO]     changeLogFile: src/main/resources/master.xml
[INFO]     context(s): null
[INFO]     label(s): null
[INFO]     number of changes to apply: 0
[INFO]     drop first? false
[INFO] ------------------------------------------------------------------------
[INFO] Set default schema name to public
[INFO] Parsing Liquibase Properties File src/main/resources/liquibase.properties for changeLog parameters
[INFO] Executing on Database: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO] Successfully acquired change log lock
[INFO] Creating database history table with name: databasechangelog
[INFO] Reading from databasechangelog
[INFO] Table test created
[INFO] ChangeSet src/main/resources/master.xml::1::author (generated) ran successfully in 9ms
[INFO] Successfully released change log lock
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.069 s
[INFO] Finished at: 2021-10-23T06:31:52+03:00
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>После успешного выполнения в БД появляются:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>две служебные таблицы <code>databasechangelog</code> и <code>databasechangeloglock</code> (если их не было раньше)</p>
</li>
<li>
<p>запись в таблице <code>databasechangelog</code> с информацией о примененном <strong>changeset</strong></p>
</li>
<li>
<p>изменения указанные в <strong>changeset</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_генерация_sql_без_обновления_базы">4.2.3. Генерация SQL без обновления базы</h4>
<div class="paragraph">
<p>Иногда перед запуском изменений требуется посмотреть содержимое создаваемых запросов. Для этого предназначены команды <code>liquibase:updateSQL</code> и <code>liquibase:rollbackSQL</code></p>
</div>
<div class="sect4">
<h5 id="_liquibaseupdatesql"><code>liquibase:updateSQL</code></h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">mvn liquibase:updateSQL</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre>[INFO] Scanning for projects...
[INFO]
[INFO] ----------------&lt; by.rakovets.example:liquibase-maven &gt;-----------------
[INFO] Building liquibase-maven 1.0.0
[INFO] --------------------------------[ pom ]---------------------------------
[INFO]
[INFO] --- liquibase-maven-plugin:4.5.0:updateSQL (default-cli) @ liquibase-maven ---
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[project, pluginDescriptor]
[INFO] Parsing Liquibase Properties File
[INFO]   File: src/main/resources/liquibase.properties
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO]
[INFO] Liquibase Community 4.5.0 by Datical
[INFO] ####################################################
##   _     _             _ _                      ##
##  | |   (_)           (_) |                     ##
##  | |    _  __ _ _   _ _| |__   __ _ ___  ___   ##
##  | |   | |/ _` | | | | | '_ \ / _` / __|/ _ \  ##
##  | |___| | (_| | |_| | | |_) | (_| \__ \  __/  ##
##  \_____/_|\__, |\__,_|_|_.__/ \__,_|___/\___|  ##
##              | |                               ##
##              |_|                               ##
##                                                ##
##  Get documentation at docs.liquibase.com       ##
##  Get certified courses at learn.liquibase.com  ##
##  Free schema change activity reports at        ##
##      https://hub.liquibase.com                 ##
##                                                ##
####################################################
Starting Liquibase at 06:33:38 (version 4.5.0 #52 built at 2021-09-27 16:19+0000)
[INFO] Settings
----------------------------
[INFO]     driver: null
[INFO]     url: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO]     username: *****
[INFO]     password: *****
[INFO]     use empty password: false
[INFO]     properties file: src/main/resources/liquibase.properties
[INFO]     properties file will override? false
[INFO]     prompt on non-local database? false
[INFO]     clear checksums? false
[INFO]     changeLogDirectory: null
[INFO]     changeLogFile: src/main/resources/master.xml
[INFO]     context(s): null
[INFO]     label(s): null
[INFO]     number of changes to apply: 0
[INFO]     migrationSQLOutputFile: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] ------------------------------------------------------------------------
[INFO] Set default schema nliquibase:rollbackSQLame to public
[INFO] Char encoding not set! The created file will be system dependent!
[INFO] Output SQL Migration File: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] Parsing Liquibase Properties File src/main/resources/liquibase.properties for changeLog parameters
[INFO] Executing on Database: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO] Successfully acquired change log lock
[INFO] Reading from databasechangelog
[INFO] Successfully released change log lock
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.022 s
[INFO] Finished at: 2021-10-23T06:33:39+03:00
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Файл <code>target/liquibase/migrate.sql</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sql">-- *********************************************************************
-- Update Database Script
-- *********************************************************************
-- Change Log: src/main/resources/master.xml
-- Ran at: 10/23/21, 6:33 AM
-- Against: postgres@jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
-- Liquibase version: 4.5.0
-- *********************************************************************

-- Create Database Lock Table
CREATE TABLE databasechangeloglock (ID INTEGER NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP WITHOUT TIME ZONE, LOCKEDBY VARCHAR(255), CONSTRAINT databasechangeloglock_pkey PRIMARY KEY (ID));

-- Initialize Database Lock Table
DELETE FROM databasechangeloglock;

INSERT INTO databasechangeloglock (ID, LOCKED) VALUES (1, FALSE);

-- Lock Database
UPDATE databasechangeloglock SET LOCKED = TRUE, LOCKEDBY = 'ubuntu (172.20.0.1)', LOCKGRANTED = '2021-10-23 07:29:28.866' WHERE ID = 1 AND LOCKED = FALSE;

-- Create Database Change Log Table
CREATE TABLE databasechangelog (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP WITHOUT TIME ZONE NOT NULL, ORDEREXECUTED INTEGER NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10));

-- Changeset src/main/resources/master.xml::1::author (generated)
CREATE TABLE test (id INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL, user_name VARCHAR(255), preferences TEXT);

INSERT INTO databasechangelog (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'author (generated)', 'src/main/resources/master.xml', NOW(), 1, '8:d30ee8898b8b3a53a55c2ae2deba7edd', 'createTable tableName=test', '', 'EXECUTED', 'legacy', NULL, '4.5.0', '4963369142');

-- Release Database Lock
UPDATE databasechangeloglock SET LOCKED = FALSE, LOCKEDBY = NULL, LOCKGRANTED = NULL WHERE ID = 1;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_liquibaserollbacksql"><code>liquibase:rollbackSQL</code></h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">mvn liquibase:rollbackSQL -Dliquibase.rollbackCount=1</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>-Dliquibase.rollbackCount=1</code> - откатить 1 последнее изменение или использовать <strong>tags</strong> и тогда выполнять с командой <code>-Dliquibase.rollbackTag=${tag-name}</code>.</p>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre>[INFO] Scanning for projects...
[INFO]
[INFO] ----------------&lt; by.rakovets.example:liquibase-maven &gt;-----------------
[INFO] Building liquibase-maven 1.0.0
[INFO] --------------------------------[ pom ]---------------------------------
[INFO]
[INFO] --- liquibase-maven-plugin:4.5.0:rollbackSQL (default-cli) @ liquibase-maven ---
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[project, pluginDescriptor]
[INFO] Parsing Liquibase Properties File
[INFO]   File: src/main/resources/liquibase.properties
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO]
[INFO] Liquibase Community 4.5.0 by Datical
[INFO] ####################################################
##   _     _             _ _                      ##
##  | |   (_)           (_) |                     ##
##  | |    _  __ _ _   _ _| |__   __ _ ___  ___   ##
##  | |   | |/ _` | | | | | '_ \ / _` / __|/ _ \  ##
##  | |___| | (_| | |_| | | |_) | (_| \__ \  __/  ##
##  \_____/_|\__, |\__,_|_|_.__/ \__,_|___/\___|  ##
##              | |                               ##
##              |_|                               ##
##                                                ##
##  Get documentation at docs.liquibase.com       ##
##  Get certified courses at learn.liquibase.com  ##
##  Free schema change activity reports at        ##
##      https://hub.liquibase.com                 ##
##                                                ##
####################################################
Starting Liquibase at 06:43:58 (version 4.5.0 #52 built at 2021-09-27 16:19+0000)
[INFO] Settings
----------------------------
[INFO]     driver: null
[INFO]     url: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO]     username: *****
[INFO]     password: *****
[INFO]     use empty password: false
[INFO]     properties file: src/main/resources/liquibase.properties
[INFO]     properties file will override? false
[INFO]     prompt on non-local database? false
[INFO]     clear checksums? false
[INFO]     changeLogDirectory: null
[INFO]     changeLogFile: src/main/resources/master.xml
[INFO]     context(s): null
[INFO]     label(s): null
[INFO]     rollback Count: 1
[INFO]     rollback Date: null
[INFO]     rollback Tag: null
[INFO]     migrationSQLOutputFile: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] ------------------------------------------------------------------------
[INFO] Set default schema name to public
[INFO] Char encoding not set! The created file will be system dependent!
[INFO] Output SQL Migration File: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] Parsing Liquibase Properties File src/main/resources/liquibase.properties for changeLog parameters
[INFO] Executing on Database: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO] Successfully acquired change log lock
[INFO] Reading from databasechangelog
[INFO] Successfully released change log lock
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.046 s
[INFO] Finished at: 2021-10-23T06:43:59+03:00
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Файл <code>.Файл `target/liquibase/migrate.sql`</code></div>
<div class="content">
<pre>-- *********************************************************************
-- Rollback 1 Change(s) Script
-- *********************************************************************
-- Change Log: src/main/resources/master.xml
-- Ran at: 10/23/21, 6:43 AM
-- Against: postgres@jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
-- Liquibase version: 4.5.0
-- *********************************************************************

-- Lock Database
UPDATE databasechangeloglock SET LOCKED = TRUE, LOCKEDBY = 'ubuntu (172.20.0.1)', LOCKGRANTED = '2021-10-23 06:43:59.083' WHERE ID = 1 AND LOCKED = FALSE;

-- Rolling Back ChangeSet: src/main/resources/master.xml::1::author (generated)
DROP TABLE test;

DELETE FROM databasechangelog WHERE ID = '1' AND AUTHOR = 'author (generated)' AND FILENAME = 'src/main/resources/master.xml';

-- Release Database Lock
UPDATE databasechangeloglock SET LOCKED = FALSE, LOCKEDBY = NULL, LOCKGRANTED = NULL WHERE ID = 1;</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_подробнее_о_changeset">4.2.4. Подробнее о changeSet</h4>
<div class="paragraph">
<p>Изменения могут быть в разных форматах, в том числе обычный sql или он же в отдельном файле.</p>
</div>
<div class="paragraph">
<p>Каждое изменение может включать секцию <code>rollback</code> позволяющую откатывать изменения командой <code>liquibase:rollback</code>.
Кроме того для маркировки изменений, например для более удобного отката туда, можно использовать <code>tagDatabase</code>.</p>
</div>
<div class="sect4">
<h5 id="_обычный_формат">Обычный формат</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;changeSet context="legacy" author="author (generated)" id="1"&gt;
    &lt;createTable tableName="test"&gt;
        &lt;column autoIncrement="true" name="id" type="SERIAL"&gt;
            &lt;constraints primaryKey="true" primaryKeyName="test_pkey"/&gt;
        &lt;/column&gt;
        &lt;column name="c1" type="VARCHAR(255)"/&gt;
        &lt;column name="c2" type="INTEGER"/&gt;
        &lt;column name="c3" type="SMALLINT"/&gt;
        &lt;column name="c4" type="VARCHAR(255)"/&gt;
        &lt;column name="c5" type="TEXT"/&gt;
        &lt;column name="c6" type="VARCHAR(255)"/&gt;
    &lt;/createTable&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_встроенный_sql">Встроенный SQL</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-domain-some-domain"&gt;
    &lt;sql&gt;CREATE DOMAIN public.some_domain AS bigint; ALTER DOMAIN public.some_domain OWNER TO test;&lt;/sql&gt;
    &lt;rollback&gt;DROP DOMAIN public.some_domain;&lt;/rollback&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_файл_sql">Файл SQL</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-user"&gt;
    &lt;sqlFile dbms="postgresql" path="sql/some.sql" relativeToChangelogFile="true"/&gt;
    &lt;rollback&gt;delete from "some";&lt;/rollback&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_теги">Теги</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-initial-changeset"&gt;
    &lt;tagDatabase tag="initial"/&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_контексты_запуска">4.2.5. Контексты запуска</h4>
<div class="paragraph">
<p>Для более удобного управления различными конфигурациями, например <code>development/production</code> можно использовать контексты.
Контекст указывается в changeSet аттрибуте context и затем запускается <strong>Apache Maven</strong> параметром <code>-Dcontexts</code>.</p>
</div>
<div class="sect4">
<h5 id="_изменение_с_контекстом">Изменение с контекстом</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-initial-changeset"&gt;
    &lt;tagDatabase tag="initial"/&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_запуск_изменений_по_контексту">Запуск изменений по контексту</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">#!/usr/bin/env bash mvn liquibase:update\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test?prepareThreshold=0&amp;stringtype=unspecified"\
        -Dliquibase.contexts=non-legacy</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_откат_изменений">4.2.6. Откат изменений</h4>
<div class="paragraph">
<p>Операция обратная обновлению, в большинстве случаев поддерживается автоматически.
Для прочих возможно задание через секцию rollback.
Запускается командой liquibase:rollback.</p>
</div>
<div class="sect4">
<h5 id="_изменение_с_откатом">Изменение с откатом</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-domain-some-domain"&gt;
    &lt;sql&gt;CREATE DOMAIN public.some_domain AS bigint; ALTER DOMAIN public.some_domain OWNER TO test;&lt;/sql&gt;
    &lt;rollback&gt;DROP DOMAIN public.some_domain;&lt;/rollback&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_запуск_отката">Запуск отката</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">#!/usr/bin/env bash mvn liquibase:update\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test?prepareThreshold=0&amp;stringtype=unspecified"\
        -Dliquibase.contexts=non-legacy</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_сравнение">4.2.7. Сравнение</h4>
<div class="paragraph">
<p>В разработке удобно использовать для сравнения двух существующих баз на предмет внесённых изменений.
В настройки (или параметры запуска) потребуется добавить ссылку на reference DB и данные для доступа к ней.</p>
</div>
<div class="listingblock">
<div class="title"><code>liquibase.properties</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">referenceUsername=test referenceUrl=jdbc:postgresql://dev/test_reference</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_сравнение_схем">Сравнение схем</h5>
<div class="paragraph">
<p>Сравнение схем <code>url</code> и <code>referenceUrl</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">#!/usr/bin/env bash mvn liquibase:diff\
        -Denv=dev\
        -Dliquibase.referenceUrl="jdbc:postgresql://dev/test?prepareThreshold=0"\
        -Dliquibase.url="jdbc:postgresql://dev/test_reference?prepareThreshold=0"\
        -Dliquibase.diffChangeLogFile=dev/diff.xml</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_сохранение_схемы">4.2.8. Сохранение схемы</h4>
<div class="paragraph">
<p>Также бывает полезно сохранить текущую схему базы, с данными или без. Необходимо иметь в виду, что <strong>Liquibase</strong> сохраняет схему не полностью соответствующую оригиналу, например используемые домены или наследование нужно будет добавлять отдельно (см Ограничения).</p>
</div>
<div class="sect4">
<h5 id="_сохранение_схемы_без_учёта_данных">Сохранение схемы без учёта данных</h5>
<div class="paragraph">
<p>Сохранение схемы существующей базы.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">#!/usr/bin/env bash mvn liquibase:generateChangeLog\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test_reference?prepareThreshold=0"\
        -Dliquibase.outputChangeLogFile=dev/changelog.xml</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_сохранение_схемы_с_данными">Сохранение схемы с данными</h5>
<div class="paragraph">
<p>Сохранение схемы существующей базы с данными.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">#!/usr/bin/env bash mvn liquibase:generateChangeLog\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test_reference?prepareThreshold=0"\
        -Dliquibase.outputChangeLogFile=dev/changelog.xml</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_обработка_типов_данных_специфичных_для_конкретной_базы">4.2.9. Обработка типов данных специфичных для конкретной базы</h4>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;changeSet&gt;
    &lt;createTable tableName="t_name"&gt;
        ...
        &lt;column name="doubleArray" type="DOUBLE_ARRAY"/&gt;
        ...
    &lt;/createTable&gt;
    &lt;modifySql dbms="postgresql"&gt;
        &lt;replace replace="DOUBLE_ARRAY" with="double precision[][]"/&gt;
    &lt;/modifySql&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_альтернативные_решения">4.2.10. Альтернативные решения</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Flyway</strong><br>
Наряду с Liquibase пользуется популярностью в Java сообществе — <a href="http://flywaydb.org/documentation" class="bare">http://flywaydb.org/documentation</a></p>
</li>
<li>
<p><strong>Sqitch</strong><br>
Аналог на Perl — <a href="http://sqitch.org" class="bare">http://sqitch.org</a></p>
</li>
<li>
<p><strong>FluentMigrator</strong><br>
Аналог для .Net — <a href="https://github.com/schambers/fluentmigrator" class="bare">https://github.com/schambers/fluentmigrator</a></p>
</li>
<li>
<p><strong>DBGeni</strong><br>
Аналог для Ruby — <a href="http://dbgeni.appsintheopen.com/manual.html" class="bare">http://dbgeni.appsintheopen.com/manual.html</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_links_2">4.2.11. Links</h4>
<div class="ulist">
<ul>
<li>
<p>Существуют определенные проблемы с выгрузкой, сравнением и применением бинарных данных, в частности проблема с генерацией изменений.</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://liquibase.jira.com/browse/CORE-2650" class="bare">https://liquibase.jira.com/browse/CORE-2650</a></p>
</li>
<li>
<p><a href="https://liquibase.jira.com/browse/CORE-2906" class="bare">https://liquibase.jira.com/browse/CORE-2906</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Наследование и общие столбцы</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://forum.liquibase.org/topic/postgresql-subtable-via-inherits" class="bare">http://forum.liquibase.org/topic/postgresql-subtable-via-inherits</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/25840467/liquibase-common-columns" class="bare">https://stackoverflow.com/questions/25840467/liquibase-common-columns</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Исходный код</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/liquibase/liquibase" class="bare">https://github.com/liquibase/liquibase</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Как добавить liquibase в существующий проект</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/existing_project.html" class="bare">https://www.liquibase.org/documentation/existing_project.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/contexts.html" class="bare">https://www.liquibase.org/documentation/contexts.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Как работают изменения базы</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/changeset.html" class="bare">https://www.liquibase.org/documentation/changeset.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/databasechangelog_table.html" class="bare">https://www.liquibase.org/documentation/databasechangelog_table.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше о формате изменений</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.liquibase.org/documentation/json_format.html" class="bare">http://www.liquibase.org/documentation/json_format.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/changes/sql.html" class="bare">https://www.liquibase.org/documentation/changes/sql.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/changes/sql_file.html" class="bare">https://www.liquibase.org/documentation/changes/sql_file.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/column.html" class="bare">https://www.liquibase.org/documentation/column.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше про update</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/maven/generated/update-mojo.html" class="bare">https://www.liquibase.org/documentation/maven/generated/update-mojo.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше о генерации изменений</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/maven/generated/generateChangeLog-mojo.html" class="bare">https://www.liquibase.org/documentation/maven/generated/generateChangeLog-mojo.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше о custom SQL</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.liquibase.org/documentation/modify_sql.html" class="bare">http://www.liquibase.org/documentation/modify_sql.html</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/28240068/create-column-of-type-double-precision-with-liquibase" class="bare">https://stackoverflow.com/questions/28240068/create-column-of-type-double-precision-with-liquibase</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Прочее</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://news.ycombinator.com/item?id=10145933" class="bare">https://news.ycombinator.com/item?id=10145933</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Другие статьи о Liquibase</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://habr.com/ru/post/179425/" class="bare">https://habr.com/ru/post/179425/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/178665/" class="bare">https://habr.com/ru/post/178665/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/333762/" class="bare">https://habr.com/ru/post/333762/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/251617/" class="bare">https://habr.com/ru/post/251617/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/251617/" class="bare">https://habr.com/ru/post/251617/</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_тестирование">4.3. Тестирование</h3>
<div class="paragraph">
<p><strong>Тестирование</strong> (<strong>testing</strong>) <strong>программного обеспечения</strong> (<strong>ПО</strong>) – это процесс исследования ПО с целью выявления ошибок и определения соответствия между реальным и ожидаемым поведением ПО, осуществляемый на основе набора тестов, выбранных определённым образом. В более широком смысле, <strong>тестирование ПО</strong> – это техника контроля качества программного продукта, включающая в себя проектирование тестов, выполнение тестирования и анализ полученных результатов.</p>
</div>
<div class="paragraph">
<p>Очень часто современные программные продукты разрабатываются в сжатые сроки и при ограниченных бюджетах проектов. Программирование сегодня перешло из разряда искусства в разряд ремесел для многих миллионов специалистов. Но, к сожалению, в такой спешке разработчики зачастую игнорируют необходимость обеспечения защищённости своих продуктов, подвергая тем самым пользователей неоправданному риску. <strong>Контроль качества</strong> (<strong>тестирование</strong>) считается важным в <strong>процессе разработки ПО</strong>, потому что обеспечивает безопасность, надёжность, удобство создаваемого продукта. В настоящее время существует великое множество подходов и методик к решению задачи тестирования ПО, но эффективное тестирование сложных программных систем - процесс творческий, не сводящийся к следованию строгим и чётким правилам.</p>
</div>
<div class="sect3">
<h4 id="_классификация_видов_тестирования">4.3.1. Классификация видов тестирования</h4>
<div class="paragraph">
<p>Существует несколько признаков, по которым принято производить классификацию видов тестирования. Все <strong>виды тестирования</strong> программного обеспечения можно условно классифицировать по следующему виду:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>По степени автоматизации</p>
</li>
<li>
<p>По уровню доступа</p>
</li>
<li>
<p>В зависимости от преследуемых целей</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/testing/testing-diagram.png" alt="testing diagram"></span></p>
</div>
<div class="sect4">
<h5 id="_по_степени_автоматизации">По степени автоматизации</h5>
<div class="ulist">
<ul>
<li>
<p>Ручное тестирование;</p>
</li>
<li>
<p>Автоматизированное тестирование.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Ручное тестирование</strong> (<strong>manual testing</strong>) – тестирование при котором не используются программные средства для выполнения тестов и проверки результатов выполнения.</p>
</div>
<div class="paragraph">
<p><strong>Автоматизированное тестирование</strong> (<strong>automated testing</strong>) – тестирование, при котором используются программные средства для выполнения тестов и проверки результатов выполнения. <strong>Автоматизированное тестирование</strong>, несомненно, приносит пользу и экономит время и ресурсы компании.</p>
</div>
<div class="paragraph">
<p>В процессе разработки часто бывает так, что новая версия с исправленными ошибками выпускается каждый день, а иногда, и несколько раз в день. <strong>Дымовое тестирование</strong> прежде всего должно быть <strong>автоматизировано</strong>, потому что сразу после сборки новой версии программы нам необходимо в кратчайшие сроки убедиться в том, что программа запускается. Автоматический тест справится с подобной задачей за считанные секунды, и сборку можно будет считать успешной. Если же этим будет заниматься человек, то времени на проверку будет уходить гораздо больше. Таким образом, <strong>автоматизация дымового тестирования</strong> – это неплохая экономия времени отдела тестирования.</p>
</div>
<div class="paragraph">
<p>Для <strong>автоматизации тестирования</strong> существует большое количество приложений. Наиболее популярные из них:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HP LoadRunner,</p>
</li>
<li>
<p>HP QuickTest Professional,</p>
</li>
<li>
<p>HP Quality Center,</p>
</li>
<li>
<p>TestComplete.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Автоматизация</strong> в целом не только экономит время на разработку, но и увеличивает надежность и безопасность создаваемых продуктов. Очевидны также преимущества для тестеровщиков:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>надёжность проверки продукта возрастает</p>
</li>
<li>
<p>время на тестирование сокращается</p>
</li>
<li>
<p>работа тестирующего становится менее стрессовой</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Конечно, автоматические тесты никогда не смогут заменить человека, но могут облегчить работу инженера-тестировщика ПО.</p>
</div>
</div>
<div class="sect4">
<h5 id="_по_уровню_доступа">По уровню доступа</h5>
<div class="ulist">
<ul>
<li>
<p>Тестирование чёрного ящика;</p>
</li>
<li>
<p>Тестирование белого ящика.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_тестирование_чёрного_ящика">Тестирование чёрного ящика</h6>
<div class="paragraph">
<p><strong>Тестирование чёрного ящика</strong> (<strong>black box</strong>) - тестирование ПО, при котором тестировщик имеет доступ к ПО только через интерфейсы заказчика, либо через внешние интерфейсы, позволяющие другому компьютеру или процессу подключиться к системе для тестирования. Этот подход до сих пор является самым распространенным в повседневной практике, но у него есть целый ряд недостатков. Например, некоторые ошибки возникают достаточно редко и потому их трудно найти и воспроизвести.</p>
</div>
</div>
<div class="sect5">
<h6 id="_тестирование_белого_ящика">Тестирование белого ящика</h6>
<div class="paragraph">
<p><strong>Тестирование белого ящика</strong> (<strong>white box</strong>) - тестирование ПО, при котором тестировщик имеет доступ к исходному коду программы и может писать код, связанный с библиотеками тестируемого ПО. К тестированию белого ящика относят методики:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>чтение программ</p>
</li>
<li>
<p>формальные просмотры программ</p>
</li>
<li>
<p>инспекции.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Этот метод позволяет заглянуть внутрь <strong>"чёрного ящика"</strong> и сосредоточиться на внутренней информации, которая и определяет поведение программы. Основной трудностью является сложность отслеживания вычислений времени выполнения. При тестировании программы происходит проверка логики программы. Полным тестированием в этом случае будет такое, которое приведет к перебору всех возможных путей. Даже для средних по сложности программ число таких путей может достигать десятки тысяч.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_в_зависимости_от_преследуемых_целей">В зависимости от преследуемых целей</h5>
<div class="paragraph">
<p>Все <strong>виды тестирования</strong> программного обеспечения, в зависимости от преследуемых целей, можно условно разделить на следующие группы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Функциональные</strong></p>
</li>
<li>
<p><strong>Нефункциональные</strong></p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_функциональные_виды_тестирования">Функциональные виды тестирования</h6>
<div class="paragraph">
<p>Функциональные тесты базируются на функциях и особенностях, а также взаимодействии с другими системами, и могут быть представлены на всех уровнях тестирования:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>компонентном</strong> или <strong>модульном</strong> (<strong>Component</strong>/<strong>Unit testing</strong>)</p>
</li>
<li>
<p><strong>интеграционном</strong> (<strong>Integration testing</strong>),</p>
</li>
<li>
<p><strong>системном</strong> (<strong>System testing</strong>)</p>
</li>
<li>
<p><strong>приемочном</strong> (<strong>Acceptance testing</strong>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Функциональные виды тестирования рассматривают внешнее поведение системы. После проведения необходимых изменений, таких как исправление бага/дефекта, программное обеспечение должно быть протестировано повторно для подтверждения того факта, что проблема была действительно решена. Ниже перечислены виды функционального тестирования, которые необходимо проводить после установки программного обеспечения, для подтверждения работоспособности приложения или правильности осуществленного исправления дефекта:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Функциональное тестирование</strong> (<strong>Functional testing</strong>)</p>
</li>
<li>
<p><strong>Тестирование взаимодействия</strong> (<strong>Interoperability Testing</strong>)</p>
</li>
<li>
<p><strong>Дымовое тестирование</strong> <strong>(Smoke Testing</strong>)</p>
</li>
<li>
<p><strong>Регрессионное тестирование</strong> (<strong>Regression Testing</strong>)</p>
</li>
<li>
<p><strong>Тестирование сборки</strong> (<strong>Build Verification Test</strong>)</p>
</li>
<li>
<p><strong>Санитарное тестирование или проверка согласованности/исправности</strong> (<strong>Sanity Testing</strong>)</p>
</li>
<li>
<p><strong>Альфа-тестирование</strong></p>
</li>
<li>
<p><strong>Бета-тестирование</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Функциональное тестирование</strong> (<strong>functional testing</strong>) – тестирование ПО, направленное на проверку реализуемости функциональных требований.
При функциональном тестировании проверяется способность ПО правильно решать задачи, необходимые пользователям.</p>
</div>
<div class="paragraph">
<p><strong>Альфа-тестирование</strong> – это процесс имитации реальной работы разработчиков с программным продуктом, или реальная работа потенциальных пользователей с системой.</p>
</div>
<div class="paragraph">
<p><strong>Бета-тестирование</strong> – это распространение версий с ограничениями для некоторой группы лиц, с целью проверки содержания допустимо минимального количества ошибок в программном продукте.</p>
</div>
<div class="paragraph">
<p><strong>Регрессионное тестирование</strong> (<strong>regression testing</strong>) – тестирование ПО, при котором проводится проверка ранее найденных ошибок, а также проверка основной функциональности.</p>
</div>
<div class="paragraph">
<p>Проводится, как правило, на каждой новой версии программного продукта. <strong>Регрессивное тестирование является наиболее важной фазой тестирования</strong> непосредственно перед окончанием работ над продуктом, так как непосредственно перед релизом продукта крайне необходимо проверить не только основную функциональность, но и то, что ни одна из ранее найденных ошибок не повторяется в финальной версии. Являясь неотъемлемой частью функционального тестирования, регрессионное тестирование позволяет гарантировать, что изменения, связанные с устранением дефектов, не оказали негативного воздействия на остальные функциональные области приложения.</p>
</div>
<div class="paragraph">
<p><strong>Дымовое тестирование</strong> (<strong>smoke testing</strong>) - тестирование ПО, при котором выполняется набор тестов, после которого можно сказать, что программный продукт запускается.</p>
</div>
<div class="paragraph">
<p>Если ошибок при запуске не происходит, то дымовой тест считается пройденным. Если программа не прошла дымовой тест, то её отправляют на доработку. Дело в том, что разработчики пишут отдельные компоненты одного приложения, но когда эти компоненты объединяют, нередко получается так, что совместно они работать не могут, следовательно, нет смысла тестировать продукт в целом.</p>
</div>
</div>
<div class="sect5">
<h6 id="_нефункциональные_виды_тестирования">Нефункциональные виды тестирования</h6>
<div class="paragraph">
<p>Нефункциональное тестирование описывает тесты, необходимые для определения характеристик программного обеспечения, которые могут быть измерены различными величинами. В целом, это тестирование того, "Как система работает". Далее перечислены основные <strong>виды нефункциональных тестов</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Тестирование производительности</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>нагрузочное тестирование</strong> (<strong>Performance and Load Testing</strong>)</p>
</li>
<li>
<p><strong>стрессовое тестирование</strong> (<strong>Stress Testing</strong>)</p>
</li>
<li>
<p><strong>тестирование стабильности или надежности</strong> (<strong>Stability/Reliability Testing</strong>)</p>
</li>
<li>
<p><strong>объемное тестирование</strong> (<strong>Volume Testing</strong>)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Тестирование установки</strong> (<strong>Installation testing</strong>)</p>
</li>
<li>
<p><strong>Тестирование удобства пользования</strong> (<strong>Usability Testing</strong>)</p>
</li>
<li>
<p><strong>Тестирование на отказ и восстановление</strong> (<strong>Failover and Recovery Testing</strong>)</p>
</li>
<li>
<p><strong>Конфигурационное тестирование</strong> (<strong>Configuration Testing</strong>)</p>
</li>
<li>
<p><strong>Тестирование безопасности</strong> (<strong>Security and Access Control Testing</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Тестирование производительности</strong> (<strong>performance testing</strong>) – тестирование ПО, позволяющее осуществлять оценку быстродействия программного продукта при определённой нагрузке. Тест производительности выполняется до и после проведения оптимизации с целью выявить изменения в производительности. Если оптимизация не удается, и производительность снижается, то программист может отказаться от неудачной оптимизации. В случае повышения производительности величину этого повышения можно сравнить с ожидаемыми результатами, чтобы убедиться в успешности оптимизации. Задачей теста производительности является выявление фактов повышения и понижения производительности, чтобы можно было избежать неудачных модернизаций.</p>
</div>
<div class="paragraph">
<p><strong>Нагрузочное тестирование</strong> (<strong>load testing</strong>) – тестирование ПО, позволяющее осуществлять оценку быстродействия программного продукта при плановых, повышенных и пиковых нагрузках. Осуществление нагрузочного тестирования перед вводом системы в промышленную эксплуатацию позволяет избегать неожиданных потерь в производительности через полгода - год, когда система будет заполнена данными.</p>
</div>
<div class="paragraph">
<p><strong>Стресс-тестирование</strong> (<strong>stress testing</strong>) – тестирование ПО, которое оценивает надёжность и устойчивость системы в условиях превышения пределов нормального функционирования. Это проверка программы в таких стрессовых ситуациях как наличие большого объёма входных параметров, нехватка дискового пространства или маломощный процессор. <strong>Стресс тестирование</strong> предназначено для проверки настроенного решения и серверной группы на одновременное обслуживание большого количества пользователей. При таком тестировании проверяется не только серверная группа, но и влияние, оказываемое настройками на производительность системы в целом и ее отказоустойчивость. Для проведения такого тестирования необходимо иметь набор компьютеров, эмулирующих работу групп пользователей.</p>
</div>
<div class="paragraph">
<p><strong>Тестирование стабильности</strong> (<strong>stability/endurance/soak testing</strong>) – тестирование ПО, при котором проверяется работоспособность ПО при длительном тестировании со среднем уровнем нагрузки.</p>
</div>
<div class="paragraph">
<p><strong>Тестирование безопасности (security testing)</strong> – тестирование ПО, которое проверяет фактическую реакцию защитных механизмов, встроенных в систему на проникновение злоумышленников.</p>
</div>
<div class="paragraph">
<p><strong>Тестирование совместимости</strong> (<strong>compatibility testing</strong>) - тестирование ПО, которое проверяет работоспособность ПО в определенном окружении.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_уровни_тестирования">4.3.2. Уровни тестирования</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Модульное тестирование;</p>
</li>
<li>
<p>Интеграционное тестирование;</p>
</li>
<li>
<p>Системное тестирование;</p>
</li>
<li>
<p>Приемочное тестирование.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_пирамида_тестирования">Пирамида тестирования</h5>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/testing/test-pyramid.jpeg" alt="test pyramid"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../assets/img/common/testing/test-hierarchy.png" alt="test hierarchy"></span></p>
</div>
</div>
<div class="sect4">
<h5 id="_модульное_тестирование">Модульное тестирование</h5>
<div class="paragraph">
<p><strong>Модульное тестирование</strong> – это процесс исследования ПО, при котором тестируется минимально возможный компонент, например, отдельный класс или функция.
Часто модульное тестирование осуществляется разработчиками ПО.</p>
</div>
</div>
<div class="sect4">
<h5 id="_интеграционное_тестирование">Интеграционное тестирование</h5>
<div class="paragraph">
<p><strong>Интеграционное тестирование</strong> – это процесс исследования ПО, при котором тестируется интерфейсы между компонентами или подсистемами.</p>
</div>
</div>
<div class="sect4">
<h5 id="_системное_тестирование">Системное тестирование</h5>
<div class="paragraph">
<p><strong>Системное тестирование</strong> – это процесс исследования ПО, при котором тестируется интегрированная система на её соответствие требованиям заказчика. <strong>Альфа</strong> и <strong>Бета</strong> тестирование относятся к подкатегориям системного тестирования.</p>
</div>
</div>
<div class="sect4">
<h5 id="_приемочное_тестирование_acceptance_testing">Приемочное тестирование (Acceptance Testing)</h5>
<div class="paragraph">
<p><strong>Приемочное тестирование</strong> - формальный процесс тестирования, который проверяет соответствие системы требованиям и проводится с целью:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>определения удовлетворяет ли система приемочным критериям;</p>
</li>
<li>
<p>вынесения решения заказчиком или другим уполномоченным лицом принимается приложение или нет.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Приемочное тестирование</strong> выполняется на основании набора типичных тестовых случаев и сценариев, разработанных на основании требований к данному приложению. Решение о проведении приемочного тестирования принимается, когда:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>продукт достиг необходимого уровня качества;</p>
</li>
<li>
<p>заказчик ознакомлен с <strong>Планом Приемочных Работ</strong> (<strong>Product Acceptance Plan</strong>) или иным документом, где описан набор действий, связанных с проведением приемочного тестирования, дата проведения, ответственные и т.д.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Фаза приемочного тестирования</strong> длится до тех пор, пока заказчик не выносит решение об отправлении приложения на доработку или выдаче приложения.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_динамический_и_статический_анализ_кода">4.3.3. Динамический и статический анализ кода</h4>
<div class="paragraph">
<p>По мере продвижения проекта стоимость устранения дефектов ПО может экспоненциально возрастать. Инструменты <strong>статического</strong> и <strong>динамического</strong> анализа помогают предотвратить эти затраты благодаря обнаружению программных ошибок на ранних этапах жизненного цикла ПО.</p>
</div>
<div class="paragraph">
<p><strong>Динамический анализ кода</strong> (<strong>runtime analysis</strong>) – способ анализа программы непосредственно при ее выполнении. При динамическом анализе проблемы в исходном коде находятся по мере их возникновения. Процесс анализа можно разбить на несколько этапов:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>подготовка исходных данных</p>
</li>
<li>
<p>проведение тестового запуска программы</p>
</li>
<li>
<p>сбор необходимых параметров</p>
</li>
<li>
<p>анализ полученных данных</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Статический анализ кода</strong> (<strong>static analysis</strong>) - анализ программы, производимый без реального выполнения исследуемых программ. Статический анализ кода позволяет обнаружить дефекты в исходном коде до того, как код будет готов для запуска.</p>
</div>
<div class="paragraph">
<p>На практике разработчики могут использовать как статический, так и динамический анализ для ускорения процессов разработки и тестирования, а также для повышения качества исходного продукта.</p>
</div>
</div>
<div class="sect3">
<h4 id="_links_3">4.3.4. Links</h4>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.protesting.ru/testing/testtypes.html">Виды тестирования программного обеспечения</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Википедия. Модульное тестирование.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/testing/levels/component.html">Компонентное или модульное тестирование.</a></p>
</li>
<li>
<p><a href="https://www.bluej.org/tutorial/testing-tutorial.pdf">Unit Testing in BlueJ.</a></p>
</li>
<li>
<p><a href="https://msdn.microsoft.com/ru-ru/library/windows/apps/jj159318.aspx">Модульное тестирование кода Visual C# в приложениях для Магазина Windows.</a></p>
</li>
<li>
<p><a href="http://rsdn.org/article/testing/UnitTesting.xml">Модульное тестирование: 2+2 = 4?</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%82%D0%B5%D0%B3%D1%80%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%BE%D0%B5_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Википедия. Интеграционное тестирование.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/testing/levels/system.html">Системное тестирование.</a></p>
</li>
<li>
<p><a href="http://www.softwaretestingclass.com/system-testing-what-why-how/">System Testing: What? Why? &amp; How?</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Википедия. Функциональное тестирование.</a></p>
</li>
<li>
<p><a href="https://symfony.com/legacy/doc/jobeet/1_4/ru/09?orm=doctrine">День 9: Функциональное тестирование.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/testing/types/functional.html">Функциональное тестирование.</a></p>
</li>
<li>
<p>StackOverflow. <a href="https://stackoverflow.com/questions/2741832/unit-tests-vs-functional-tests">Unit tests vs Functional Testing.</a></p>
</li>
<li>
<p><a href="">Unit, Integration, and Functional Testing</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8">Википедия. Тестирование производительности.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/testing/types/loadtesttypes.html">Нагрузочное тестирование.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/automation/performance.html">Автоматизация нагрузочного тестирования.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%9D%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BE%D1%87%D0%BD%D0%BE%D0%B5_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Википедия. Нагрузочное тестирование.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/testing/types/loadtesttypes.html">Нагрузочное тестирование.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A1%D1%82%D1%80%D0%B5%D1%81%D1%81-%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D1%8F">Википедия. Стресс-тестирование программного обеспечения.</a></p>
</li>
<li>
<p><a href="https://devblogs.microsoft.com/cppblog/vc-ide-design-time-stress-testing/">VC++ IDE / Design Time Stress Testing</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8">Википедия. Тестирование стабильности.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D0%B8">Википедия. Тестирование безопасности.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE_%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B5%D0%B3%D0%B8%D0%B8_%D1%87%D1%91%D1%80%D0%BD%D0%BE%D0%B3%D0%BE_%D1%8F%D1%89%D0%B8%D0%BA%D0%B0">Википедия. Тестирование по стратегии чёрного ящика.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE_%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B5%D0%B3%D0%B8%D0%B8_%D0%B1%D0%B5%D0%BB%D0%BE%D0%B3%D0%BE_%D1%8F%D1%89%D0%B8%D0%BA%D0%B0">Википедия. Стратегия тестирования по принципу "Белого ящика".</a></p>
</li>
<li>
<p><a href="https://dic.academic.ru/dic.nsf/ruwiki/392944">Альфа тестирование.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%91%D0%B5%D1%82%D0%B0-%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Википедия. Бета-тестирование.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D0%BE%D0%BD%D0%BD%D0%BE%D0%B5_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Википедия. Регрессивное тестирование.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/testing/types/regression.html">Регрессивное тестирование.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/Smoke_test">Википедия. Smoke test.</a></p>
</li>
<li>
<p><a href="http://www.protesting.ru/testing/types/smoke.html">Дымовое тестирование.</a></p>
</li>
<li>
<p><a href="https://tpl-it.wikispaces.com/%d0%a0%d1%83%d1%87%d0%bd%d0%be%d0%b5+%d1%82%d0%b5%d1%81%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5+(manual+testing)">Ручное тестирование.</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/145974/">Тестирование: Ручное или Автоматизированное?</a></p>
</li>
<li>
<p><a href="">Автоматизированное тестирование.</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/145974/">Тестирование: Ручное или Автоматизированное?</a></p>
</li>
<li>
<p><a href="https://pvs-studio.com/ru/blog/terms/0070/">Динамический анализ кода.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%94%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7_%D0%BA%D0%BE%D0%B4%D0%B0">Википедия. Динамический анализ кода.</a></p>
</li>
<li>
<p><a href="https://ru.wikipedia.org/wiki/%D0%A1%D1%82%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7_%D0%BA%D0%BE%D0%B4%D0%B0">Википедия. Статический анализ кода.</a></p>
</li>
<li>
<p><a href="https://pvs-studio.com/ru/blog/terms/0046/">Статический анализ кода.</a></p>
</li>
<li>
<p><a href="https://pvs-studio.com/ru/blog/posts/a0087/">Джон Кармак о статическом анализе кода.</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-10-25 04:31:33 UTC
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
</body>
</html>