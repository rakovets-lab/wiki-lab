= Spring Boot
:imagesdir: ../../assets/img/java/spring/boot

== Введение в Spring Boot

*Spring Boot* — самый популярный фреймворк на основе Java, построенный на базе функций *Spring Framework*. Он используется для создания простых и понятных в понимании standalone (автономных) и web-based (веб) приложений.

=== Что такое Spring Boot?

*Spring Boot* — это проект с открытым исходным кодом, разработанный командой *Pivotal* (команда *Spring*). Он построен на основе *Spring Framework* и предоставляет собой *RAD* (*Rapid Application Development*/*Быстрая разработка приложений*) на основе *Spring Framework*. Он комбинирует *Spring Framework* и third-party libraries (сторонние библиотеки), которые упрощают создание приложений и уменьшения усилия по разработке. В отличие от *Spring Framework*, *Spring Boot* не требует конфигурации на основе XML или аннотаций, поскольку он автоматически настраивает *Spring* и сторонние библиотеки.

Целью платформы *Spring Boot* является полное удаление конфигураций на основе XML и сокращение времени разработки и интеграционного тестирования.

Цели *Spring Boot* перечислены ниже:

* Предложить полный *Opinionated Development Approach*.
* Обеспечить большую часть функционала неявно или по умолчанию.
* Избегать написания множества строк кода.

=== Необходимость использования Spring Boot

Некоторые из основных факторов использования среды Spring Boot перечислены ниже:

* Он обеспечивает гибкость и простоту при разработке приложений на основе Java.
* Он позволяет создавать менее трудоемкие приложения, так как большинство вещей управляются им по умолчанию.
* Он не требует какой-либо конфигурации на основе XML или Java, поскольку он автоматически настраивает Spring и сторонние библиотеки.
* Он также обеспечивает мощную batch (пакетную) обработку и гибкие транзакции базы данных.

=== Компоненты Spring Boot

image::components.png[]

As we have discussed, the Spring Boot framework is an upgraded project of the Spring framework with some additional features and components. There are four major components of Spring Boot that are listed below:

*Spring Boot* — это обновленный проект среды Spring с некоторыми дополнительными функциями и компонентами. Ниже перечислены четыре основных компонента *Spring Boot*:

* *Spring Boot Starters*
* *Spring Boot AutoConfiguration*
* *Spring Boot CLI*
* *Spring Boot Actuator*

Наряду с перечисленными выше основными компонентами в *Spring Boot* доступны еще два дополнительных компонента:

* *Spring Initializr*
* *Spring Boot IDEs*

==== Spring Boot Starters

*Spring Boot Starters* — один из основных компонентов среды *Spring Boot*. Он связывает более одной зависимости в группе. Это также уменьшает количество зависимостей, добавляемых вручную, путем объединения нескольких зависимостей в одну. Таким образом, он добавляет стартер вместо указания множества зависимостей.

Например, когда создается приложение *Spring MVC*, требуется множество зависимостей, таких как:

* *Spring Core*
* *Spring Web MVC*
* *Spring Web*

Наряду с приведенными выше зависимостями необходимы еще некоторые зависимости. Ручное добавление зависимостей загромождает код. Spring Boot предложил решение этой проблемы.

Spring Boot упрощает задачу, поскольку добавляет только *root dependency* (корневую зависимость) или *starter dependency* (начальную зависимость). Когда добавляется starter зависимость в приложение, *Spring Boot* автоматически добавляет в приложение все необходимые зависимости.

==== Spring Boot AutoConfiguration

*Spring Boot AutoConfiguration* также является важным компонентом *Spring Boot*. Когда создается любое приложение Spring, нам требуется много кода конфигурации, например конфигурации на основе XML, Java или аннотаций. В большинстве приложений это создает много путаницы и к трате большого количества времени на это.


Поэтому для решения проблемы возник *Spring Boot AutoConfiguration*. Он отвечает за сокращение конфигурации Spring. При создании *Spring Boot* приложения  нет необходимости определять какую-либо конфигурацию (на основе XML) и сократить использование конфигурации на основе аннотаций. Использование *Spring Boot AutoConfiguration* делает разработку приложений простой и быстрой, поскольку ее настройка не отнимает много времени.

Например, если использовать стартер `spring-boot-starter-web` в приложении, *Spring Boot* автоматически настраивает все bean-компоненты или классы необходимые для web-приложения.

==== Spring Boot CLI

*Spring Boot CLI* (*Command Line Interface*) — это интерфейс командной строки для приложений на основе *Spring Boot*. Он позволяет запустить приложение Spring Boot с помощью CLI. Он также используется для тестирования приложений Spring Boot из командной строки. Используя интерфейс командной строки Spring Boot, также можно выполнять Groovy код, который имеет аналогичный синтаксис, подобный Java.

При запуске некоторых приложений *Spring Boot* через *CLI* он под капотом использует компоненты *Spring Boot Starter* и *Spring Boot AutoConfiguration* для решения всех зависимостей и запуску приложения.

==== Spring Boot Actuator

*Spring Boot Actuator* также является важным компонентом *Spring Boot*. Он также разрабатывается как подпроект (инструмент) Spring Boot. Он предоставляет множество функций для среды Spring Boot, но в основном отвечает за две его основные функции:

* Он предоставляет (HTTP) EndPoints для управления (HTTP) для приложения на Spring Boot.
* Он позволяет управлять работающим приложениям с помощью этих HTTP EndPoints.

*Spring Boot Actuator* автоматически предоставляет имя хоста как `localhost` и номер порта как `8080` всякий раз, когда развертывается приложение Spring Boot с помощью интерфейса командной строки Spring Boot. Здесь обычно используются HTTP-методы GET или POST для взаимодействия с HTTP EndPoints по средствам *Spring Boot Actuator*.

Spring Boot Actuator в основном используется для доступа к внутренней информации приложения, такой как metrics (метрики), dump (дамп), health (работоспособность) и т.д.

==== Spring Initializr

*Spring Initializr* — это веб-интерфейс для создания, настройки и создания приложений на базе Spring. Другими словами, это инструмент, который используется для быстрого создания проекта на основе JVM. Он может создавать проекты на различных языках, таких как Java, Kotlin и Groovy. Он также предоставляет скрипт (*Maven* или *Gradle*) для создания приложений.

==== Spring Boot IDEs

*Spring Boot* поддерживает множество *IDE*, таких, как *Eclipse*, *IntelliJ IDEA*, *Spring Tool Suite* (*STS*) и т.д., которые используются для создания приложений.

=== Преимущества Spring Boot

Основное преимущество Spring Boot заключается в том, что он состоит из фреймворка Spring и Embedded HTTP server. Но конфигурации на основе XML и аннотаций почти нет.

image::advantages.png[]

Другие преимущества среды Spring Boot приведены ниже:

* С ним легко разрабатывать приложения на основе Spring с помощью Groovy и Java.
* Он повышает производительность и сокращает время разработки, поскольку большинство вещей управляются по умолчанию.
* Он сводит к минимуму написание типичного длинного кода, такого как конфигурация на основе XML и аннотаций.
* Он делает простой и плавной интеграцию Spring Boot с другими экосистемами, такими как Spring Security, Spring Data, Spring JDBC и ORM.
* Он также предоставляет встроенные HTTP-серверы, такие, как *Apache Tomcat*, *Apache Jetty*, сервер приложений *Undertow* и многие другие, для развертывания и тестирования приложений на основе Spring.
* Он также предлагает несколько плагинов для простой разработки и тестирования приложений Spring Boot с использованием инструментов сборки, таких как Maven.

=== Ограничения Spring Boot

Некоторые из ограничений Spring Boot перечислены ниже:

* Он содержит некоторые дополнительные зависимости, которые могут быть бесполезны для конкретного приложения, поскольку используется *Spring Boot Starters* (root dependencies).
* Ненужные зависимости, используемые в приложениях, приводят к огромному размеру приложения.
* Преобразование приложений на *Spring Framework* в приложения на *Spring Boot* занимает немного времени.

== Spring Boot Features

As we have discussed, the Spring Boot framework is built on the top of the Spring framework. It is an upgraded version of the Spring project, so it is capable of doing the things that the Spring framework can’t do.

Here, we are going to discuss the key features of the Spring Boot framework, which are listed below:

.Features of Spring Boot
image:features.png[]

* SpringApplication
* Lazy Initialization
* Admin Features
* Security
* Logging
* Caching
* Kotlin Support
* Validation
* JSON
* Testing
* Task Execution and Scheduling

=== SpringApplication

The SpringApplication class is mainly used to bootstrap and launch a Spring application using the main method. In some cases, we can also use static `SpringApplication.run()` method, as shown below.

[source,java]
----
public class MyFirstSpringApp {
    public static void main(String[] args) {
           SpringApplication.run(MyFirstSpringApp.class, args);
    }
}
----

By default, the info logging messages are shown whenever a Spring application starts. This startup info logging messages can be turned off by setting spring.main.log-startup-info to false.

=== Lazy Initialization

In the Spring Boot framework, the SpringApplication helps in the lazy initialization of the Spring applications. After enabling the lazy initialization, beans are created as per the requirement rather than during the application startup, which results in faster execution of the application. When enabling lazy initialization in a web application, some web-related beans are not initialized until an HTTP request is received.

We can enable lazy initialization in three ways:

    First, by using the method lazyInitialization() of the SpringApplicationBuilder class.
    Second, by using the setLazyInitialization() method of the SpringApplication class.
    Third, by using the property spring.main.lazy-initialization.

spring.main.lazy-initialization= true

=== Admin Features

In the Spring Boot framework, we can enable the admin-related features by specifying the spring.application.admin.enabled property. It displays the SpringApplicationAdminMXBean interface on the platform MBeanServer. It is used to implement the wrapper services and also administrate the Spring Boot applications.

=== Security

The Spring Boot applications are Spring-based applications. Therefore, the Spring Boot applications are highly secure, and it relies on the Spring Security strategies. The @EnableGlobalMethodSecurity annotation is used to add the method –level security in a web application.

=== Logging

The Spring Boot framework uses the Commons-logging for all the internal loggings, which is a Java-based programming model service for logging and other toolkits. Some default configurations are also provided for Log4J2, Logback, and Java Util Logging.

=== Caching

Caching is supported by the Spring Boot framework. It is also applied to the methods of the applications, that results in reducing the number of executions based on the information available to the cache. The Spring Boot auto-configures the cache as long as the support for caching is enabled by using the annotation @EnableCaching annotation.

=== Kotlin Support

Kotlin is a programming language used for Android, server-side, mobile cross-platform, and web development. It targets the JVM and other platforms that allow writing short and simple code while providing interoperability with other existing libraries of Java.

=== Validation

The method validation feature is automatically supported by the Spring Boot framework. It allows the bean methods to be annotated with javax.validation constraint on their fields and return values. The target classes are annotated with the @Validated annotation at level-type and searched by the validator for validation.

=== JSON

The Spring Boot framework offers integration with mainly three JSON mapping libraries:

* *Gson* +
The Gson configuration is provided by default. Therefore, it is automatically configured when Gson is on the classpath. There are several `spring.gson.*` Configuration properties are available for modifying the configurations. The GsonBuilderCustomizer bean is also used for controlling configurations.

* *Jackson* +
It is a part of the spring-boot-starter-json repository. Like Gson, the Jackson configuration is provided, by default. An ObjectMapper bean is automatically configured when Jackson is on the classpath. It also offers several configuration properties for customizing the configuration of the ObjectMapper.

* *JSON-B* +
The auto-configuration for JSON-B is also provided by default. A Jsonb bean is automatically configured when the JSON-B API and its implementation are on the classpath.

Jackson is the default and most preferred JSON library.

=== Testing

The Spring Boot framework provides a variety of utilities and annotations to help in testing the applications. There are two modules that provide test support, one is spring-boot-test that contains all the core items, and the other is spring-boot-test-autoconfigure that supports auto-configuration for tests.

=== Task Execution and Scheduling

If the Executor bean is absent in the context, the Spring Boot auto-configures a ThreadPoolTaskExecutor. According to the target, we can change the Executor bean to a ThreadPoolTaskExecutor or can define both ThreadPoolTaskExecutor and an AsyncConfiguration.

==  Spring Boot Architecture

Spring Boot Architecture: Spring Boot is an advanced version or project of the Spring framework. Along with the Spring framework, it also consists of third-party libraries and Embedded HTTP servers. It easily creates a production-grade, less time-consuming, and stand-alone applications based on the Spring framework.

The aim of Spring Boot is to completely remove the use of XML-based and annotation-based configuration in the applications. Using Spring Boot, we can also create an application with minimal fuss (less time and effort). By default, it offers most of the things, such as functions, procedures, etc.

In this tutorial, we are going to learn about the architecture of the Spring Boot framework. It follows the layered architecture and consists of four layers, as shown below.

* *Presentation Layer*
* *Business Layer*
* *Persistence Layer*
* *Database Layer*

.Spring Boot Architecture
image::architecture-1.png[]

The above diagram shows that each layer of the architecture is directly communicating with the layer just above or below it, is because of the workflow. It means each layer only depends on its adjacent layer, so if we change the API of one layer, we just need to update the layers adjacent to it.

The brief description of the layers is given below.

* *Presentation layer* +
It is the front layer or top layer of the architecture, as it consists of views. It is used to translate the JSON fields to objects and vice-versa, and also handles authentication and HTTP requests. After completing the authentication, it passes it to the business layer for further processes.

* *Business Layer* +
It handles all the business logic and also performs validation and authorization as it is a part of business logic. For example, only admins are allowed to modify the user’s account.

* *Persistence Layer*+

It contains all the storage logic, such as database queries of the application. It also translates the business objects from and to database rows.

* *Database Layer*+

The database layer consists of the database such as MySQL, Postgre, MongoDB, etc. It may contain multiple databases. All the database related operations like CRUD (Create, Read/Retrieve, Update, and Delete) are performed in this layer.

The implementation of the above layered architecture is performed in such a way:

The HTTP request or web requests are handled by the Controllers in the presentation layer, the services control the business logic, and the repositories handle persistence (storage logic). A controller can handle multiple services, a service can handle multiple repositories, and a repository can handle multiple databases.
Spring Boot Work Flow

The Spring Boot architecture is based on the Spring framework. So, it mostly uses all the features and modules of Spring-like Spring MVC, Spring Core, etc., except that there is no need for the DAO and DAOImpl classes.

The following diagram shows the workflow of Spring Boot.

.Spring Boot Architecture
image::architecture-2.png[]

    The client makes an HTTP request (GET or POST).
    The request is forwarded to the controller, and it maps the request and processes it. It also calls the service logic if needed.
    The business logic is performed in the service layer, and the logic is performed on the data from the database that is mapped with the model or entity class through JPA.
    A JSP page is returned as a response to the client if no error has occurred.

link:https://www.tutorialandexample.com/spring-boot-tutorial[]