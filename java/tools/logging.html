<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Logging</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Logging</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Logging</strong> (<strong>логирование</strong>, <strong>журналирование</strong>) — это процесс записи куда-то (в файл, в сетевой сокет) данных о работе программы. Место, куда эти данные записываются, чаще всего представляет собой <strong>log-файл</strong> или систему логирования (например: ELK stack). Само содержимое называют <strong>logs</strong> (<strong>логи</strong>). <strong>Log</strong> (<strong>лог</strong>) — это одна запись, которая делается в <strong>log-file</strong> или систему логирования. Само действие по отправке записи при logging называется <strong>log</strong> (<strong>логировать</strong>, <strong>журналировать</strong>, <strong>записывать в logs</strong>).</p>
</div>
<div class="paragraph">
<p>Если в работе сервера, компьютера или программного обеспечения возникла неизвестная ошибка, в первую очередь смотрят logs. <strong>Log-файл</strong> — <strong>текстовый файл</strong> с информацией о действиях программного обеспечения или пользователей, который хранится на компьютере или передается на хранение в систему логирования. Это хронология событий и их источников, ошибок и причин, по которым они произошли. Читать и анализировать логи можно как с помощью обычного текстового редактора, так и с помощью специального ПО.</p>
</div>
<div class="paragraph">
<p><strong>Logging</strong> позволяет ответить на вопросы, что происходило, когда и при каких обстоятельствах. Без логов сложно понять, из-за чего появляется ошибка, если она возникает периодически и только при определенных условиях. Чтобы облегчить задачу администраторам и программистам, в logs записывается информация не только об ошибках, но и о причинах их возникновения. Благодаря logs найденные ошибки можно быстро исправить.</p>
</div>
<div class="paragraph">
<p>Следует так же понимать, что logs - фактически единственный способ понять, что произошло с программой, установленной и работающей на production environment, к которому, чаще всего, разработчики не имеют доступ. Поэтому разработчикам стоит заботиться о том, что бы разработанное ПО осуществляло logging, которое позволит установить причины неполадки и т.д.</p>
</div>
<div class="paragraph">
<p>Весь процесс логирования состоит из трех частей.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Сбор информации.</p>
</li>
<li>
<p>Фильтрование собранной информации.</p>
</li>
<li>
<p>Запись отобранной информации.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_типы_логов">Типы логов</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Для удобной работы с логами их делят на типы. Это помогает быстрее находить нужные и выбирать правильные инструменты для работы с ними. Например, выделяют:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>системные логи</strong>, то есть те, которые связаны с системными событиями;</p>
</li>
<li>
<p><strong>серверные логи</strong>, регистрирующие обращения к серверу и возникшие при этом ошибки;</p>
</li>
<li>
<p><strong>логи баз данных</strong>, фиксирующие запросы к базам данных;</p>
</li>
<li>
<p><strong>почтовые логи</strong>, относящиеся к входящим/исходящим письмам и отслеживающие ошибки, из-за которых письма не были доставлены;</p>
</li>
<li>
<p><strong>логи авторизации</strong>;</p>
</li>
<li>
<p><strong>логи аутентификации</strong>;</p>
</li>
<li>
<p><strong>логи приложений</strong>, установленных на этих операционных системах.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Также логи можно типизировать <strong>по степени важности</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Fatal/critical error</strong> — то, что нужно срочно исправить.</p>
</li>
<li>
<p><strong>Not critical error</strong> — ошибки, которые не влияют на пользователя.</p>
</li>
<li>
<p><strong>Warning</strong> — предупреждения, то, на что нужно обратить внимание.</p>
</li>
<li>
<p><strong>Initial information</strong> — информация о вызовах <strong>API</strong> сервиса, запросах в БД, вызовах других сервисов.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Еще одним важным вопросом на который надо ответить — это что необходимо отправлять в log.</p>
</div>
<div class="paragraph">
<p>Работа приложения — это происходящие в нем события, которые в свою очередь могут быть классифицированы на:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>события, связанные с бизнес-логикой;</p>
</li>
<li>
<p>события, связанные с безопасностью приложения;</p>
</li>
<li>
<p>системные события, связанные с уже конкретикой реализации — вызовов ОС, использования библиотек, фреймворков и т.д.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Записывать в logs обязательно необходимо:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Начало/конец работы приложения</strong>. Нужно знать, что приложение действительно запустилось, как и ожидалось, и завершилось так же ожидаемо.</p>
</li>
<li>
<p><strong>Вопросы безопасности</strong>. Здесь хорошо бы логировать попытки подбора пароля, логирование входа пользователей и т.д.</p>
</li>
<li>
<p>Некоторые <strong>состояния приложения</strong>. Например, переход из одного состояния в другое в бизнес процессе.</p>
</li>
<li>
<p>Некоторая <strong>информация для debug</strong>, с соответственным уровнем логирования.</p>
</li>
<li>
<p><strong>Некоторые SQL скрипты</strong>. Есть реальные случаи, когда это нужно. Опять-таки, умелым образом регулируя уровни, можно добиться отличных результатов.</p>
</li>
<li>
<p><strong>Выполняемые потоки (Thread)</strong> могут быть отправлены в log в случаях с проверкой корректной работы.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Популярные ошибки в logging:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Избыток логирования</strong><br>
Не стоит логировать каждый шаг, который чисто теоретически может быть важным. <strong>Есть правило</strong>: логи могут нагружать работоспособность не более, чем на <strong>10%</strong>. Иначе будут проблемы с производительностью.</p>
</li>
<li>
<p><strong>Логирование всех данных в один файл</strong><br>
Это приведет к тому, что в определенный момент чтение/запись в него будет очень сложной, не говоря о том, что есть ограничения по размеру файлов в определенных системах.</p>
</li>
<li>
<p><strong>Использование неверных уровней логирования</strong><br>
У каждого уровня логирования есть четкие границы, и их стоит соблюдать. Если граница расплывчатая, можно договориться какой из уровней использовать.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_библиотеки_логирования_в_java">Библиотеки логирования в Java</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В <strong>Java</strong> существуют следующие <strong>библиотеки логирования</strong>, иногда называемые <strong>loggers</strong> (<strong>логерами</strong>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Log4j</strong> - это первый набор инструментов для логирования Java, который появился еще в 1999-м году. Внутри себя имеет различные способы вывода логов, несколько форматов логирования и многое другое. Раньше данная библиотека активно применялась, но уже долгое время этот проект не развивается.</p>
</li>
<li>
<p><strong>JUL</strong> — <code>java.util.logging</code>. Является частью <strong>JDK</strong>. Имеет множество уровней логирования, например, только для отладки у этого инструмента есть в арсенале 3 отладочных уровня вместо одного как у большинства библиотек.</p>
</li>
<li>
<p><strong>JCL</strong> — <strong>Apache Commons Logging</strong>. Из-за того, что долгое время не было промышленного стандарта в logging и был период, когда многие создавали свой свои собственные библиотеки логирования, решили выпустить <strong>JCL</strong> — общую обертку, которая  использовалась бы над другими.</p>
</li>
<li>
<p><strong>Logback</strong> - был создан как альтернатива умирающему <strong>Log4j</strong>, разработанная создателями <strong>Log4j</strong>, поэтому он вобрал в себя все лучшее из этого инструмента, при этом усовершенствовал некоторые показатели.</p>
</li>
<li>
<p><strong>Log4j 2.x</strong> - это улучшенная версия <strong>log4j 1.x</strong> и <strong>logback</strong>.</p>
</li>
<li>
<p><strong>SLF4J</strong> — <strong>Simple Logging Facade for Java</strong>. Этот инструмент является оберткой над многими популярными библиотеками логирования, например: <strong>Logback</strong>, <strong>Log4j</strong>, <strong>JUL</strong> и др., поэтому его рекомендуется использовать в паре с полноценной библиотекой для логирования.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_уровень_логирования">Уровень логирования</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Если в <strong>лог-файл</strong> записывать все действия программы, то там будет большое количество различных сведений. В некоторых ситуациях лог-файлы могут генерироваться очень быстро и в огромных размерах. В этом случае найти нужную информацию в логах будет очень нелегко. Поэтому, чтобы контролировать объемы записываемой информации, придумали различные уровни логирования.</p>
</div>
<div class="paragraph">
<p><strong>Уровень логирования</strong> — это разделение событий по приоритетам, по степени важности. Например, <strong>error</strong> - пишем ошибки, <strong>debug</strong> - пишем более подробно в лог и т.д.</p>
</div>
<div class="paragraph">
<p>Практически все библиотеки логирования (кроме <strong>JUL</strong>) имеют следующие уровни логирования:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OFF</strong>: никакие логи не записываются, все будут проигнорированы</p>
</li>
<li>
<p><strong>FATAL</strong>: ошибка, после которой приложение уже не сможет работать и будет остановлено, например, <strong>JVM out of memory error</strong></p>
</li>
<li>
<p><strong>ERROR</strong>: уровень ошибок, когда есть проблемы, которые нужно решить. Ошибка не останавливает работу приложения в целом. Остальные запросы могут работать корректно</p>
</li>
<li>
<p><strong>WARN</strong>: обозначаются логи, которые содержат предостережение. Произошло неожиданное действие, несмотря на это система устояла и выполнила запрос</p>
</li>
<li>
<p><strong>INFO</strong>: лог, который записывает важные действия в приложении. Это не ошибки, это не предостережение, это ожидаемые действия системы</p>
</li>
<li>
<p><strong>DEBUG</strong>: логи, необходимые для отладки приложения. Для уверенности в том, что система делает именно то, что от нее ожидают, или описания действия системы: <code>method1 начал работу</code></p>
</li>
<li>
<p><strong>TRACE</strong>: менее приоритетные логи для отладки, с наименьшим уровнем логирования</p>
</li>
<li>
<p><strong>ALL</strong>: уровень, при котором будут записаны все логи из системы</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Если в приложении в каком-то месте включен уровень логирования <strong>INFO</strong>, будут записываться в logs все уровни, начиная с <strong>INFO</strong> и до <strong>FATAL</strong>. Если будет уровень логирования <strong>FATAL</strong>, будут записаны <strong>только logs с этим уровнем</strong>.</p>
</div>
<div class="paragraph">
<p><strong>JUL</strong> имеет следующие уровни логирования (по степени убывания приоритета):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OFF</strong></p>
</li>
<li>
<p><strong>ALL</strong></p>
</li>
<li>
<p><strong>SEVERE</strong></p>
</li>
<li>
<p><strong>WARNING</strong></p>
</li>
<li>
<p><strong>INFO</strong></p>
</li>
<li>
<p><strong>CONFIG</strong></p>
</li>
<li>
<p><strong>FINE</strong></p>
</li>
<li>
<p><strong>FINER</strong></p>
</li>
<li>
<p><strong>FINEST</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_основные_термины">Основные термины</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В основе большинства библиотек логирования в <strong>Java</strong> лежат три понятия:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Logger</strong></p>
</li>
<li>
<p><strong>Appender</strong></p>
</li>
<li>
<p><strong>Layout</strong></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_logger">Logger</h3>
<div class="paragraph">
<p><strong>Logger</strong> — это некий объект, который отвечает за запись информации в лог-файлы или систему логирования, опираясь на заданные уровни логирования. <strong>Logger</strong> создается с помощью <strong>Factory</strong> и на этапе создания ему присваивается имя. Имя может быть любым, но по стандарту имя должно быть сопряжено с именем класса, в котором собираются что-то логировать.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private Logger logger = LoggerFactory.gerLogger(SomeClass.class);

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Основная задача Logger</strong> — не пропустить событие, которое нужно записать в лог-файл.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private Logger logger = LoggerFactory.gerLogger(SomeClass.class);

    public static void main(String[] args) {
        logger.info("Application started");
        logger.debug("Or not");
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Каждый log представляет собой событие, которое произошло. Событие по сути состоит из двух полей:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>message</code></p>
</li>
<li>
<p><code>level</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>В примере выше, <code>level</code> - это <code>Level.Info</code>, а <code>message</code> - это <code>"Application started"</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_appender">Appender</h3>
<div class="paragraph">
<p><strong>Appender</strong> — это конечная точка, куда «приходит» информация для логирования. В качестве <strong>appender</strong> могут выступать: <strong>файл</strong>, <strong>база данных</strong>, <strong>консоль</strong>, <strong>сокет</strong> и др. У <strong>appender</strong> нет каких-либо ограничений, куда записывать сообщения. Можно написать свой <strong>appender</strong>, который пишет сообщения куда-угодно. Если <strong>Logger</strong> — это начальная точка в logging, то <strong>Appender</strong> — это конечная точка.</p>
</div>
<div class="paragraph">
<p><strong>Loggers</strong>  и <strong>appenders</strong> связаны в отношении <code>many-to-many</code>. При этом один <strong>logger</strong> может содержать несколько <strong>appenders</strong> и наоборот. Чтобы изменить поведение <strong>logger по умолчанию</strong>, нам нужно произвести конфигурацию для logging.</p>
</div>
</div>
<div class="sect2">
<h3 id="_layout">Layout</h3>
<div class="paragraph">
<p><strong>Layout</strong> — это формат, в котором выводятся сообщения. Форматирование сообщений напрямую зависит от используемой библиотеки при logging.</p>
</div>
</div>
<div class="sect2">
<h3 id="_logging_nodes">Logging Nodes</h3>
<div class="paragraph">
<p>При создании logger используется класс, но по итогу записывается полное имя класса с пакетами. Это делается, чтобы потом можно было разделить на <strong>logging nodes</strong> (<strong>узлы логирования</strong>), и для каждого узла настроить уровень логирования и appender. Например, имя класса: <code>com.github.romankh3.logginglecture.MainDemo</code> — в нем создался logger. И вот таким образом его можно разделить на <strong>logging nodes</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../assets/img/java/tools/logging/logging-nodes.png" alt="logging nodes"></span></p>
</div>
<div class="paragraph">
<p>Каждый <strong>logger</strong> имеет имя, описывающее иерархию, к которой он принадлежит. Разделитель – точка. Принцип полностью аналогичен формированию имени пакета в <strong>Java</strong>. Например: <code>by.rakovets.example.SomeClass</code>. Главный узел — нулевой <strong>RootLogger</strong>. Это узел, который принимает все логи всего приложения. Каждому <strong>logger</strong> можно выставить свой уровень. Установленный <strong>logger</strong> уровень вывода распространяется на все его дочерние <strong>loggers</strong>, для которых явно не выставлен уровень. Поэтому у всех <strong>loggers</strong> будет уровень логирования, даже если явно мы не прописали для <code>by.rakovets.example.SomeClass</code> его, то он будет наследоваться от <strong>RootLogger</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Appenders</strong> настраивают свою работу именно на узлы логирования. Но такое наследование <strong>appenders</strong> можно отключить через конфигурацию, для этого стоит посмотреть в сторону выставления флага <code>additivity="false"</code> на <strong>loggers</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_конфигурация_и_использование">Конфигурация и использование</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_конфигурация">Конфигурация</h3>
<div class="paragraph">
<p>При конфигурировании можно выбрать куда будет производиться запись, путь где будет лежать файл лога, количество файлов, их размеры. Более подробные описания конфигураций для различных реализаций будут приведены при описании этих реализаций.</p>
</div>
<div class="paragraph">
<p>В зависимости от используемой библиотеки, <strong>loggers</strong> могут конфигурироваться различными способами.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Log4j</strong> поддерживает конфигурирование двумя способами – как <strong>properties</strong> и <strong>xml</strong> файл.</p>
</li>
<li>
<p><strong>JUL</strong> настраивается только через <strong>properties</strong> файл.</p>
</li>
<li>
<p><strong>Logback</strong> может быть сконфигурирован через <strong>xml</strong> и <strong>groovy</strong> файл.</p>
</li>
<li>
<p><strong>Log4j 2</strong> может быть сконфигурирован через <strong>xml</strong>, <strong>json</strong> и <strong>yaml</strong> файл.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Конфигурация через xml-файл:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;
&lt;log4j:configuration debug="false" xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;
    &lt;appender name="ConsoleAppender" class="org.apache.log4j.ConsoleAppender"&gt;
        &lt;param name="Encoding" value="Cp866"/&gt;
        &lt;layout class="org.apache.log4j.PatternLayout"&gt;
            &lt;param name="ConversionPattern" value="%d{ISO8601} [%-5p][%-16.16t][%32.32c] - %m%n" /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;root&gt;
        &lt;priority value="DEBUG"/&gt;
        &lt;appender-ref ref="ConsoleAppender" /&gt;
    &lt;/root&gt;
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Конфигурация через properties-файл:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.debug = false
log4j.rootLogger = DEBUG, ConsoleAppender
# CONSOLE appender customisation
log4j.appender.ConsoleAppender = org.apache.log4j.ConsoleAppender
log4j.appender.ConsoleAppender.encoding = Cp866
log4j.appender.ConsoleAppender.layout = org.apache.log4j.PatternLayout
log4j.appender.ConsoleAppender.layout.ConversionPattern = %d{ISO8601} [%-5p][%-16.16t][%32.32c] - %m%n
# File appender customisation
log4j.appender.FILE=org.apache.log4j.RollingFileAppender
log4j.appender.FILE.File=./target/logging/logging.log
log4j.appender.FILE.MaxFileSize=1MB log4j.appender.FILE.threshold=DEBUG log4j.appender.FILE.MaxBackupIndex=2 log4j.appender.FILE.layout=org.apache.log4j.PatternLayout log4j.appender.FILE.layout.ConversionPattern=[ %-5p] - %c:%L - %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>Принято считать эти два способа равнозначными. При инициализации они ищутся в <strong>classpath</strong>, сначала <strong>xml-файл</strong>, потом <strong>properties-файл</strong>. Так что при наличии обоих рабочим будет именно <strong>xml</strong>.</p>
</div>
<div class="paragraph">
<p>Ниже приведен пример конфигурации <code>log4j.properties</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</code></pre>
</div>
</div>
<div class="paragraph">
<p>Эта строка говорит, что мы регистрируем <strong>appender</strong> <code>CONSOLE</code>, который использует реализацию <code>org.apache.log4j.ConsoleAppender</code>. Этот <strong>appender</strong> записывает данные в консоль.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.appender.FILE=org.apache.log4j.RollingFileAppender</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот <strong>appender</strong> записывает в файл.</p>
</div>
<div class="paragraph">
<p>Когда у нас уже есть зарегистрированные <strong>appenders</strong>, мы можем определить, какой будет уровень логирования в узлах и какие <strong>appenders</strong> будут при этом использоваться.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.rootLogger=DEBUG, CONSOLE, FILE</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>log4j.rootLogger</code> означает, что будем настраивать главный узел, в котором находятся все логи;</p>
</li>
<li>
<p>после знака равно первое слово говорит о том, с каким уровнем и выше будут записываться логи (в нашем случае это <code>DEBUG</code>);</p>
</li>
<li>
<p>далее после запятой указываются все <strong>appenders</strong>, которые будут использоваться.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Чтобы настроить определенный узел логирования, нужно использовать такую запись:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.logger.com.github.romankh3.logginglecture=TRACE, OWN, CONSOLE</code></pre>
</div>
</div>
<div class="paragraph">
<p>где <code>log4j.logger.</code> используется для настройки определенного узла, в нашем случае это <code>com.github.romankh3.logginglecture.</code>.</p>
</div>
<div class="paragraph">
<p>Настройка <code>CONSOLE</code> <strong>appender</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># CONSOLE appender customisation
log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender
log4j.appender.CONSOLE.threshold=DEBUG
log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout
log4j.appender.CONSOLE.layout.ConversionPattern=[%-5p] : %c:%L : %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь видно, что можно задать уровень, с которого будет обрабатывать именно <strong>appender</strong>. Реальная ситуация: сообщение с уровнем <code>info</code> принял узел логирования и передал <strong>appender</strong>, который к нему приписан, а вот уже <strong>appender</strong>, с уровнем <code>warn</code> и выше, лог этот принял, но ничего с ним не сделал.</p>
</div>
<div class="paragraph">
<p>Далее нужно определиться с тем, какой шаблон будет в сообщении (<code>PatternLayout</code>).</p>
</div>
<div class="paragraph">
<p>Пример настройки <code>FILE</code> <strong>appender</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># File appender customisation
log4j.appender.FILE=org.apache.log4j.RollingFileAppender
log4j.appender.FILE.File=./target/logging/logging.log
log4j.appender.FILE.MaxFileSize=1MB
log4j.appender.FILE.threshold=DEBUG
log4j.appender.FILE.MaxBackupIndex=2
log4j.appender.FILE.layout=org.apache.log4j.PatternLayout
log4j.appender.FILE.layout.ConversionPattern=[ %-5p] - %c:%L - %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь можно настроить, в какой именно файл будут записываться логи. Запись идет в файл <code>logging.log</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.appender.FILE.File=./target/logging/logging.log</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы не было проблем с размером файла, можно настроить максимальный: в данном случае — <code>1МБ</code>.</p>
</div>
<div class="paragraph">
<p><code>MaxBackupIndex</code> — говорит о том, сколько будет таких файлов. Если создается больше этого числа, то первый файл будет удален.</p>
</div>
</div>
<div class="sect2">
<h3 id="_использование">Использование</h3>
<div class="paragraph">
<p>Чтобы использовать <code>Logger</code>, необходимо его создать:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(ClassName.class);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы сделать запись в лог, можно использовать множество методов, которые показывают, с каким уровнем будут записи.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(ClassName.class);

    public static void main(String[] args) {
        logger.trace("Method 1 started with argument={}", argument);
        logger.debug("Database updated with script = {}", script);
        logger.info("Application has started on port = {}", port);
        logger.warn("Log4j didn't find log4j.properties.Please, provide them");
        logger.error("Connection refused to host = {}", host);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Также можно использовать метод <code>log()</code> и передать в него параметры.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(ClassName.class);

    public static void main(String[] args) {
        logger.log(Level.INFO, argument);
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_реализация_slf4jlog4j_2logback">Реализация (SLF4J/Log4J 2/Logback)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>На данный момент в <strong>Java</strong> наиболее популярные следующие библиотеки логирования:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>log4j 2</strong></p>
</li>
<li>
<p><strong>Logback</strong></p>
</li>
<li>
<p><strong>SLF4J</strong> (как фасад)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_system_err_println"><code>System.err.println()</code></h3>
<div class="paragraph">
<p>Первоначально был, разумеется, <code>System.err.println()</code> - выводит запись в консоль. Его и сейчас используют для быстрого получения лога при debugging.</p>
</div>
</div>
<div class="sect2">
<h3 id="_log4j_2">Log4j 2</h3>
<div class="paragraph">
<p>Для использования <strong>log4j2</strong> вам необходимо подключить библиотеки <code>log4j-api-2.x</code> и <code>log4j-core-2.x</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
        &lt;version&gt;${log4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
        &lt;version&gt;${log4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Logger создается вызовом статического метода класса <code>org.apache.logging.log4j.Logger</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.apache.logging.log4j.Logger;

public class Program {
    private Logger log = LogManager.getLogger(LoggingLog4j.class);

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Logger</strong> умеет принимать помимо <code>String</code>, <code>Object</code> и <code>Throwable</code> еще два новых типа — <code>MapMessage</code> и <code>Marker</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private Logger log = LogManager.getLogger(LoggingLog4j.class);

    public static void main(String[] args){
        // Карта сообщений (напечатается как msg1="Сообщение 1” msg2="Сообщение 2”)
        MapMessage mapMessage = new MapMessage();
        mapMessage.put("msg1", "Сообщение 1");
        mapMessage.put("msg2", "Сообщение 2");
        // Маркер, объект по которому можно фильтровать сообщения
        Marker marker = MarkerManager.getMarker("fileonly");
        // Строковое сообщение
        String stringMessage = "Сообщение";
        // Строковое сообщение с параметрами
        String stringMessageFormat = "Сообщение {}, от {}";
        // Исключение
        Throwable throwable = new Throwable();
        // Объект
        Object object = new Object();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В классическом для loggers стиле методы делятся на два типа:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>совпадающие с названием уровня логирования</p>
<div class="literalblock">
<div class="content">
<pre>log.info((marker, mapMessage, throwable);
log.throwing(throwable);</pre>
</div>
</div>
</li>
<li>
<p>методы <code>log()</code>, принимающие уровень логирования в качестве параметра.</p>
<div class="literalblock">
<div class="content">
<pre>log.log(Level.INFO, marker, stringMessage, throwable);
log.throwing(Level.INFO, throwable);</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Если не определить конфигурацию, то при запуске <strong>log4j2</strong> выдаст гневное сообщение, о том, что конфигурация не задана и будет печатать сообщения на консоль уровнем не ниже <strong>ERROR</strong>. Конфигурация <strong>log4j2</strong> задается несколькими вариантами: <strong>xml</strong>, <strong>json</strong>, <strong>yaml</strong>. Файл с конфигурацией автоматически ищется <strong>classpath</strong>, должен иметь название <strong>log4j2</strong> и располагаться в пакете по умолчанию.</p>
</div>
<div class="paragraph">
<p>Конфигурация <strong>log4j2</strong> состоит из описания loggers, appenders и filters.</p>
</div>
<div class="paragraph">
<p><strong>Filters</strong> позволяют оценивать события logging, чтобы определить, следует ли их публиковать и каким образом. <strong>Filter</strong> будет вызван одним из своих методов и вернет <strong>Result</strong>, который представляет собой <strong>Enum</strong> имеющий одно из 3 значений:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ACCEPT</code></p>
</li>
<li>
<p><code>DENY</code></p>
</li>
<li>
<p><code>NEUTRAL</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Filters</strong> могут быть сконфигурированы в одном из четырех мест:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Контекстные фильтры</strong><br>
Настраиваются непосредственно в конфигурации. События, отклоняемые этими фильтрами, не будут передаваться регистраторам для дальнейшей обработки. После того как событие было принято контекстным фильтром, оно не будет оцениваться никакими другими контекстными фильтрами, а уровень регистратора не будет использоваться для фильтрации события. Однако событие будет оцениваться фильтрами <strong>Logger</strong> и <strong>Appender</strong>.</p>
</li>
<li>
<p><strong>Фильтры регистратора</strong><br>
Настраиваются на указанном регистраторе. Они оцениваются после контекстных фильтров и уровня журнала для регистратора. События, отклоненные этими фильтрами, будут отброшены, и событие не будет передано родительскому регистратору независимо от параметра аддитивности.</p>
</li>
<li>
<p><strong>Фильтры Appender</strong><br>
Используются для определения того, должен ли конкретный Appender обрабатывать форматирование и публикацию события.</p>
</li>
<li>
<p><strong>Ссылочные фильтры appender</strong><br>
Используются для определения того, должен ли регистратор направлять событие в приложение.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Есть различные фильтра, в том числе и по маркерам:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>BurstFilter</strong> - предоставляет механизм для управления скоростью обработки <strong>LogEvents</strong> путем автоматического отбрасывания событий после достижения максимального предела.</p>
</li>
<li>
<p><strong>CompositeFilter</strong> - предоставляет способ указать несколько фильтров. Он добавляется в конфигурацию в качестве элемента фильтров и содержит другие фильтры для оценки. Элемент <strong>filters</strong> не принимает никаких параметров.</p>
</li>
<li>
<p><strong>DynamicThresholdFilter</strong> - позволяет выполнять фильтрацию по уровню журнала на основе определенных атрибутов.</p>
</li>
<li>
<p><strong>MapFilter</strong> - позволяет фильтровать по элементам данных, которые находятся в MapMessage.</p>
</li>
<li>
<p><strong>MarkerFilter</strong> - сравнивает настроенное значение маркера с параметром маркера, включенным в <strong>LogEvent</strong>. Совпадение происходит, когда имя маркера совпадает с маркером события журнала или одним из его родителей.</p>
</li>
<li>
<p><strong>RegexFilter</strong> - позволяет сравнивать отформатированное или неформатированное сообщение с регулярным выражением.</p>
</li>
<li>
<p><strong>StructuredDataFilter</strong> - это <code>MapFilter</code>, который также позволяет фильтровать по идентификатору события, типу и сообщению.</p>
</li>
<li>
<p><strong>ThreadContextMapFilter</strong> - позволяет выполнять фильтрацию по элементам данных, которые находятся в сопоставлении <strong>ThreadContext</strong>.</p>
</li>
<li>
<p><strong>ThresholdFilter</strong> - возвращает результат <strong>onMatch</strong>, если уровень в <strong>LogEvent</strong> совпадает или более специфичным, чем настроенный уровень, а значение <strong>onMismatch</strong> в противном случае.</p>
</li>
<li>
<p><strong>TimeFilter</strong> - можно использовать для ограничения фильтра только определенной частью дня.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Имеется широкий круг классов appenders, в том числе асинхронные appenders и appenders оборачивающие группу других appenders.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AsyncAppender</strong> - принимает ссылки на другие приложения и заставляет <strong>LogEvents</strong> записываться на них в отдельном потоке.</p>
</li>
<li>
<p><strong>OutputStreamAppender</strong> - предоставляет основу для многих других приложений, таких как приложения <strong>File</strong> и <strong>Socket</strong>, которые записывают событие в выходной поток.</p>
</li>
<li>
<p><strong>ConsoleAppender</strong> - записывает свои выходные данные либо в <code>System.out</code>, либо в <code>System.err</code>, причем <code>System.out</code> является целевым объектом по умолчанию.</p>
</li>
<li>
<p><strong>FileAppender</strong> - это объект <code>OutputStreamAppender</code>, который записывает данные в файл, указанный в параметре fileName.</p>
</li>
<li>
<p><strong>JDBCAppender</strong> - записывает события журнала в таблицу реляционной базы данных с помощью стандартного <code>JDBC</code>.</p>
</li>
<li>
<p><strong>RollingFileAppender</strong> - это объект <code>OutputStreamAppender</code>, который записывает данные в файл, указанный в параметре <strong>fileName</strong>, и переворачивает файл в соответствии с параметрами <strong>TriggeringPolicy</strong> и <strong>RolloverPolicy</strong>.</p>
</li>
<li>
<p><strong>SocketAppender</strong> - это <code>OutputStreamAppender</code>, который записывает свои выходные данные в удаленное место назначения, указанное узлом и портом.</p>
</li>
<li>
<p>И другие.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Стоит также заметить, что <strong>log4j</strong> может создавать множество различающихся appenders одного и того же класса, например несколько файловых appenders, которые пишут в разные файлы. Рассмотрим пример конфигурации, в которой объявлены два logger:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>корневой — которых пишет в файл <code>log.log</code></p>
</li>
<li>
<p>для нашего класса — пишет в <code>log2.log</code> с использованием фильтрации по маркер.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Пример настройки конфигурации <code>log4j.xml</code> файла</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration&gt;
    &lt;!-- Секция appenders --&gt;
    &lt;Appenders&gt;
        &lt;!-- Файловый appender --&gt;
        &lt;File name="file" fileName="log.log"&gt;
            &lt;PatternLayout&gt;
                &lt;Pattern&gt;%d %p %c{1.} [%t] %m %ex%n&lt;/Pattern&gt;
            &lt;/PatternLayout&gt;
        &lt;/File&gt;
        &lt;!-- Файловый appender --&gt;
        &lt;File name="file2" fileName="log2.log"&gt;
            &lt;!-- Фильтр по маркеру --&gt;
            &lt;MarkerFilter marker="fileonly" onMatch="DENY" onMismatch="ACCEPT"/&gt;
            &lt;PatternLayout&gt;
                &lt;Pattern&gt;%d %p %c{1.} [%t] %m %ex%n&lt;/Pattern&gt;
            &lt;/PatternLayout&gt;
        &lt;/File&gt;
    &lt;/Appenders&gt;
    &lt;!-- Секция loggers --&gt;
    &lt;Loggers&gt;
        &lt;!-- Корневой logger --&gt;
        &lt;Root level="trace"&gt;
            &lt;AppenderRef ref="file" level="DEBUG"/&gt;
        &lt;/Root&gt;
        &lt;!-- Logger нашего класса --&gt;
        &lt;Logger name="logging.log4j.LoggingLog4j" level="info" additivity="false"&gt;
            &lt;AppenderRef ref="file2" level="INFO"/&gt;
        &lt;/Logger&gt;
    &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_logback">Logback</h3>
<div class="paragraph">
<p>Данный фреймворк используется только в связке с оберткой <strong>SLF4J</strong>.</p>
</div>
<div class="paragraph">
<p>Добавляется следующей зависимостью:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
    &lt;version&gt;1.2.6&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(LoggingLogback.class);

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>API позволяет выводить строковые сообщения, шаблоны строковых сообщений, исключения, а также использовать маркеры.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Program {
    private org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(LoggingLogback.class);

    public static void main(String[] args) {
        // Строковое сообщение
        String stringMessage = "Сообщение";
        // Шаблон сообщения
        String stringMessageFormat = "Сообщение {} {}";
        // Ошибка
        Throwable throwable = new Throwable();
        // Маркер
        Marker marker = MarkerFactory.getMarker("marker");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Конфигурация ищется в <strong>classpath</strong> в следующем порядке:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Пытается найти <code>logback.groovy</code></p>
</li>
<li>
<p>Иначе пытается найти <code>logback-test.xml</code></p>
</li>
<li>
<p>Иначе пытается найти <code>logback.xml</code></p>
</li>
<li>
<p>Иначе использует базовую конфигурацию — выводим сообщения на консоль</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Основными элементами конфигурации являются <strong>loggers</strong>, <strong>appenders</strong>, <strong>layout</strong>, и <strong>filters</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Logback-classic</strong> предлагает два типа фильтров:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>обычные фильтры</p>
</li>
<li>
<p>турбофильтры</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Имеются следующие фильтры:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Regular filters</strong></p>
</li>
<li>
<p><strong>LevelFilter</strong> - фильтрует события на основе точного соответствия уровней.</p>
</li>
<li>
<p><strong>ThresholdFilter</strong> - фильтрует события ниже указанного порогового значения.</p>
</li>
<li>
<p><strong>EvaluatorFilter</strong> - это универсальный фильтр, инкапсулирующий. Как следует из названия, <strong>EventEvaluator</strong> оценивает, соответствует ли заданный критерий для данного события.</p>
</li>
<li>
<p><strong>Matchers</strong></p>
</li>
<li>
<p><strong>CountingFilter</strong></p>
</li>
<li>
<p><strong>TurboFilters</strong> - предназначены для высокопроизводительной фильтрации регистрирования событий еще до их создания.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Имеются следующие appenders:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OutputStreamAppender</strong></p>
</li>
<li>
<p><strong>ConsoleAppender</strong></p>
</li>
<li>
<p><strong>FileAppender</strong></p>
</li>
<li>
<p><strong>RollingFileAppender</strong></p>
</li>
<li>
<p><strong>SocketAppender</strong> и <strong>SSLSocketAppender</strong></p>
</li>
<li>
<p><strong>ServerSocketAppender</strong> и <strong>SSLServerSocketAppender</strong></p>
</li>
<li>
<p><strong>SMTPAppender</strong></p>
</li>
<li>
<p><strong>SyslogAppender</strong></p>
</li>
<li>
<p><strong>SiftingAppender</strong></p>
</li>
<li>
<p><strong>AsyncAppender</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Encoders</strong> (кодировщики) отвечают за преобразование входящего события в массив байтов и запись результирующего массива байтов в соответствующий массив. Таким образом, кодировщики имеют полный контроль над тем, что и когда записываются в <strong>appender</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Layouts</strong>  — это компоненты, отвечающие за преобразование входящего события в строку. Метод в интерфейсе <strong>Layout</strong> принимает объект, представляющий событие (любого типа), и возвращает объект <code>String</code>.</p>
</div>
<div class="listingblock">
<div class="title">Простой пример файла <code>logback.xml</code>:</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;!--Аппендеры --&gt;
    &lt;!--Файловый appender --&gt;
    &lt;appender name="file" class="ch.qos.logback.core.FileAppender"&gt;
        &lt;file&gt;log.log&lt;/file&gt;
        &lt;layout class="ch.qos.logback.classic.PatternLayout"&gt;
            &lt;Pattern&gt;%date %level [%thread] %logger{10} [%file:%line] %msg%n&lt;/Pattern&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;!--Консольный appender --&gt;
    &lt;appender name="sout" class="ch.qos.logback.core.ConsoleAppender"&gt;
        &lt;layout class="ch.qos.logback.classic.PatternLayout"&gt;
            &lt;Pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/Pattern&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;!-- Фильтры --&gt;
    &lt;!-- Фильтр по маркеру --&gt;
    &lt;turboFilter class="ch.qos.logback.classic.turbo.MarkerFilter"&gt;
        &lt;Marker&gt;marker&lt;/Marker&gt;
        &lt;OnMatch&gt;DENY&lt;/OnMatch&gt;
    &lt;/turboFilter&gt;
    &lt;!-- Loggers --&gt;
    &lt;!-- Корневой logger --&gt;
    &lt;root level="info"&gt;
        &lt;appender-ref ref="file" /&gt;
    &lt;/root&gt;
    &lt;!-- Logger нашего класса --&gt;
    &lt;logger name="logging.logback.LoggingLogback" level="info" &gt;
        &lt;appender-ref ref="sout" /&gt;
    &lt;/logger&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_slf4j">SLF4J</h3>
<div class="paragraph">
<p><strong>SLF4J</strong> является оберткой над <strong>logback</strong>, а также над <strong>JUL</strong>, <strong>log4j</strong>, или <strong>JCL</strong>, а также над любым logger, который реализует ее интерфейс. Для работы с <strong>SLF4J</strong> нужны библиотека <code>slf4j-api-1.x.x</code> и реализация одного из loggers либо заглушка. Как правило, реализации всех loggers (кроме <strong>logback</strong>) поставляются вместе с SLF4J и имеют названия на подобии <code>slf4j-jcl-1.x</code>, <code>slf4j-log4j12-1.x</code>, <code>slf4j-nop-1.x</code> и т.п. Если в <strong>classpath</strong> не будет найдена реализация logger (или заглушка <strong>nop</strong>) <strong>SLF4J</strong> гневно ругнется и работать откажется. Конфигурация соответственно будет искаться в зависимости от положенной в <strong>classpath</strong> реализации.</p>
</div>
<div class="paragraph">
<p>Вся обертка делится на две части:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>API</strong><br>
Используется приложениями</p>
</li>
<li>
<p><strong>Реализация logger</strong>
Представлена отдельными jar-файлами для каждого вида логирования. Такие реализации для <strong>slf4j</strong> называются <strong>binding</strong>. Например, <code>slf4j-log4j12</code> или <code>logback-classic</code>. Достаточно только положить в <strong>CLASSPATH</strong> нужный <strong>binding</strong> и весь код проекта и все используемые библиотеки (при условии, что они обращаются к <strong>SLF4J</strong>) будут выполнять logging в нужном направлении.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>API SLF4J</strong> было рассмотрено в реализации <strong>logback</strong>.</p>
</div>
<div class="paragraph">
<p>Чтобы использовать <strong>SLF4J</strong> вместе с <strong>log4j 2</strong> необходимо подключить зависимость:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_links">Links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://javarush.ru/groups/posts/2388-logirovanie-chto-kak-gde-i-chem">Логирование: что, как, где и чем?</a></p>
</li>
<li>
<p><a href="https://javarush.ru/groups/posts/2293-zachem-nuzhno-logirovanie">Зачем нужно логирование</a></p>
</li>
<li>
<p><a href="https://javarush.ru/quests/lectures/questcollections.level04.lecture09">Logger</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/113145/">Java Logging: история кошмара</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/247647/">Java logging. Hello World</a></p>
</li>
<li>
<p><a href="https://github.com/qcha/JBook/blob/master/other/logging.md">Логирование в Java</a></p>
</li>
<li>
<p><a href="https://codernet.ru/articles/drugoe/logirovanie_java_terminologiya_urovni_logirovaniya_log-fajlyi/">Логирование Java: терминология, уровни логирования, log-файлы</a></p>
</li>
<li>
<p><a href="https://coderlessons.com/tutorials/java-tekhnologii/vyuchi-slf4j/slf4j-kratkoe-rukovodstvo">SLF4J — Краткое руководство</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=j-i3NQiKbcc&amp;t=2052s&amp;ab_channel=JUG.ru">Владимир Красильщик — Что надо знать о логировании прагматичному Java-программисту</a></p>
</li>
<li>
<p><a href="http://logging.apache.org/log4j/2.x/">Apache Log4j 2</a></p>
</li>
<li>
<p><a href="http://logback.qos.ch/">Logback</a></p>
</li>
<li>
<p><a href="http://www.slf4j.org//">Simple Logging Facade for Java (SLF4J)</a></p>
</li>
<li>
<p><a href="http://skipy.ru/useful/logging.html#log4j_fa">Ведение лога приложения</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-12-06 11:43:24 UTC
</div>
</div>
</body>
</html>