<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Java Tools</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Java Tools</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_junit">JUnit</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_введение">Введение</h3>
<div class="paragraph">
<p><strong>Тестирование</strong> – это процесс проверки функционала программы с целью подтверждения того, что она работает в соответствии с определёнными требованиями. Unit-тестирование – это тестирование, которые пишутся, непосредственно, на уровне разработчика (тестирование определённой сущности – метод или класс). Это крайне важный этап разработки ПО, который помогает создавать качественный продукт.</p>
</div>
<div class="paragraph">
<p><strong>Юнит-тестирование</strong> делится на две большие группы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ручное тестирование</p>
</li>
<li>
<p>Автоматизированное тестирование</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ручное тестирование</th>
<th class="tableblock halign-left valign-top">Автоматизированное тестирование</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ручное выполнение тестов без помощи каких-либо средств.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Использование специальных средств для автоматизированного тестирования</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Не программируется</p>
<p class="tableblock">Нет возможности для написания сложных тестов для тестирования сложных моделей поведения.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Программируется</p>
<p class="tableblock">Тестировщики могут написать сложные тесты для тестирования сложных моделей программирования</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Низкая надёжность</p>
<p class="tableblock">Ручное тестирование имеет низкую надёжность, так как крайне подвержено влиянию человеческого фактора.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Высокая надёжность</p>
<p class="tableblock">Автоматизированное тестирование точное и надёжное.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Большие затраты времени</p>
<p class="tableblock">Связано с тем, что человек имеет крайне ограниченные возможность в скорости работы.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Быстро</p>
<p class="tableblock">Автоматизированные тесты выполняются на порядок быстрее, чем это может сделать человек.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_junit_2">JUnit</h4>
<div class="paragraph">
<p><strong>JUnit</strong> – это фреймворк, разработанный для тестирования программ, написанных с использованием технологии <strong>Java</strong>. Он лежит в основе <strong>TDD</strong> (<strong>Test-Driven Development</strong>) и входит в семейство фрейморков для тестирования xUnit.</p>
</div>
<div class="paragraph">
<p>Главная идея данного фреймворка – “сначала тесты, потом код”. Это означает, что сначала мы определяем, что должно получиться в результате работы того или иного куска кода и пишем тесты, которые проверяют идентичность результата с требуемым, после чего пишем сам кусок кода, который и будем тестировать. Данный подход увеличивает эффективность работы разработчика и позволяет писать более стабильный код. В результате этого мы получаем меньшее количество времени, которое затрачивается на отладку программы.</p>
</div>
</div>
<div class="sect3">
<h4 id="_свойства_junit">Свойства JUnit</h4>
<div class="ulist">
<ul>
<li>
<p>Фреймворк с открытым исходным кодом, который используется для написания и выполнения тестов.</p>
</li>
<li>
<p>Позволяет писать код более быстро и качественно.</p>
</li>
<li>
<p>Крайне прост в использовании.</p>
</li>
<li>
<p>Поддерживает аннотации для идентификации методов.</p>
</li>
<li>
<p>Поддерживает утверждения для тестирования получаемых результатов.</p>
</li>
<li>
<p>Тесты могут быть организованы  в связки тестов (<strong>test suites</strong>).</p>
</li>
<li>
<p>Имеет визуальную индикацию состояния тестов (красные – не пройдены, зелёные – пройдены).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_тестовый_случай">Тестовый случай</h4>
<div class="paragraph">
<p><strong>Тестовый случай</strong> (Test Case) в <strong>юнит тестировании</strong> – это часть кода, которая проверяет, что другая часть кода  (в частности – метод) работает в соответствии с определёнными требованиями.</p>
</div>
<div class="paragraph">
<p>Формально описанный тестовый случай характеризуется известными входными данными и ожидаемым выводом программы, который известен до начала выполнения теста.</p>
</div>
<div class="paragraph">
<p>Необходимо создавать, как минимум, два тестовых случая для каждого требования – положительный и отрицательный. Если требование имеет под требования, каждое из них должно тестироваться отдельно.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_junit_5">JUnit 5</h3>
<div class="paragraph">
<p><strong>JUnit 5</strong> требует <strong>Java 8</strong> (или выше) во время выполнения. Однако вы все равно можете протестировать код, скомпилированный с предыдущими версиями <strong>JDK</strong>.</p>
</div>
<div class="paragraph">
<p>В отличие от предыдущих версий <strong>JUnit</strong>, <strong>JUnit 5</strong> состоит из нескольких разных модулей из трех разных подпроектов.</p>
</div>
<div class="paragraph">
<p><strong>JUnit 5</strong> = <strong>Platform JUnit</strong> + <strong>JUnit Jupiter</strong> + <strong>JUnit Vintage</strong></p>
</div>
<div class="paragraph">
<p><strong>JUnit платформа</strong> служит основой для запуска тестирования рамок на <strong>JVM</strong>. Он также определяет <strong>TestEngineAPI</strong> для разработки инфраструктуры тестирования, работающей на платформе. Кроме того, платформа предоставляет средство запуска консоли для запуска платформы из командной строки и средство запуска на основе <strong>JUnit 4</strong> для запуска любого <strong>TestEngine</strong> на платформе в среде на основе <strong>JUnit 4</strong>. Первоклассная поддержка <strong>платформы JUnit</strong> также существует в популярных <strong>IDE</strong> (см. <strong>IntelliJ IDEA</strong>, <strong>Eclipse</strong>, <strong>NetBeans</strong> и <strong>код Visual Studio</strong>) и инструментах сборки (см. <strong>Gradle</strong>, <strong>Maven</strong> и <strong>Ant</strong>).</p>
</div>
<div class="paragraph">
<p><strong>JUnit Jupiter</strong> является сочетанием новой модели программирования и модели расширения для написания тестов и расширений в <strong>JUnit 5</strong>. Jupiter подпроекте обеспечивает <strong>TestEngine</strong> для выполнения тестов на основе <strong>Jupiter</strong> на платформе.</p>
</div>
<div class="paragraph">
<p><strong>JUnit Vintage</strong> обеспечивает <strong>TestEngine</strong> запуск тестов на основе <strong>JUnit 3</strong> и <strong>JUnit 4</strong> на платформе.</p>
</div>
<div class="paragraph">
<p>Получать помощь, а также задайте вопросы, связанные с <strong>JUnit 5</strong> можно на <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://stackoverflow.com/questions/tagged/junit5"><strong>Stack Overflow</strong></a> или пообщайтесь с нами в <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://gitter.im/junit-team/junit5"><strong>Gitter</strong></a>.</p>
</div>
<div class="paragraph">
<p>В <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples"><strong>junit5-samples</strong></a> репозитории размещена коллекция примеров проектов, основанных на <strong>JUnit Jupiter</strong>, <strong>JUnit Vintage</strong> и других средах тестирования. Вы найдете подходящие сценарии сборки.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Для <strong>Gradle</strong> и <strong>Java</strong> ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-gradle"><strong>junit5-jupiter-starter-gradle</strong></a> проектом.</p>
</li>
<li>
<p>Для <strong>Gradle</strong> и <strong>Kotlin</strong> ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-gradle-kotlin"><strong>junit5-jupiter-starter-gradle-kotlin</strong></a> проектом.</p>
</li>
<li>
<p>Для <strong>Gradle</strong> и <strong>Groovy</strong> ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-gradle-groovy"><strong>junit5-jupiter-starter-gradle-groovy</strong></a> проектом.</p>
</li>
<li>
<p>Для <strong>Maven</strong> проверьте <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-maven"><strong>junit5-jupiter-starter-maven</strong></a> проект.</p>
</li>
<li>
<p>Что касается <strong>Ant</strong>, ознакомьтесь с <a href="https://translate.google.com/website?sl=en&amp;tl=ru&amp;ajax=1&amp;elem=1&amp;se=1&amp;u=https://github.com/junit-team/junit5-samples/tree/r5.7.2/junit5-jupiter-starter-ant"><strong>junit5-jupiter-starter-ant</strong></a> проектом.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_аннотации">Аннотации</h4>
<div class="paragraph">
<p><strong>JUnit Jupiter</strong> поддерживает следующие аннотации для настройки тестов и расширения фреймворка.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Аннотация</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Свойство</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является методом тестирования. В отличие от аннотации <strong>JUnit 4</strong>, эта аннотация не объявляет никаких атрибутов, так как тестовые расширения в JUnit Jupiter работают на основе собственных специальных аннотаций. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ParameterizedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является параметризированным тестом. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RepeatedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является тестовым шаблоном для повторного теста. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestFactory</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является испытательным заводом для динамических тестов. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestTemplate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что метод является шаблоном для тестовых случаев, предназначенных для вызова несколько раз в зависимости от количества контекстов вызова, возвращенных зарегистрированными поставщиками. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestMethodOrder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для настройки порядка выполнения тестового метода для аннотированного тестового класса; похож на <strong>JUnit 4&#8217;s</strong>. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestInstance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для настройки жизненного цикла экземпляра теста для аннотированного тестового класса. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DisplayName</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Объявляет пользовательское имя дисплея для тестового класса или метода тестирования. Такие аннотации не наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DisplayNameGeneration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Объявляет пользовательский генератор имен отображения для тестового класса. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeEach</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен перед каждым, или методом в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterEach</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен после каждого, или метода в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются, если они не переопределены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeAll</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен прежде всего, и методы в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются (если они не скрыты или переопределены)и должны быть (если не используется жизненный цикл "в каждом классе" экземпляра теста).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterAll</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный метод должен быть выполнен в конце концов, и методы в текущем классе; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие методы наследуются (если они не скрыты или переопределены)и должны быть (если не используется жизненный цикл "в каждом классе" экземпляра теста).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Nested</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Означает, что аннотированный класс является нестатичным вложенным тестовым классом. и методы не могут быть использованы непосредственно в тестовом классе, если не используется жизненный цикл экземпляра теста "на класс". Такие аннотации не наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Tag</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для объявления тегов для фильтрации тестов, либо на уровне класса или метода; аналогично тестовым группам в <strong>TestNG</strong> или <strong>Categories</strong> в <strong>JUnit 4.</strong> Такие аннотации наследуются на уровне класса, но не на уровне метода.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Disabled</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для отключения тестового класса или метода тестирования; по аналогии с <strong>JUnit 4&#8217;s</strong>. Такие аннотации не наследуются.@Ignore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для неудачи теста, испытательного завода, шаблона тестирования или метода жизненного цикла, если его выполнение превышает данный срок. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ExtendWith</code> (<strong>JUnit5</strong>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для регистрации расширений декларативно. Такие аннотации наследуются.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RegisterExtension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для регистрации расширений программно через поля. Такие поля наследуются, если они не затенены.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TempDir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Используется для поставки временного каталога с помощью инъекций поля или инъекций параметра в метод жизненного цикла или метод тестирования; расположен в пакете <code>org.junit.jupiter.api.io</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Все основные аннотации находятся в <a href="https://junit-org.translate.goog/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/package-summary.html?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=ajax,elem,se"><strong>org.junit.jupiter.api</strong></a> пакете в <strong>junit-jupiter-api</strong> модуле.</p>
</div>
</div>
<div class="sect3">
<h4 id="_утверждения">Утверждения</h4>
<div class="paragraph">
<p><strong>JUnit 5</strong> поставляется со многими стандартными утверждениями, которые можно найти в классе <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/Assertions.html"><strong>org.junit.jupiter.api.Assertions</strong>.</a></p>
</div>
<div class="paragraph">
<p>Основные утверждения:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>assertEquals()</code>,</p>
</li>
<li>
<p><code>assertArrayEquals()</code>,</p>
</li>
<li>
<p><code>assertSame()</code>,</p>
</li>
<li>
<p><code>assertNotSame()</code>,</p>
</li>
<li>
<p><code>assertTrue()</code>,</p>
</li>
<li>
<p><code>assertFalse()</code>,</p>
</li>
<li>
<p><code>assertNull()</code>,</p>
</li>
<li>
<p><code>assertNotNull()</code>,</p>
</li>
<li>
<p><code>assertLinesMatch()</code>,</p>
</li>
<li>
<p><code>assertIterablesMatch()</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mockito">Mockito</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_mockito_что_это_такое_и_зачем_нужно">Mockito: что это такое и зачем нужно</h3>
<div class="paragraph">
<p>Говоря коротко, <strong>Mockito</strong> – фреймворк для работы с заглушками.</p>
</div>
<div class="paragraph">
<p>Как известно, при <strong>тестировании кода</strong> (прежде всего <strong>юнит-тестировании</strong>, но не только) тестируемому элементу часто требуется предоставить экземпляры классов, которыми он должен пользоваться при работе.
При этом часто они не должны быть <strong>полнофункциональными</strong> – наоборот, от них требуется вести себя <strong>жёстко заданным образом</strong>, так, чтобы их поведение было <strong>простым и полностью предсказуемым</strong>.
Они и называются <strong>заглушками</strong> (<strong>stub</strong>).
Чтобы их получить, можно создавать альтернативные тестовые реализации интерфейсов, наследовать нужные классы с переопределением функционала и так далее, но всё это достаточно неудобно, избыточно и чревато ошибками.
Более удобное во всех смыслах решение – <strong>специализированные фреймворки</strong> для создания заглушек.
Одним из таковых (и, пожалуй, самым известным для <strong>Java</strong>) и является <strong>Mockito</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Mockito</strong> позволяет создать одной строчкой кода так называемый <strong>mock</strong> (что-то вроде основы для нужной заглушки) любого класса.
Для такого <strong>mock</strong> сразу после создания характерно некое поведение по умолчанию (<strong>все методы возвращают заранее известные значения</strong> — обычно это <strong>null</strong> либо <strong>0</strong>).
Можно переопределить это поведение желаемым образом, проконтролировать с нужной степенью детальности обращения к ним так далее.
В результате <strong>mock</strong> и становится заглушкой с требуемыми свойствами.</p>
</div>
<div class="paragraph">
<p>Также <strong>mock</strong> можно создать и для тех классов, новый экземпляр которых вообще-то так просто не создашь, в частности, классов с исключительно приватными конструкторами типа <strong>синглтонов</strong> и <strong>утилитных классов</strong>, а при минимальной настройке фреймворка — и перечислений (<strong>enums</strong>).</p>
</div>
<div class="paragraph">
<p>Наибольшее распространение получили следующие возможности <strong>Mockito</strong> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>создание заглушек для классов и интерфейсов;</p>
</li>
<li>
<p>проверка вызова метода и значений передаваемых методу параметров;</p>
</li>
<li>
<p>использование концепции «частичной заглушки», при которой заглушка создается на класс с определением поведения, требуемое для некоторых методов класса;</p>
</li>
<li>
<p>подключение к реальному классу «шпиона» spy для контроля вызова методов.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_mock_и_spy">Mock и Spy</h3>
<div class="paragraph">
<p>Центральный класс <strong>Mockito</strong>, через который предполагается обращаться к большей части функционала, — это, собственно, класс под названием <strong>Mockito</strong> (есть также класс <strong>BDDMockito</strong>, предоставляющий примерно те же возможности в форме, более подходящей для <a href="https://ru.wikipedia.org/wiki/BDD_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)"><strong>BDD</strong></a>.
Доступ к функционалу реализован через его <strong>статические методы</strong>.</p>
</div>
<div class="paragraph">
<p>Помните, что методы <strong>mock</strong> объекта возвращают значения по умолчанию: <strong>false</strong> для <strong>boolean</strong>, <strong>0</strong> для <strong>int</strong>, <strong>пустые коллекции</strong>, <strong>null</strong> для остальных объектов.
Для <strong>spy</strong> — значение, возвращаемое методом реального объекта.</p>
</div>
<div class="paragraph">
<p>Для того, чтобы отличить mock-объект от обычного в составе <strong>Mockito</strong> для этого есть инструмент — <strong>метод Mockito.mockingDetails</strong>.
Передав ему произвольный объект, получим объект класса <strong>MockingDetails</strong>.
Он содержит информацию о том, что этот объект представляет собой с точки зрения <strong>Mockito</strong>: является ли он <strong>mock</strong>, <strong>spy</strong> (см. ниже), как использовался, как был создан и прочее.</p>
</div>
<div class="paragraph">
<p>Поведение по умолчанию (и не только его) можно изменить при помощи функционала класса <strong>MockSettings</strong>, но это нечасто бывает нужно.</p>
</div>
<div class="paragraph">
<p>Чтобы создать <strong>Mockito</strong> объект можно использовать либо аннотацию <strong>@Mock</strong>, либо <strong>метод</strong> <strong>mock</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Mock
ICalculator mcalc;

ICalculator mcalc = Mockito.mock(ICalculator.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Однако, что если необходимо использовать в качестве заглушки объект реального класса с имеющимся функционалом, переопределив работу только части его методов?
На этот случай в <strong>Mockito</strong> есть так называемые <strong>spy</strong>, "шпионы".
В отличие от <strong>mock&#8217;ов</strong>, их можно создавать на основе как класса, так и готового объекта.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DataService dataServiceSpy = Mockito.spy(DataService.class);
// or
DataService dataService = new DataService();
dataServiceSpy = Mockito.spy(dataService);</code></pre>
</div>
</div>
<div class="paragraph">
<p>При создании <strong>spy</strong> на основе класса, если его тип — интерфейс, будет создан обычный <strong>mock-объект</strong>, а если тип — класс, то <strong>Mockito</strong> попытается создать экземпляр при помощи конструктора по умолчанию (без параметров).
И только если такого конструктора нет, произойдёт ошибка и тест не сработает.</p>
</div>
</div>
<div class="sect2">
<h3 id="_управление_поведением">Управление поведением</h3>
<div class="paragraph">
<p>В целом управление поведением <strong>mock-объекта</strong> сводится к одной очевидной концепции: когда на mock так-то воздействовали (то есть вызван такой-то метод с такими-то аргументами), он должен отреагировать так-то и так-то.
У этой концепции существуют две реализации в рамках класса <strong>Mockito</strong> — основная, рекомендуемая разработчиками к использованию везде, где это возможно, и альтернативная, применяемая там, где основная не годится.</p>
</div>
<div class="paragraph">
<p>Основная реализация базируется на методе <strong>Mockito.when</strong>.
Этот метод принимает в качестве "параметра" вызов переопределяемого метода <strong>mock-объекта</strong> (таким образом фиксируется определяемое воздействие) и возвращает объект типа <strong>OngoingStubbing</strong>, позволяющий вызвать один из методов семейства <strong>Mockito.then</strong>&#8230;&#8203; (так задаётся реакция на это воздействие).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">//when(mock).thenReturn(value)

public interface DataService {
    void saveData(List&lt;String&gt; dataToSave);
    String getDataById(String id);
    String getDataById(String id, Supplier&lt;String&gt; calculateIfAbsent);
    List&lt;String&gt; getData();
    List&lt;String&gt; getDataListByIds(List&lt;String&gt; idList);
    List&lt;String&gt; getDataByRequest(DataSearchRequest request);
}
-----------------------------------------
List&lt;String&gt; data = new ArrayList&lt;&gt;();
data.add("dataItem");
Mockito.when(dataService.getAllData()).thenReturn(data);</code></pre>
</div>
</div>
<div class="paragraph">
<p>После этой операции, вызвав у объекта dataService метод getAllData(), получим объект, data.</p>
</div>
<div class="paragraph">
<p>Альтернативная реализация связывания условия и результата вызова — методы семейства <strong>Mockito.do</strong>&#8230;&#8203;. Эти методы позволяют задать поведение начиная с результата вызова и возвращают объект класса <strong>Stubber</strong>, уже при помощи которого можно задать условие.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">//doReturn(value).when(mock).method(params)

public interface DataService {
    List&lt;String&gt; getData();
}
-----------------------------------------
List&lt;String&gt; data = new ArrayList&lt;&gt;();
data.add("dataItem");
Mockito.doReturn(data).when(dataService).getData()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание: в первой реализации при задании поведения метода (в данном случае <strong>getAllData()</strong>) сначала выполняется вызов ещё не переопределённой его версии, и только потом, в недрах <strong>Mockito</strong>, происходит переопределение.
Во второй же такого вызова не происходит — методу <strong>Stubber.when</strong> передаётся непосредственно <strong>mock</strong>, а уже у возвращённого этим методом объекта того же типа, но другой природы совершается вызов переопределяемого метода.
Эта разница всё и определяет.
Связывание через <strong>Mockito.do&#8230;&#8203;</strong> никак не контролирует на стадии компиляции то, какой переопределяемый метод я вызову и совместим ли он по типу с заданным возвращаемым значением.</p>
</div>
<div class="sect3">
<h4 id="_задание_условий_вызова">Задание условий вызова</h4>
<div class="paragraph">
<p>Пример выше касается метода без параметров, и связанное с ним условие вызова возможно одно — сам факт вызова.
Как только появляются параметры, ситуация становится сложнее.
Как минимум, для вызова метода, поведение которого я задаю, мне нужно что-то ему передать.
Но важнее другое: может оказаться, что задаваемую реакцию я хочу получать не всегда, а только при вызове с параметрами, отвечающими определённым требованиям.
Если нужно задать реакцию на любой вызов этого метода независимо от аргументов, можно воспользоваться методом <strong>Mockito.any</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface DataService {
    String getDataItemById(String id);
-----------------------------------------
Mockito.when(dataService.getDataItemById(any()))
       .thenReturn("dataItem");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если же требуется, чтобы <strong>mock</strong> реагировал только на определённое значение аргумента, можно использовать непосредственно это значение или методы <strong>Mockito.eq</strong> (когда речь об эквивалентности) либо <strong>Mockito.same</strong> (когда требуется сравнение ссылок)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mockito.when(dataService.getDataItemById("idValue"))
       .thenReturn("dataItem");
// or
Mockito.when(dataService.getDataItemById(Mockito.eq("idValue")))
       .thenReturn("dataItem");</code></pre>
</div>
</div>
<div class="paragraph">
<p>При работе с методами с более чем одним аргументом заданные требования комбинируются в соответствии с логическим И, то есть для получения заданного результата КАЖДЫЙ из аргументов должен отвечать поставленному требованию.</p>
</div>
<div class="paragraph">
<p>Кроме того, при задании поведения такого метода нельзя комбинировать использующие матчеры статические методы Mockito и прямую передачу значений.
Используйте <strong>Mockito.eq</strong> или Mockito.same</p>
</div>
</div>
<div class="sect3">
<h4 id="_задание_результатов_вызова">Задание результатов вызова</h4>
<div class="paragraph">
<p>После того, как метод <strong>mock-объекта</strong> вызван, объект должен отреагировать на вызов.
Основные возможные последствия — возвращение результата и выбрасывание исключения, и именно на эти варианты в первую очередь рассчитан инструментарий <strong>Mockito</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mockito.when(dataService.getAllData()).thenReturn(data);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Также</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mockito.when(dataService.getDataById("invalidId"))
       .thenThrow(new IllegalArgumentException());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Есть и другой способ: можно создать объект исключения и бросить непосредственно его, а можно предоставить <strong>Mockito</strong> только класс исключения, чтобы оно было создано автоматически.
В обоих случаях синтаксис позволяет использовать и <strong>checked</strong> исключения, однако <strong>Mockito</strong> не позволит запустить такой тест, если тип исключения не соответствует методу, который я хочу заставить бросить это исключение.</p>
</div>
<div class="paragraph">
<p>Выше варианты реакции подходят, если в ответ на вызов с заданными условиями нужно всегда возвращать определённое, всегда одно и то же значение результата или выбрасывать всегда одинаковое исключение.
Предположим, метод принимает коллекцию значений, а возвращает другую коллекцию значений, связанных с первыми одно к одному (например, это получение коллекции объектов данных по набору их ID), и в рамках теста необходимо использовать этот <strong>mock-объект</strong> неоднократно с разными наборами входных данных, получая каждый раз соответствующий результат.
В Mockito есть метод <strong>Mockito.thenAnswer</strong>, он же <strong>Mockito.then</strong>.
Он принимает реализацию функционального интерфейса <strong>Answer</strong>, единственный метод которого получает объект <strong>класса InvocationOnMock</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mockito.when(dataService.getDataByIds(Mockito.any()))
       .thenAnswer(invocation -&gt; invocation
                .&lt;List&lt;String&gt;&gt;getArgument(0).stream()
                .map(id -&gt; {
                    switch (id) {
                        case "a":
                            return "dataItemA";
                        case "b":
                            return "dataItemB";
                        default:
                            return null;
                    }
                })
                .collect(Collectors.toList()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание: типобезопасности <strong>InvocationOnMock</strong> не обеспечивает — аргументы возвращаются либо в виде массива <strong>Object[]</strong>, либо <strong>generic</strong>-методом.</p>
</div>
<div class="paragraph">
<p>Отдельно стоит упомянуть ещё один вариант реакции — <strong>thenCallRealMethod</strong>.
Предназначение понятно из названия.
Он действует как для <strong>mock</strong>-, так и для <strong>spy</strong>-объектов.
В случае <strong>mock</strong> все поля объекта, к которым может обратиться код метода, будут опять-таки иметь значение <strong>null</strong>.
Для <strong>spy</strong> же использование <strong>thenCallRealMethod</strong> означает возвращение к поведению <strong>spy</strong> по умолчанию.</p>
</div>
<div class="paragraph">
<p>Методы <strong>thenReturn</strong> и <strong>thenThrow</strong> имеют перегруженные версии, принимающие <strong>varargs</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mockito.when(dataService.getDataById("a"))
       .thenReturn("valueA1", "valueA2")
       .thenThrow(IllegalArgumentException.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь первый вызов метода с заданным параметром вернёт "valueA1, второй — "valueA2, а третий (и все последующие) будет вызывать выбрасывание <strong>IllegalArgumentException</strong>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_слежение_за_вызовами_методов">Слежение за вызовами методов</h3>
<div class="paragraph">
<p>Метод <strong>verify</strong> позволяет проверить, была ли выполнена проверка с определенными параметрами.
Если проверка не выполнялась или выполнялась с другими параметрами, то <strong>verify</strong> вызовет исключение.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mockito.verify(dataService).getDataById(Mockito.any());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Тест с такой конструкцией пройдёт успешно, если она находится после единственного за время выполнения теста вызова метода <strong>getDataById</strong>, и упадёт, если метод не был вызван или был вызван дважды и более.</p>
</div>
<div class="paragraph">
<p>Для проверки количества вызовов определенных методов Mockito предоставляет следующие методы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>atLeast(int min) - не меньше min вызовов;</p>
</li>
<li>
<p>atLeastOnce() - хотя бы один вызов;</p>
</li>
<li>
<p>atMost(int max) - не более max вызовов;</p>
</li>
<li>
<p>times(int cnt) - cnt вызовов;</p>
</li>
<li>
<p>never() - вызовов не было;</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Mockito.verify(dataService, Mockito.times(1)).getDataById(Mockito.any());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mock_объекты_как_значения_полей_и_аннотации_mockito">Mock-объекты как значения полей и аннотации Mockito</h3>
<div class="paragraph">
<p>Если в классе теста есть поля, которым я хочу присвоить <strong>mock-объекты</strong> в качестве значений, это не обязательно делать вручную — достаточно снабдить его аннотацией <strong>@Mock</strong>.</p>
</div>
<div class="paragraph">
<p>Для <strong>spy</strong> предусмотрена аннотация <strong>@Spy</strong> — она в целом аналогична <strong>@Mock</strong>… но для spy может использоваться объект, на основе которого он будет создан (несмотря на название, этот метод предназначен не только для <strong>mock&#8217;ов</strong>, а задействует также и все нижеперечисленные аннотации).
Такой объект можно сразу указать в качестве значения аннотируемого поля, но можно и не указывать — тогда <strong>spy</strong> будет создан на основе класса.</p>
</div>
<div class="paragraph">
<p>Есть аннотация <strong>@Captor</strong> для создания экземпляров <strong>ArgumentCaptor</strong>.</p>
</div>
<div class="paragraph">
<p>Ещё существует <strong>@InjectMocks</strong>.
Помеченное таким образом поле инициализируется настоящим объектом указанного класса.
Его поля по возможности проинициализированы значениями <strong>mock-полей</strong>, помеченных соответствующей аннотацией.
Для этого используется конструктор с наибольшим числом параметров, сеттеры и так далее.
Если какого-то объектного параметра конструктора не хватает, вместо него будет использован <strong>null</strong>, а вот параметр-примитив просто не позволит тесту сработать.
В целом это похоже на маленькую и простую (и всё равно не такую уж примитивную) реализацию <strong>dependency injection</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_откат_поведения_к_дефолтному_и_сессии_mockito">Откат поведения к дефолтному и сессии Mockito</h3>
<div class="paragraph">
<p>Чтобы привести все <strong>mock-объекты</strong> в состояние по умолчанию можно использовать методы <strong>Mockito.reset</strong> и <strong>Mockito.clearInvocations</strong>.
Оба принимают <strong>varargs</strong>, и передавать им нужно соответствующие <strong>mock&#8217;и</strong>.</p>
</div>
<div class="paragraph">
<p>Ещё одно решение — использовать так называемые <strong>сессии Mockito</strong>.
Именно его рекомендуют авторы.
В начале сессии все <strong>mock-объекты</strong> инициализируются, а после работы обязательно должно быть выполнено её окончание (хотя mock&#8217;и продолжают оставаться функциональными и после него).
Если я хочу создавать отдельную сессию для каждого тестового метода, то удобно создать поле типа MockitoSession, присвоить ему значение до вызова тестового метода и завершить сессию после.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Mock
DataService dataService;

MockitoSession session;

@BeforeMethod
public void beforeMethod() {
    session = Mockito.mockitoSession()
            .initMocks(this)
            .startMocking();
}

@Test
public void testMethod() {
    // some code using the dataService field
}

@AfterMethod
public void afterMethod() {
    session.finishMocking();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_links">Links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://ru.wikipedia.org/wiki/BDD_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)">Mockito и как его готовить</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/444982/">BDD (программирование)</a></p>
</li>
<li>
<p><a href="https://www.javadoc.io/doc/org.mockito/mockito-core/2.7.10/org/mockito/Mockito.html">Официальная документация Mockito</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%B2%D1%82%D0%BE%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%5D">Автотестирование</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_liquibase">Liquibase</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Liquibase</strong> представляет систему управления версиями базы данных, в основном это касается структуры и в меньшей степени содержимого базы.
При этом описание базы с одной стороны достаточно абстрактно и позволяет использовать на нижнем уровне различные СУБД, и с другой стороны всегда можно перейти на SQL-диалект конкретной СУБД, что достаточно гибко.</p>
</div>
<div class="paragraph">
<p><strong>Liquibase</strong> является устоявшимся проектом с открытым исходным кодом и активно используется за пределами своей родной Java среды и не требует глубоких знаний Java для работы. В качестве описания структуры базы и изменений базы исторически использовался <strong>XML</strong> формат, однако сейчас параллельно поддерживается <strong>YAML</strong> и <strong>JSON</strong>. Более подробно: <a href="https://docs.liquibase.com/home.html">Liquibase Docs</a></p>
</div>
<div class="paragraph">
<p>Использовать <strong>Liquibase</strong> можно различными способами:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>как консольное приложение</strong></p>
</li>
<li>
<p><strong>как java-library</strong> подключенная к проекту</p>
</li>
<li>
<p><strong>как встроенную задачу в CI/CD инструмент</strong></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_настройка_окружения">Настройка окружения</h3>
<div class="sect3">
<h4 id="_установка_и_настройка_субд">Установка и настройка СУБД</h4>
<div class="paragraph">
<p>Так как <strong>Liquibase</strong> систему управления версиями базы данных, то необходимо устанавливать и настраивать СУБД. Вместо этого можно использовать <strong>Docker Compose</strong> и следующий файл для запуска <strong>PostgreSQL</strong> как <strong>Docker Container</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">version: '3.7'

services:
  maven-liquibase-postgres:
    container_name: maven-liquibase-postgres-container
    image: postgres
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${POSTGRES_DATABASE:-maven-liquibase}
      POSTGRES_USER: ${POSTGRES_USER:-postgres}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-postgres}
    ports:
      - '5432:5432'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для запуска можно использовать команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">docker-compose up -d</code></pre>
</div>
</div>
<div class="paragraph">
<p>Далее, при работе с Liquibase, будет использоваться данная СУБД.</p>
</div>
</div>
<div class="sect3">
<h4 id="_проект_с_liquibase">Проект с Liquibase</h4>
<div class="paragraph">
<p>При разработке на Java наиболее удобным будет использование <strong>Apache Maven</strong> или <strong>Gradle</strong>.</p>
</div>
<div class="paragraph">
<p>В дальнейшем речь пойдет именно о <strong>Apache Maven</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Структура проекта</div>
<div class="content">
<pre>.
├── pom.xml
└── src
    └── main
        └── resources
            ├── data
            ├── liquibase.properties
            └── master.xml</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pom.xml</code> - содержит все необходимые зависимости, настройки для Liquibase</p>
</li>
<li>
<p><code>liquibase.properties</code> - файл с настройками соединения к базе (логин/пароль и возможно другие параметры)</p>
</li>
<li>
<p>xml-файл с изменениями базы (либо другие варианты: YAML, JSON, XML + SQL, YAML + SQL, JSON + SQL)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title"><code>pom.xml</code></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;by.rakovets.example&lt;/groupId&gt;
    &lt;artifactId&gt;liquibase-maven&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;packaging&gt;pom&lt;/packaging&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;log4j2.version&gt;2.14.1&lt;/log4j2.version&gt;
        &lt;liquibase.version&gt;4.5.0&lt;/liquibase.version&gt;
        &lt;postgresql.version&gt;42.3.0&lt;/postgresql.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;!--Logging--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
            &lt;version&gt;${log4j2.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
            &lt;version&gt;${log4j2.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;
            &lt;version&gt;${log4j2.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!--JDBC drivers--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;
            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;
            &lt;version&gt;${postgresql.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.liquibase&lt;/groupId&gt;
            &lt;artifactId&gt;liquibase-core&lt;/artifactId&gt;
            &lt;version&gt;${liquibase.version}&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.liquibase&lt;/groupId&gt;
                &lt;artifactId&gt;liquibase-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${liquibase.version}&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;propertyFile&gt;src/main/resources/liquibase.properties&lt;/propertyFile&gt;
                    &lt;changeLogFile&gt;src/main/resources/master.xml&lt;/changeLogFile&gt;
                    &lt;dataDir&gt;src/main/resources/data&lt;/dataDir&gt;
                    &lt;!-- log  --&gt;
                    &lt;verbose&gt;true&lt;/verbose&gt;
                    &lt;logging&gt;debug&lt;/logging&gt;
                    &lt;promptOnNonLocalDatabase&gt;false&lt;/promptOnNonLocalDatabase&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Файл с настройками соединения к базе</p>
</div>
<div class="listingblock">
<div class="title"><code>liquibase.properties</code></div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">username=postgres
password=postgres
url=jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified</code></pre>
</div>
</div>
<div class="paragraph">
<p>Основным понятием liquibase являются так называемые <strong>changesets</strong> (<strong>изменения базы</strong>). Они могут включать в себя как изменения структуры, так и изменение данных. Для контроля примененных <strong>changesets</strong> <strong>Liquibase</strong> использует таблицы <code>databasechangelog</code> и <code>databasechangeloglock</code>.</p>
</div>
<div class="listingblock">
<div class="title">Main changeLogFile <code>master.xml</code></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.1" encoding="UTF-8" standalone="no"?&gt;
&lt;databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd"&gt;

    &lt;changeSet context="legacy" author="author (generated)" id="1"&gt;
        &lt;createTable tableName="test"&gt;
            &lt;column autoIncrement="true" name="id" type="SERIAL"&gt;
                &lt;constraints nullable="false"/&gt;
            &lt;/column&gt;
            &lt;column name="user_name" type="VARCHAR(255)"/&gt;
            &lt;column name="preferences" type="TEXT"/&gt;
        &lt;/createTable&gt;

        &lt;rollback&gt;
            &lt;dropTable tableName="test" /&gt;
        &lt;/rollback&gt;
    &lt;/changeSet&gt;
&lt;/databaseChangeLog&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_обновление_бд">Обновление БД</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">mvn liquibase:update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь выполняется <code>liquibase:update</code> для базы указанной в <code>liquibase.properties</code> из <code>liquibase.url</code>, которая указана в стандартном JDBC формате.</p>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre>[INFO] Scanning for projects...
[INFO]
[INFO] ----------------&lt; by.rakovets.example:liquibase-maven &gt;-----------------
[INFO] Building liquibase-maven 1.0.0
[INFO] --------------------------------[ pom ]---------------------------------
[INFO]
[INFO] --- liquibase-maven-plugin:4.5.0:update (default-cli) @ liquibase-maven ---
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[project, pluginDescriptor]
[INFO] Parsing Liquibase Properties File
[INFO]   File: src/main/resources/liquibase.properties
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO]
[INFO] Liquibase Community 4.5.0 by Datical
[INFO] ####################################################
##   _     _             _ _                      ##
##  | |   (_)           (_) |                     ##
##  | |    _  __ _ _   _ _| |__   __ _ ___  ___   ##
##  | |   | |/ _` | | | | | '_ \ / _` / __|/ _ \  ##
##  | |___| | (_| | |_| | | |_) | (_| \__ \  __/  ##
##  \_____/_|\__, |\__,_|_|_.__/ \__,_|___/\___|  ##
##              | |                               ##
##              |_|                               ##
##                                                ##
##  Get documentation at docs.liquibase.com       ##
##  Get certified courses at learn.liquibase.com  ##
##  Free schema change activity reports at        ##
##      https://hub.liquibase.com                 ##
##                                                ##
####################################################
Starting Liquibase at 06:31:52 (version 4.5.0 #52 built at 2021-09-27 16:19+0000)
[INFO] Settings
----------------------------
[INFO]     driver: null
[INFO]     url: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO]     username: *****
[INFO]     password: *****
[INFO]     use empty password: false
[INFO]     properties file: src/main/resources/liquibase.properties
[INFO]     properties file will override? false
[INFO]     prompt on non-local database? false
[INFO]     clear checksums? false
[INFO]     changeLogDirectory: null
[INFO]     changeLogFile: src/main/resources/master.xml
[INFO]     context(s): null
[INFO]     label(s): null
[INFO]     number of changes to apply: 0
[INFO]     drop first? false
[INFO] ------------------------------------------------------------------------
[INFO] Set default schema name to public
[INFO] Parsing Liquibase Properties File src/main/resources/liquibase.properties for changeLog parameters
[INFO] Executing on Database: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO] Successfully acquired change log lock
[INFO] Creating database history table with name: databasechangelog
[INFO] Reading from databasechangelog
[INFO] Table test created
[INFO] ChangeSet src/main/resources/master.xml::1::author (generated) ran successfully in 9ms
[INFO] Successfully released change log lock
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.069 s
[INFO] Finished at: 2021-10-23T06:31:52+03:00
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>После успешного выполнения в БД появляются:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>две служебные таблицы <code>databasechangelog</code> и <code>databasechangeloglock</code> (если их не было раньше)</p>
</li>
<li>
<p>запись в таблице <code>databasechangelog</code> с информацией о примененном <strong>changeset</strong></p>
</li>
<li>
<p>изменения указанные в <strong>changeset</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_генерация_sql_без_обновления_базы">Генерация SQL без обновления базы</h3>
<div class="paragraph">
<p>Иногда перед запуском изменений требуется посмотреть содержимое создаваемых запросов. Для этого предназначены команды <code>liquibase:updateSQL</code> и <code>liquibase:rollbackSQL</code></p>
</div>
<div class="sect3">
<h4 id="_liquibaseupdatesql"><code>liquibase:updateSQL</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">mvn liquibase:updateSQL</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre>[INFO] Scanning for projects...
[INFO]
[INFO] ----------------&lt; by.rakovets.example:liquibase-maven &gt;-----------------
[INFO] Building liquibase-maven 1.0.0
[INFO] --------------------------------[ pom ]---------------------------------
[INFO]
[INFO] --- liquibase-maven-plugin:4.5.0:updateSQL (default-cli) @ liquibase-maven ---
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[project, pluginDescriptor]
[INFO] Parsing Liquibase Properties File
[INFO]   File: src/main/resources/liquibase.properties
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO]
[INFO] Liquibase Community 4.5.0 by Datical
[INFO] ####################################################
##   _     _             _ _                      ##
##  | |   (_)           (_) |                     ##
##  | |    _  __ _ _   _ _| |__   __ _ ___  ___   ##
##  | |   | |/ _` | | | | | '_ \ / _` / __|/ _ \  ##
##  | |___| | (_| | |_| | | |_) | (_| \__ \  __/  ##
##  \_____/_|\__, |\__,_|_|_.__/ \__,_|___/\___|  ##
##              | |                               ##
##              |_|                               ##
##                                                ##
##  Get documentation at docs.liquibase.com       ##
##  Get certified courses at learn.liquibase.com  ##
##  Free schema change activity reports at        ##
##      https://hub.liquibase.com                 ##
##                                                ##
####################################################
Starting Liquibase at 06:33:38 (version 4.5.0 #52 built at 2021-09-27 16:19+0000)
[INFO] Settings
----------------------------
[INFO]     driver: null
[INFO]     url: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO]     username: *****
[INFO]     password: *****
[INFO]     use empty password: false
[INFO]     properties file: src/main/resources/liquibase.properties
[INFO]     properties file will override? false
[INFO]     prompt on non-local database? false
[INFO]     clear checksums? false
[INFO]     changeLogDirectory: null
[INFO]     changeLogFile: src/main/resources/master.xml
[INFO]     context(s): null
[INFO]     label(s): null
[INFO]     number of changes to apply: 0
[INFO]     migrationSQLOutputFile: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] ------------------------------------------------------------------------
[INFO] Set default schema nliquibase:rollbackSQLame to public
[INFO] Char encoding not set! The created file will be system dependent!
[INFO] Output SQL Migration File: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] Parsing Liquibase Properties File src/main/resources/liquibase.properties for changeLog parameters
[INFO] Executing on Database: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO] Successfully acquired change log lock
[INFO] Reading from databasechangelog
[INFO] Successfully released change log lock
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.022 s
[INFO] Finished at: 2021-10-23T06:33:39+03:00
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Файл <code>target/liquibase/migrate.sql</code></div>
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">-- *********************************************************************
-- Update Database Script
-- *********************************************************************
-- Change Log: src/main/resources/master.xml
-- Ran at: 10/23/21, 6:33 AM
-- Against: postgres@jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
-- Liquibase version: 4.5.0
-- *********************************************************************

-- Create Database Lock Table
CREATE TABLE databasechangeloglock (ID INTEGER NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP WITHOUT TIME ZONE, LOCKEDBY VARCHAR(255), CONSTRAINT databasechangeloglock_pkey PRIMARY KEY (ID));

-- Initialize Database Lock Table
DELETE FROM databasechangeloglock;

INSERT INTO databasechangeloglock (ID, LOCKED) VALUES (1, FALSE);

-- Lock Database
UPDATE databasechangeloglock SET LOCKED = TRUE, LOCKEDBY = 'ubuntu (172.20.0.1)', LOCKGRANTED = '2021-10-23 07:29:28.866' WHERE ID = 1 AND LOCKED = FALSE;

-- Create Database Change Log Table
CREATE TABLE databasechangelog (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP WITHOUT TIME ZONE NOT NULL, ORDEREXECUTED INTEGER NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10));

-- Changeset src/main/resources/master.xml::1::author (generated)
CREATE TABLE test (id INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL, user_name VARCHAR(255), preferences TEXT);

INSERT INTO databasechangelog (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'author (generated)', 'src/main/resources/master.xml', NOW(), 1, '8:d30ee8898b8b3a53a55c2ae2deba7edd', 'createTable tableName=test', '', 'EXECUTED', 'legacy', NULL, '4.5.0', '4963369142');

-- Release Database Lock
UPDATE databasechangeloglock SET LOCKED = FALSE, LOCKEDBY = NULL, LOCKGRANTED = NULL WHERE ID = 1;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_liquibaserollbacksql"><code>liquibase:rollbackSQL</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">mvn liquibase:rollbackSQL -Dliquibase.rollbackCount=1</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>-Dliquibase.rollbackCount=1</code> - откатить 1 последнее изменение или использовать <strong>tags</strong> и тогда выполнять с командой <code>-Dliquibase.rollbackTag=${tag-name}</code>.</p>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre>[INFO] Scanning for projects...
[INFO]
[INFO] ----------------&lt; by.rakovets.example:liquibase-maven &gt;-----------------
[INFO] Building liquibase-maven 1.0.0
[INFO] --------------------------------[ pom ]---------------------------------
[INFO]
[INFO] --- liquibase-maven-plugin:4.5.0:rollbackSQL (default-cli) @ liquibase-maven ---
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[INFO] Loading artifacts into URLClassLoader
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-api/2.14.1/log4j-api-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-core/2.14.1/log4j-core-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.14.1/log4j-slf4j-impl-2.14.1.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/postgresql/postgresql/42.3.0/postgresql-42.3.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/org/liquibase/liquibase-core/4.5.0/liquibase-core-4.5.0.jar
[INFO]   artifact: file:/home/rakovets/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/classes/
[INFO]   artifact: file:/home/rakovets/dev/exp/liquibase/target/test-classes/
[INFO] ------------------------------------------------------------------------
[project, pluginDescriptor]
[INFO] Parsing Liquibase Properties File
[INFO]   File: src/main/resources/liquibase.properties
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO]
[INFO] Liquibase Community 4.5.0 by Datical
[INFO] ####################################################
##   _     _             _ _                      ##
##  | |   (_)           (_) |                     ##
##  | |    _  __ _ _   _ _| |__   __ _ ___  ___   ##
##  | |   | |/ _` | | | | | '_ \ / _` / __|/ _ \  ##
##  | |___| | (_| | |_| | | |_) | (_| \__ \  __/  ##
##  \_____/_|\__, |\__,_|_|_.__/ \__,_|___/\___|  ##
##              | |                               ##
##              |_|                               ##
##                                                ##
##  Get documentation at docs.liquibase.com       ##
##  Get certified courses at learn.liquibase.com  ##
##  Free schema change activity reports at        ##
##      https://hub.liquibase.com                 ##
##                                                ##
####################################################
Starting Liquibase at 06:43:58 (version 4.5.0 #52 built at 2021-09-27 16:19+0000)
[INFO] Settings
----------------------------
[INFO]     driver: null
[INFO]     url: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO]     username: *****
[INFO]     password: *****
[INFO]     use empty password: false
[INFO]     properties file: src/main/resources/liquibase.properties
[INFO]     properties file will override? false
[INFO]     prompt on non-local database? false
[INFO]     clear checksums? false
[INFO]     changeLogDirectory: null
[INFO]     changeLogFile: src/main/resources/master.xml
[INFO]     context(s): null
[INFO]     label(s): null
[INFO]     rollback Count: 1
[INFO]     rollback Date: null
[INFO]     rollback Tag: null
[INFO]     migrationSQLOutputFile: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] ------------------------------------------------------------------------
[INFO] Set default schema name to public
[INFO] Char encoding not set! The created file will be system dependent!
[INFO] Output SQL Migration File: /home/rakovets/dev/exp/liquibase/target/liquibase/migrate.sql
[INFO] Parsing Liquibase Properties File src/main/resources/liquibase.properties for changeLog parameters
[INFO] Executing on Database: jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
[INFO] Successfully acquired change log lock
[INFO] Reading from databasechangelog
[INFO] Successfully released change log lock
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.046 s
[INFO] Finished at: 2021-10-23T06:43:59+03:00
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Файл <code>.Файл `target/liquibase/migrate.sql`</code></div>
<div class="content">
<pre>-- *********************************************************************
-- Rollback 1 Change(s) Script
-- *********************************************************************
-- Change Log: src/main/resources/master.xml
-- Ran at: 10/23/21, 6:43 AM
-- Against: postgres@jdbc:postgresql://localhost:5432/maven-liquibase?prepareThreshold=0&amp;stringtype=unspecified
-- Liquibase version: 4.5.0
-- *********************************************************************

-- Lock Database
UPDATE databasechangeloglock SET LOCKED = TRUE, LOCKEDBY = 'ubuntu (172.20.0.1)', LOCKGRANTED = '2021-10-23 06:43:59.083' WHERE ID = 1 AND LOCKED = FALSE;

-- Rolling Back ChangeSet: src/main/resources/master.xml::1::author (generated)
DROP TABLE test;

DELETE FROM databasechangelog WHERE ID = '1' AND AUTHOR = 'author (generated)' AND FILENAME = 'src/main/resources/master.xml';

-- Release Database Lock
UPDATE databasechangeloglock SET LOCKED = FALSE, LOCKEDBY = NULL, LOCKGRANTED = NULL WHERE ID = 1;</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_подробнее_о_changeset">Подробнее о changeSet</h3>
<div class="paragraph">
<p>Изменения могут быть в разных форматах, в том числе обычный sql или он же в отдельном файле.</p>
</div>
<div class="paragraph">
<p>Каждое изменение может включать секцию <code>rollback</code> позволяющую откатывать изменения командой <code>liquibase:rollback</code>.
Кроме того для маркировки изменений, например для более удобного отката туда, можно использовать <code>tagDatabase</code>.</p>
</div>
<div class="sect3">
<h4 id="_обычный_формат">Обычный формат</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;changeSet context="legacy" author="author (generated)" id="1"&gt;
    &lt;createTable tableName="test"&gt;
        &lt;column autoIncrement="true" name="id" type="SERIAL"&gt;
            &lt;constraints primaryKey="true" primaryKeyName="test_pkey"/&gt;
        &lt;/column&gt;
        &lt;column name="c1" type="VARCHAR(255)"/&gt;
        &lt;column name="c2" type="INTEGER"/&gt;
        &lt;column name="c3" type="SMALLINT"/&gt;
        &lt;column name="c4" type="VARCHAR(255)"/&gt;
        &lt;column name="c5" type="TEXT"/&gt;
        &lt;column name="c6" type="VARCHAR(255)"/&gt;
    &lt;/createTable&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_встроенный_sql">Встроенный SQL</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-domain-some-domain"&gt;
    &lt;sql&gt;CREATE DOMAIN public.some_domain AS bigint; ALTER DOMAIN public.some_domain OWNER TO test;&lt;/sql&gt;
    &lt;rollback&gt;DROP DOMAIN public.some_domain;&lt;/rollback&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_файл_sql">Файл SQL</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-user"&gt;
    &lt;sqlFile dbms="postgresql" path="sql/some.sql" relativeToChangelogFile="true"/&gt;
    &lt;rollback&gt;delete from "some";&lt;/rollback&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_теги">Теги</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-initial-changeset"&gt;
    &lt;tagDatabase tag="initial"/&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_контексты_запуска">Контексты запуска</h3>
<div class="paragraph">
<p>Для более удобного управления различными конфигурациями, например <code>development/production</code> можно использовать контексты.
Контекст указывается в changeSet аттрибуте context и затем запускается <strong>Apache Maven</strong> параметром <code>-Dcontexts</code>.</p>
</div>
<div class="sect3">
<h4 id="_изменение_с_контекстом">Изменение с контекстом</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-initial-changeset"&gt;
    &lt;tagDatabase tag="initial"/&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_запуск_изменений_по_контексту">Запуск изменений по контексту</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">#!/usr/bin/env bash mvn liquibase:update\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test?prepareThreshold=0&amp;stringtype=unspecified"\
        -Dliquibase.contexts=non-legacy</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_откат_изменений">Откат изменений</h3>
<div class="paragraph">
<p>Операция обратная обновлению, в большинстве случаев поддерживается автоматически.
Для прочих возможно задание через секцию rollback.
Запускается командой liquibase:rollback.</p>
</div>
<div class="sect3">
<h4 id="_изменение_с_откатом">Изменение с откатом</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;changeSet context="legacy" author="author" id="1-domain-some-domain"&gt;
    &lt;sql&gt;CREATE DOMAIN public.some_domain AS bigint; ALTER DOMAIN public.some_domain OWNER TO test;&lt;/sql&gt;
    &lt;rollback&gt;DROP DOMAIN public.some_domain;&lt;/rollback&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_запуск_отката">Запуск отката</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">#!/usr/bin/env bash mvn liquibase:update\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test?prepareThreshold=0&amp;stringtype=unspecified"\
        -Dliquibase.contexts=non-legacy</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_сравнение">Сравнение</h3>
<div class="paragraph">
<p>В разработке удобно использовать для сравнения двух существующих баз на предмет внесённых изменений.
В настройки (или параметры запуска) потребуется добавить ссылку на reference DB и данные для доступа к ней.</p>
</div>
<div class="listingblock">
<div class="title"><code>liquibase.properties</code></div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">referenceUsername=test referenceUrl=jdbc:postgresql://dev/test_reference</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_сравнение_схем">Сравнение схем</h4>
<div class="paragraph">
<p>Сравнение схем <code>url</code> и <code>referenceUrl</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">#!/usr/bin/env bash mvn liquibase:diff\
        -Denv=dev\
        -Dliquibase.referenceUrl="jdbc:postgresql://dev/test?prepareThreshold=0"\
        -Dliquibase.url="jdbc:postgresql://dev/test_reference?prepareThreshold=0"\
        -Dliquibase.diffChangeLogFile=dev/diff.xml</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_сохранение_схемы">Сохранение схемы</h3>
<div class="paragraph">
<p>Также бывает полезно сохранить текущую схему базы, с данными или без. Необходимо иметь в виду, что <strong>Liquibase</strong> сохраняет схему не полностью соответствующую оригиналу, например используемые домены или наследование нужно будет добавлять отдельно (см Ограничения).</p>
</div>
<div class="sect3">
<h4 id="_сохранение_схемы_без_учёта_данных">Сохранение схемы без учёта данных</h4>
<div class="paragraph">
<p>Сохранение схемы существующей базы.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">#!/usr/bin/env bash mvn liquibase:generateChangeLog\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test_reference?prepareThreshold=0"\
        -Dliquibase.outputChangeLogFile=dev/changelog.xml</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_сохранение_схемы_с_данными">Сохранение схемы с данными</h4>
<div class="paragraph">
<p>Сохранение схемы существующей базы с данными.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">#!/usr/bin/env bash mvn liquibase:generateChangeLog\
        -Denv=dev\
        -Dliquibase.url="jdbc:postgresql://dev/test_reference?prepareThreshold=0"\
        -Dliquibase.outputChangeLogFile=dev/changelog.xml</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_обработка_типов_данных_специфичных_для_конкретной_базы">Обработка типов данных специфичных для конкретной базы</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;changeSet&gt;
    &lt;createTable tableName="t_name"&gt;
        ...
        &lt;column name="doubleArray" type="DOUBLE_ARRAY"/&gt;
        ...
    &lt;/createTable&gt;
    &lt;modifySql dbms="postgresql"&gt;
        &lt;replace replace="DOUBLE_ARRAY" with="double precision[][]"/&gt;
    &lt;/modifySql&gt;
&lt;/changeSet&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_альтернативные_решения">Альтернативные решения</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Flyway</strong><br>
Наряду с Liquibase пользуется популярностью в Java сообществе — <a href="http://flywaydb.org/documentation" class="bare">http://flywaydb.org/documentation</a></p>
</li>
<li>
<p><strong>Sqitch</strong><br>
Аналог на Perl — <a href="http://sqitch.org" class="bare">http://sqitch.org</a></p>
</li>
<li>
<p><strong>FluentMigrator</strong><br>
Аналог для .Net — <a href="https://github.com/schambers/fluentmigrator" class="bare">https://github.com/schambers/fluentmigrator</a></p>
</li>
<li>
<p><strong>DBGeni</strong><br>
Аналог для Ruby — <a href="http://dbgeni.appsintheopen.com/manual.html" class="bare">http://dbgeni.appsintheopen.com/manual.html</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_links_2">Links</h3>
<div class="ulist">
<ul>
<li>
<p>Существуют определенные проблемы с выгрузкой, сравнением и применением бинарных данных, в частности проблема с генерацией изменений.</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://liquibase.jira.com/browse/CORE-2650" class="bare">https://liquibase.jira.com/browse/CORE-2650</a></p>
</li>
<li>
<p><a href="https://liquibase.jira.com/browse/CORE-2906" class="bare">https://liquibase.jira.com/browse/CORE-2906</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Наследование и общие столбцы</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://forum.liquibase.org/topic/postgresql-subtable-via-inherits" class="bare">http://forum.liquibase.org/topic/postgresql-subtable-via-inherits</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/25840467/liquibase-common-columns" class="bare">https://stackoverflow.com/questions/25840467/liquibase-common-columns</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Исходный код</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/liquibase/liquibase" class="bare">https://github.com/liquibase/liquibase</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Как добавить liquibase в существующий проект</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/existing_project.html" class="bare">https://www.liquibase.org/documentation/existing_project.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/contexts.html" class="bare">https://www.liquibase.org/documentation/contexts.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Как работают изменения базы</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/changeset.html" class="bare">https://www.liquibase.org/documentation/changeset.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/databasechangelog_table.html" class="bare">https://www.liquibase.org/documentation/databasechangelog_table.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше о формате изменений</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.liquibase.org/documentation/json_format.html" class="bare">http://www.liquibase.org/documentation/json_format.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/changes/sql.html" class="bare">https://www.liquibase.org/documentation/changes/sql.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/changes/sql_file.html" class="bare">https://www.liquibase.org/documentation/changes/sql_file.html</a></p>
</li>
<li>
<p><a href="https://www.liquibase.org/documentation/column.html" class="bare">https://www.liquibase.org/documentation/column.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше про update</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/maven/generated/update-mojo.html" class="bare">https://www.liquibase.org/documentation/maven/generated/update-mojo.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше о генерации изменений</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.liquibase.org/documentation/maven/generated/generateChangeLog-mojo.html" class="bare">https://www.liquibase.org/documentation/maven/generated/generateChangeLog-mojo.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Больше о custom SQL</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.liquibase.org/documentation/modify_sql.html" class="bare">http://www.liquibase.org/documentation/modify_sql.html</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/28240068/create-column-of-type-double-precision-with-liquibase" class="bare">https://stackoverflow.com/questions/28240068/create-column-of-type-double-precision-with-liquibase</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Прочее</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://news.ycombinator.com/item?id=10145933" class="bare">https://news.ycombinator.com/item?id=10145933</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Другие статьи о Liquibase</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://habr.com/ru/post/179425/" class="bare">https://habr.com/ru/post/179425/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/178665/" class="bare">https://habr.com/ru/post/178665/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/333762/" class="bare">https://habr.com/ru/post/333762/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/251617/" class="bare">https://habr.com/ru/post/251617/</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/251617/" class="bare">https://habr.com/ru/post/251617/</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging">Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Logging</strong> (<strong>логирование</strong>, <strong>журналирование</strong>) — это процесс записи куда-то (в файл, в сетевой сокет) данных о работе программы. Место, куда эти данные записываются, является <strong>log-файл</strong>, а само содержимое называют <strong>logs</strong> (<strong>логи</strong>). <strong>Log</strong> (<strong>лог</strong>) - это одна запись, которая делается в <strong>log-file</strong>. Так же само действие по отправке записи при logging называется <strong>log</strong> (<strong>логировать</strong>)</p>
</div>
<div class="paragraph">
<p>Если в работе сервера, компьютера или программного обеспечения возникла неизвестная ошибка, в первую очередь смотрят логи. <strong>Log-файл</strong> — <strong>текстовый файл</strong> с информацией о действиях программного обеспечения или пользователей, который хранится на компьютере или передается на хранение в систему логирования. Это хронология событий и их источников, ошибок и причин, по которым они произошли. Читать и анализировать логи можно как с помощью обычного текстового редактора, так и с помощью специального ПО.</p>
</div>
<div class="paragraph">
<p><strong>Logging</strong> позволяет ответить на вопросы, что происходило, когда и при каких обстоятельствах. Без логов сложно понять, из-за чего появляется ошибка, если она возникает периодически и только при определенных условиях. Чтобы облегчить задачу администраторам и программистам, в лог записывается информация не только об ошибках, но и о причинах их возникновения. Благодаря логам найденные ошибки можно быстро исправить.</p>
</div>
<div class="paragraph">
<p>Весь процесс логирования состоит из трех частей.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Сбор информации.</p>
</li>
<li>
<p>Фильтрование собранной информации.</p>
</li>
<li>
<p>Запись отобранной информации.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_типы_логов">Типы логов</h3>
<div class="paragraph">
<p>Для удобной работы с логами их делят на типы. Это помогает быстрее находить нужные и выбирать правильные инструменты для работы с ними. Например, выделяют:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>системные логи</strong>, то есть те, которые связаны с системными событиями;</p>
</li>
<li>
<p><strong>серверные логи</strong>, регистрирующие обращения к серверу и возникшие при этом ошибки;</p>
</li>
<li>
<p><strong>логи баз данных</strong>, фиксирующие запросы к базам данных;</p>
</li>
<li>
<p><strong>почтовые логи</strong>, относящиеся к входящим/исходящим письмам и отслеживающие ошибки, из-за которых письма не были доставлены;</p>
</li>
<li>
<p><strong>логи авторизации</strong>;</p>
</li>
<li>
<p><strong>логи аутентификации</strong>;</p>
</li>
<li>
<p><strong>логи приложений</strong>, установленных на этих операционных системах.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Также логи можно типизировать <strong>по степени важности</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Fatal/critical error</strong> — то, что нужно срочно исправить.</p>
</li>
<li>
<p><strong>Not critical error</strong> — ошибки, которые не влияют на пользователя.</p>
</li>
<li>
<p><strong>Warning</strong> — предупреждения, то, на что нужно обратить внимание.</p>
</li>
<li>
<p><strong>Initial information</strong> — информация о вызовах <strong>API</strong> сервиса, запросах в БД, вызовах других сервисов.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Еще одним важным вопросом на который надо ответить - это что необходимо отправлять в log.</p>
</div>
<div class="paragraph">
<p>Работа приложения - это происходящие в нем события, которые в свою очередь могут быть классифицированы на:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>события, связанные с бизнес-логикой;</p>
</li>
<li>
<p>события, связанные с безопасностью приложения;</p>
</li>
<li>
<p>системные события, связанные с уже конкретикой реализации - вызовов ОС, использования библиотек, фреймворков и т.д.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Логировать обязательно необходимо:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Начало/конец работы приложения</strong>. Нужно знать, что приложение действительно запустилось, как мы и ожидали, и завершилось так же ожидаемо.</p>
</li>
<li>
<p><strong>Вопросы безопасности</strong>. Здесь хорошо бы логировать попытки подбора пароля, логирование входа важных юзеров и т.д.</p>
</li>
<li>
<p>Некоторые <strong>состояния приложения</strong>. Например, переход из одного состояния в другое в бизнес процессе.</p>
</li>
<li>
<p>Некоторая <strong>информация для debug</strong>, с соответственным уровнем логирования.</p>
</li>
<li>
<p><strong>Некоторые SQL скрипты</strong>. Есть реальные случаи, когда это нужно. Опять-таки, умелым образом регулируя уровни, можно добиться отличных результатов.</p>
</li>
<li>
<p><strong>Выполняемые потоки (Thread)</strong> могут быть отправлены в log в случаях с проверкой корректной работы.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Популярные ошибки в logging:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Избыток логирования</strong><br>
Не стоит логировать каждый шаг, который чисто теоретически может быть важным.
<strong>Есть правило</strong>: логи могут нагружать работоспособность не более, чем на <strong>10%</strong>. Иначе будут проблемы с производительностью.</p>
</li>
<li>
<p><strong>Логирование всех данных в один файл</strong><br>
Это приведет к тому, что в определенный момент чтение/запись в него будет очень сложной, не говоря о том, что есть ограничения по размеру файлов в определенных системах.</p>
</li>
<li>
<p><strong>Использование неверных уровней логирования</strong><br>
У каждого уровня логирования есть четкие границы, и их стоит соблюдать. Если граница расплывчатая, можно договориться какой из уровней использовать.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_библиотеки_логирования_в_java">Библиотеки логирования в Java</h3>
<div class="paragraph">
<p>В <strong>Java</strong> существуют следующие <strong>библиотеки логирования</strong>, иногда называемые <strong>loggers</strong> (<strong>логерами</strong>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Log4j</strong> - это первый набор инструментов для логирования Java, который появился еще в 1999-м году. Внутри себя имеет различные способы вывода логов, несколько форматов логирования и многое другое. Раньше данная библиотека активно применялась, но уже долгое время этот проект не развивается.</p>
</li>
<li>
<p><strong>JUL</strong> — <code>java.util.logging</code>. Является частью <strong>JDK</strong>. Имеет множество уровней логирования, например, только для отладки у этого инструмента есть в арсенале 3 отладочных уровня вместо одного стандартного.</p>
</li>
<li>
<p><strong>JCL</strong> — <strong>Apache Commons Logging</strong>. Из-за того, что долгое время не было промышленного стандарта в logging и был период, когда многие создавали свой свои собственные библиотеки логирования, решили выпустить <strong>JCL</strong> — общую обертку, которая  использовалась бы над другими.</p>
</li>
<li>
<p><strong>Logback</strong> - был создан как альтернатива умирающему <strong>Log4j</strong>, разработанная создателями <strong>Log4j</strong>, поэтому он вобрал в себя все лучшее из этого инструмента, при этом усовершенствовал некоторые показатели.</p>
</li>
<li>
<p><strong>Log4j 2.x</strong> - это улучшенная версия <strong>log4j 1.x</strong> и <strong>logback</strong>.</p>
</li>
<li>
<p><strong>SLF4J</strong> — <strong>Simple Logging Facade for Java</strong>. Этот инструмент является оберткой над многими популярными библиотеками логирования, например: <strong>Logback</strong>, <strong>Log4j</strong>, <strong>JUL</strong> и др., поэтому его рекомендуется использовать в паре с полноценной библиотекой для логирования.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_уровень_логирования">Уровень логирования</h3>
<div class="paragraph">
<p>Если в <strong>лог-файл</strong> записывать все действия программы, то там будет большое количество различных сведений. В некоторых ситуациях лог-файлы могут генерироваться очень быстро и в огромных размерах. В этом случае найти нужную информацию в логах будет очень нелегко. Поэтому, чтобы контролировать объемы записываемой информации, придумали различные уровни логирования.</p>
</div>
<div class="paragraph">
<p><strong>Уровень логирования</strong> - это разделение событий по приоритетам, по степени важности. Например, <strong>error</strong> - пишем ошибки, <strong>debug</strong> - пишем более подробно в лог и т.д.</p>
</div>
<div class="paragraph">
<p>Практически все библиотеки логирования (кроме <strong>JUL</strong>) имеют следующие уровни логирования:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OFF</strong>: никакие логи не записываются, все будут проигнорированы;</p>
</li>
<li>
<p><strong>FATAL</strong>: ошибка, после которой приложение уже не сможет работать и будет остановлено, например, <strong>JVM out of memory error</strong>;</p>
</li>
<li>
<p><strong>ERROR</strong>: уровень ошибок, когда есть проблемы, которые нужно решить. Ошибка не останавливает работу приложения в целом. Остальные запросы могут работать корректно;</p>
</li>
<li>
<p><strong>WARN</strong>: обозначаются логи, которые содержат предостережение. Произошло неожиданное действие, несмотря на это система устояла и выполнила запрос;</p>
</li>
<li>
<p><strong>INFO</strong>: лог, который записывает важные действия в приложении. Это не ошибки, это не предостережение, это ожидаемые действия системы;</p>
</li>
<li>
<p><strong>DEBUG</strong>: логи, необходимые для отладки приложения. Для уверенности в том, что система делает именно то, что от нее ожидают, или описания действия системы: <code>method1 начал работу</code>;</p>
</li>
<li>
<p><strong>TRACE</strong>: менее приоритетные логи для отладки, с наименьшим уровнем логирования;</p>
</li>
<li>
<p><strong>ALL</strong>: уровень, при котором будут записаны все логи из системы.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Если в приложении в каком-то месте включен уровень логирования <strong>INFO</strong>, будут логироваться все уровни, начиная с <strong>INFO</strong> и до <strong>FATAL</strong>. Если будет уровень логирования <strong>FATAL</strong>, будут записаны <strong>только логи с этим уровнем</strong>.</p>
</div>
<div class="paragraph">
<p><strong>JUL</strong> имеет следующие уровни логирования:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>FINEST</strong>,</p>
</li>
<li>
<p><strong>FINER</strong>,</p>
</li>
<li>
<p><strong>FINE</strong>,</p>
</li>
<li>
<p><strong>CONFIG</strong>,</p>
</li>
<li>
<p><strong>INFO</strong>,</p>
</li>
<li>
<p><strong>WARNING</strong>,</p>
</li>
<li>
<p><strong>SEVERE</strong>,</p>
</li>
<li>
<p><strong>ALL</strong>,</p>
</li>
<li>
<p><strong>OFF</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_основные_термины">Основные термины</h3>
<div class="paragraph">
<p>В основе большинства библиотек логирования в <strong>Java</strong> лежат три понятия:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Logger</strong></p>
</li>
<li>
<p><strong>Appender</strong></p>
</li>
<li>
<p><strong>Layout</strong></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_logger">Logger</h4>
<div class="paragraph">
<p><strong>Logger</strong> — это некий объект, который отвечает за запись информации в лог-файлы, опираясь на заданные уровни логирования. <strong>Logger</strong> создается с помощью фабрики и на этапе создания ему присваивается имя. Имя может быть любым, но по стандарту имя должно быть сопряжено с именем класса, в котором вы собираетесь что-то логировать.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Logger logger = LoggerFactory.gerLogger(SomeClass.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Основная задача Logger</strong> — не пропустить событие, которое нужно записать в лог-файл.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">logger.info("Application started");
logger.debug("Or not");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Это событие по сути состоит из двух полей:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>message = "Application started"</code>;</p>
</li>
<li>
<p><code>level = Level.Info</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_appender">Appender</h4>
<div class="paragraph">
<p><strong>Appender</strong> — это конечная точка, куда «приходит» информация для логирования. В качестве <strong>appender</strong> могут выступать: <strong>файл</strong>, <strong>база данных</strong>, <strong>консоль</strong>, <strong>сокет</strong> и др. У <strong>appender</strong> нет каких-либо ограничений, куда записывать сообщения. Можно написать свой <strong>appender</strong>, который пишет сообщения куда-угодно. Если <strong>Logger</strong> — это начальная точка в logging, то <strong>Appender</strong> — это конечная точка.</p>
</div>
<div class="paragraph">
<p><strong>Loggers</strong>  и <strong>appenders</strong> связаны в отношении <code>many-to-many</code>. При этом один <strong>logger</strong> может содержать несколько <strong>appenders</strong> и наоборот. Чтобы изменить поведение <strong>logger по умолчанию</strong>, нам нужно сконфигурировать свой <strong>файловый appender</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_layout">Layout</h4>
<div class="paragraph">
<p><strong>Layout</strong> — это формат, в котором выводятся сообщения. Форматирование сообщений напрямую зависит от используемой библиотеки при logging.</p>
</div>
</div>
<div class="sect3">
<h4 id="_узлы_логирования">Узлы логирования</h4>
<div class="paragraph">
<p>При создании logger используется класс, но по итогу записывается полное имя класса с пакетами. Это делается, чтобы потом можно было разделить логирование на узлы, и для каждого узла настроить уровень логирования и appender. Например, имя класса: <code>com.github.romankh3.logginglecture.MainDemo</code> — в нем создался logger. И вот таким образом его можно разделить на узлы логирования.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../assets/img/java/tools/logging/logging-nodes.png" alt="logging nodes"></span></p>
</div>
<div class="paragraph">
<p>Каждый <strong>logger</strong> имеет имя, описывающее иерархию, к которой он принадлежит. Разделитель – точка. Принцип полностью аналогичен формированию имени пакета в <strong>Java</strong>. Например: <code>ru.aarexer.example.SomeClass</code>. Главный узел — нулевой <strong>RootLogger</strong>. Это узел, который принимает все логи всего приложения. Каждому <strong>logger</strong> можно выставить свой уровень. Установленный <strong>logger</strong> уровень вывода распространяется на все его дочерние <strong>loggers</strong>, для которых явно не выставлен уровень. Поэтому у всех <strong>loggers</strong> будет уровень логирования, даже если явно мы не прописали для <code>ru.aarexer.example.SomeClass</code> его, то он будет наследоваться от <strong>RootLogger</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Appenders</strong> настраивают свою работу именно на узлы логирования. Но такое наследование <strong>appenders</strong> можно отключить через конфигурацию, для этого стоит посмотреть в сторону выставления флага <code>additivity="false"</code> на <strong>loggers</strong>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_конфигурация_и_использование">Конфигурация и использование</h3>
<div class="sect3">
<h4 id="_конфигурация">Конфигурация</h4>
<div class="paragraph">
<p>При конфигурировании можно выбрать куда будет производиться запись, путь где будет лежать файл лога, количество файлов, их размеры. Более подробные описания конфигураций для различных реализаций будут приведены при описании этих реализаций.</p>
</div>
<div class="paragraph">
<p>В зависимости от используемой библиотеки, <strong>loggers</strong> могут конфигурироваться различными способами.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Log4j</strong> поддерживает конфигурирование двумя способами – как <strong>properties</strong> и <strong>xml</strong> файл.</p>
</li>
<li>
<p><strong>JUL</strong> настраивается только через <strong>properties</strong> файл.</p>
</li>
<li>
<p><strong>Logback</strong> может быть сконфигурирован через <strong>xml</strong> и <strong>groovy</strong> файл.</p>
</li>
<li>
<p><strong>Log4j 2</strong> может быть сконфигурирован через <strong>xml</strong>, <strong>json</strong> и <strong>yaml</strong> файл.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Конфигурация через xml-файл:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;
&lt;log4j:configuration debug="false" xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;
    &lt;appender name="ConsoleAppender" class="org.apache.log4j.ConsoleAppender"&gt;
        &lt;param name="Encoding" value="Cp866"/&gt;
        &lt;layout class="org.apache.log4j.PatternLayout"&gt;
            &lt;param name="ConversionPattern" value="%d{ISO8601} [%-5p][%-16.16t][%32.32c] - %m%n" /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;root&gt;
        &lt;priority value="DEBUG"/&gt;
        &lt;appender-ref ref="ConsoleAppender" /&gt;
    &lt;/root&gt;
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Конфигурация через properties-файл:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.debug = false
log4j.rootLogger = DEBUG, ConsoleAppender
# CONSOLE appender customisation
log4j.appender.ConsoleAppender = org.apache.log4j.ConsoleAppender
log4j.appender.ConsoleAppender.encoding = Cp866
log4j.appender.ConsoleAppender.layout = org.apache.log4j.PatternLayout
log4j.appender.ConsoleAppender.layout.ConversionPattern = %d{ISO8601} [%-5p][%-16.16t][%32.32c] - %m%n
# File appender customisation
log4j.appender.FILE=org.apache.log4j.RollingFileAppender
log4j.appender.FILE.File=./target/logging/logging.log
log4j.appender.FILE.MaxFileSize=1MB log4j.appender.FILE.threshold=DEBUG log4j.appender.FILE.MaxBackupIndex=2 log4j.appender.FILE.layout=org.apache.log4j.PatternLayout log4j.appender.FILE.layout.ConversionPattern=[ %-5p] - %c:%L - %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>Принято считать эти два способа равнозначными. При инициализации они ищутся в <strong>classpath</strong>, сначала <strong>xml-файл</strong>, потом <strong>properties-файл</strong>. Так что при наличии обоих рабочим будет именно <strong>xml</strong>.</p>
</div>
<div class="paragraph">
<p>Ниже приведен пример конфигурации <code>log4j.properties</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</code></pre>
</div>
</div>
<div class="paragraph">
<p>Эта строка говорит, что мы регистрируем <strong>appender</strong> <code>CONSOLE</code>, который использует реализацию <code>org.apache.log4j.ConsoleAppender</code>. Этот <strong>appender</strong> записывает данные в консоль.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.appender.FILE=org.apache.log4j.RollingFileAppender</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот <strong>appender</strong> записывает в файл.</p>
</div>
<div class="paragraph">
<p>Когда у нас уже есть зарегистрированные <strong>appenders</strong>, мы можем определить, какой будет уровень логирования в узлах и какие <strong>appenders</strong> будут при этом использоваться.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.rootLogger=DEBUG, CONSOLE, FILE</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>log4j.rootLogger</code> означает, что будем настраивать главный узел, в котором находятся все логи;</p>
</li>
<li>
<p>после знака равно первое слово говорит о том, с каким уровнем и выше будут записываться логи (в нашем случае это <code>DEBUG</code>);</p>
</li>
<li>
<p>далее после запятой указываются все <strong>appenders</strong>, которые будут использоваться.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Чтобы настроить определенный узел логирования, нужно использовать такую запись:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.logger.com.github.romankh3.logginglecture=TRACE, OWN, CONSOLE</code></pre>
</div>
</div>
<div class="paragraph">
<p>где <code>log4j.logger.</code> используется для настройки определенного узла, в нашем случае это <code>com.github.romankh3.logginglecture.</code>.</p>
</div>
<div class="paragraph">
<p>Настройка <code>CONSOLE</code> <strong>appender</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># CONSOLE appender customisation
log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender
log4j.appender.CONSOLE.threshold=DEBUG
log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout
log4j.appender.CONSOLE.layout.ConversionPattern=[%-5p] : %c:%L : %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь видно, что можно задать уровень, с которого будет обрабатывать именно <strong>appender</strong>. Реальная ситуация: сообщение с уровнем <strong>info</strong> принял узел логирования и передал <strong>appender</strong>, который к нему приписан, а вот уже <strong>appender</strong>, с уровнем <strong>warn</strong> и выше, лог этот принял, но ничего с ним не сделал.</p>
</div>
<div class="paragraph">
<p>Далее нужно определиться с тем, какой шаблон будет в сообщении (<strong>PatternLayout</strong>).</p>
</div>
<div class="paragraph">
<p>Пример настройки <code>FILE</code> <strong>appender</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># File appender customisation
log4j.appender.FILE=org.apache.log4j.RollingFileAppender
log4j.appender.FILE.File=./target/logging/logging.log
log4j.appender.FILE.MaxFileSize=1MB
log4j.appender.FILE.threshold=DEBUG
log4j.appender.FILE.MaxBackupIndex=2
log4j.appender.FILE.layout=org.apache.log4j.PatternLayout
log4j.appender.FILE.layout.ConversionPattern=[ %-5p] - %c:%L - %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь можно настроить, в какой именно файл будут записываться логи. Запись идет в файл <code>logging.log</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">log4j.appender.FILE.File=./target/logging/logging.log</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы не было проблем с размером файла, можно настроить максимальный: в данном случае — 1МБ.</p>
</div>
<div class="paragraph">
<p><code>MaxBackupIndex</code> — говорит о том, сколько будет таких файлов. Если создается больше этого числа, то первый файл будет удален.</p>
</div>
</div>
<div class="sect3">
<h4 id="_использование">Использование</h4>
<div class="paragraph">
<p>Чтобы использовать <code>Logger</code>, необходимо его создать:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(ClassName.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы сделать запись в лог, можно использовать множество методов, которые показывают, с каким уровнем будут записи.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">logger.trace("Method 1 started with argument={}", argument);
logger.debug("Database updated with script = {}", script);
logger.info("Application has started on port = {}", port);
logger.warn("Log4j didn't find log4j.properties.Please, provide them");
logger.error("Connection refused to host = {}", host);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Также можно использовать метод <code>log()</code> и передать в него параметры.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">logger.log(Level.INFO, argument);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_реализация_slf4jlog4j_2logback">Реализация (SLF4J/Log4J 2/Logback)</h3>
<div class="paragraph">
<p>На данный момент в <strong>Java</strong> наиболее популярные следующие библиотеки логирования:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>log4j 2</strong></p>
</li>
<li>
<p><strong>Logback</strong></p>
</li>
<li>
<p><strong>SLF4J</strong> (как фасад)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_system_err_println"><code>System.err.println()</code></h4>
<div class="paragraph">
<p>Первоначально был, разумеется, <code>System.err.println()</code> - выводит запись в консоль. Его и сейчас используют для быстрого получения лога при debugging.</p>
</div>
</div>
<div class="sect3">
<h4 id="_log4j_2">Log4j 2</h4>
<div class="paragraph">
<p>Для использования <strong>log4j2</strong> вам необходимо подключить библиотеки <code>log4j-api-2.x</code> и <code>log4j-core-2.x</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
        &lt;version&gt;${log4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
        &lt;version&gt;${log4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Logger создается вызовом статического метода класса <code>org.apache.logging.log4j.Logger</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Logger log = LogManager.getLogger(LoggingLog4j.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Logger умеет принимать помимо привычных нам <code>String</code>, <code>Object</code> и <code>Throwable</code> еще два новых типа — <code>MapMessage</code> и <code>Marker</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Карта сообщений (напечатается как msg1="Сообщение 1” msg2="Сообщение 2”)
MapMessage mapMessage = new MapMessage();
mapMessage.put("msg1", "Сообщение 1");
mapMessage.put("msg2", "Сообщение 2");
// Маркер, объект по которому можно фильтровать сообщения
Marker marker = MarkerManager.getMarker("fileonly");
// Строковое сообщение
String stringMessage = "Сообщение";
// Строковое сообщение с параметрами
String stringMessageFormat = "Сообщение {}, от {}";
// Исключение
Throwable throwable = new Throwable();
// Объект
Object object = new Object();</code></pre>
</div>
</div>
<div class="paragraph">
<p>В классическом для loggers стиле методы делятся на два типа:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>совпадающие с названием уровня логирования</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">log.info((marker, mapMessage, throwable);
log.throwing(throwable);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>методы <code>log</code>, принимающие уровень логирования в качестве параметра.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">log.log(Level.INFO, marker, stringMessage, throwable);
log.throwing(Level.INFO, throwable);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если не определить конфигурацию, то при запуске <strong>log4j2</strong> выдаст гневное сообщение, о том, что конфигурация не задана и будет печатать ваши сообщения на консоль уровнем не ниже <strong>ERROR</strong>. Конфигурация <strong>log4j2</strong> задается несколькими вариантами: <strong>xml</strong>, <strong>json</strong>, <strong>yaml</strong>. Файл с конфигурацией автоматически ищется <strong>classpath</strong>, должен иметь название <strong>log4j2</strong> и располагаться в пакете по умолчанию.</p>
</div>
<div class="paragraph">
<p>Конфигурация <strong>log4j2</strong> состоит из описания loggers, appenders и фильтров.</p>
</div>
<div class="paragraph">
<p>Фильтры позволяют оценивать события журнала, чтобы определить, следует ли их публиковать и каким образом. Фильтр будет вызван одним из своих методов фильтра и вернет <strong>Result</strong>, который представляет собой <strong>Enum</strong> имеющий одно из 3 значений:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ACCEPT</code></p>
</li>
<li>
<p><code>DENY</code></p>
</li>
<li>
<p><code>NEUTRAL</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Фильтры могут быть сконфигурированы в одном из четырех мест:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Контекстные фильтры</strong><br>
Настраиваются непосредственно в конфигурации. События, отклоняемые этими фильтрами, не будут передаваться регистраторам для дальнейшей обработки. После того как событие было принято контекстным фильтром, оно не будет оцениваться никакими другими контекстными фильтрами, а уровень регистратора не будет использоваться для фильтрации события. Однако событие будет оцениваться фильтрами <strong>Logger</strong> и <strong>Appender</strong>.</p>
</li>
<li>
<p><strong>Фильтры регистратора</strong><br>
Настраиваются на указанном регистраторе. Они оцениваются после контекстных фильтров и уровня журнала для регистратора. События, отклоненные этими фильтрами, будут отброшены, и событие не будет передано родительскому регистратору независимо от параметра аддитивности.</p>
</li>
<li>
<p><strong>Фильтры Appender</strong><br>
Используются для определения того, должен ли конкретный Appender обрабатывать форматирование и публикацию события.</p>
</li>
<li>
<p><strong>Ссылочные фильтры appender</strong><br>
Используются для определения того, должен ли регистратор направлять событие в приложение.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Есть различные фильтра, в том числе и по маркерам:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>BurstFilter</strong> - предоставляет механизм для управления скоростью обработки <strong>LogEvents</strong> путем автоматического отбрасывания событий после достижения максимального предела.</p>
</li>
<li>
<p><strong>CompositeFilter</strong> - предоставляет способ указать несколько фильтров. Он добавляется в конфигурацию в качестве элемента фильтров и содержит другие фильтры для оценки. Элемент <strong>filters</strong> не принимает никаких параметров.</p>
</li>
<li>
<p><strong>DynamicThresholdFilter</strong> - позволяет выполнять фильтрацию по уровню журнала на основе определенных атрибутов.</p>
</li>
<li>
<p><strong>MapFilter</strong> - позволяет фильтровать по элементам данных, которые находятся в MapMessage.</p>
</li>
<li>
<p><strong>MarkerFilter</strong> - сравнивает настроенное значение маркера с параметром маркера, включенным в <strong>LogEvent</strong>. Совпадение происходит, когда имя маркера совпадает с маркером события журнала или одним из его родителей.</p>
</li>
<li>
<p><strong>RegexFilter</strong> - позволяет сравнивать отформатированное или неформатированное сообщение с регулярным выражением.</p>
</li>
<li>
<p><strong>StructuredDataFilter</strong> - это <code>MapFilter</code>, который также позволяет фильтровать по идентификатору события, типу и сообщению.</p>
</li>
<li>
<p><strong>ThreadContextMapFilter</strong> - позволяет выполнять фильтрацию по элементам данных, которые находятся в сопоставлении <strong>ThreadContext</strong>.</p>
</li>
<li>
<p><strong>ThresholdFilter</strong> - возвращает результат <strong>onMatch</strong>, если уровень в <strong>LogEvent</strong> совпадает или более специфичным, чем настроенный уровень, а значение <strong>onMismatch</strong> в противном случае.</p>
</li>
<li>
<p><strong>TimeFilter</strong> - можно использовать для ограничения фильтра только определенной частью дня.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Имеется широкий круг классов appenders, в том числе асинхронные appenders и appenders оборачивающие группу других appenders.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AsyncAppender</strong> - принимает ссылки на другие приложения и заставляет <strong>LogEvents</strong> записываться на них в отдельном потоке.</p>
</li>
<li>
<p><strong>OutputStreamAppender</strong> - предоставляет основу для многих других приложений, таких как приложения <strong>File</strong> и <strong>Socket</strong>, которые записывают событие в выходной поток.</p>
</li>
<li>
<p><strong>ConsoleAppender</strong> - записывает свои выходные данные либо в <code>System.out</code>, либо в <code>System.err</code>, причем <code>System.out</code> является целевым объектом по умолчанию.</p>
</li>
<li>
<p><strong>FileAppender</strong> - это объект <code>OutputStreamAppender</code>, который записывает данные в файл, указанный в параметре fileName.</p>
</li>
<li>
<p><strong>JDBCAppender</strong> - записывает события журнала в таблицу реляционной базы данных с помощью стандартного <code>JDBC</code>.</p>
</li>
<li>
<p><strong>RollingFileAppender</strong> - это объект <code>OutputStreamAppender</code>, который записывает данные в файл, указанный в параметре <strong>fileName</strong>, и переворачивает файл в соответствии с параметрами <strong>TriggeringPolicy</strong> и <strong>RolloverPolicy</strong>.</p>
</li>
<li>
<p><strong>SocketAppender</strong> - это <code>OutputStreamAppender</code>, который записывает свои выходные данные в удаленное место назначения, указанное узлом и портом.</p>
</li>
<li>
<p>И другие.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Стоит также заметить, что <strong>log4j</strong> может создавать множество различающихся appenders одного и того же класса, например несколько файловых appenders, которые пишут в разные файлы. Рассмотрим пример конфигурации, в которой объявлены два logger:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>корневой - которых пишет в файл <code>log.log</code></p>
</li>
<li>
<p>для нашего класса - пишет в <code>log2.log</code> с использованием фильтрации по маркер.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Пример настройки конфигурации <code>log4j.xml</code> файла</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration&gt;
    &lt;!-- Секция appenders --&gt;
    &lt;Appenders&gt;
        &lt;!-- Файловый appender --&gt;
        &lt;File name="file" fileName="log.log"&gt;
            &lt;PatternLayout&gt;
                &lt;Pattern&gt;%d %p %c{1.} [%t] %m %ex%n&lt;/Pattern&gt;
            &lt;/PatternLayout&gt;
        &lt;/File&gt;
        &lt;!-- Файловый appender --&gt;
        &lt;File name="file2" fileName="log2.log"&gt;
            &lt;!-- Фильтр по маркеру --&gt;
            &lt;MarkerFilter marker="fileonly" onMatch="DENY" onMismatch="ACCEPT"/&gt;
            &lt;PatternLayout&gt;
                &lt;Pattern&gt;%d %p %c{1.} [%t] %m %ex%n&lt;/Pattern&gt;
            &lt;/PatternLayout&gt;
        &lt;/File&gt;
    &lt;/Appenders&gt;
    &lt;!-- Секция loggers --&gt;
    &lt;Loggers&gt;
        &lt;!-- Корневой logger --&gt;
        &lt;Root level="trace"&gt;
            &lt;AppenderRef ref="file" level="DEBUG"/&gt;
        &lt;/Root&gt;
        &lt;!-- Logger нашего класса --&gt;
        &lt;Logger name="logging.log4j.LoggingLog4j" level="info" additivity="false"&gt;
            &lt;AppenderRef ref="file2" level="INFO"/&gt;
        &lt;/Logger&gt;
    &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_logback">Logback</h4>
<div class="paragraph">
<p>Данный фреймворк используется только в связке с оберткой <strong>SLF4J</strong>.</p>
</div>
<div class="paragraph">
<p>Добавляется следующей зависимостью:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
    &lt;version&gt;1.2.6&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(LoggingLogback.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>API позволяет выводить строковые сообщения, шаблоны строковых сообщений, исключения, а также использовать маркеры.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Строковое сообщение
String stringMessage = "Сообщение";
// Шаблон сообщения
String stringMessageFormat = "Сообщение {} {}";
// Ошибка
Throwable throwable = new Throwable();
// Маркер
Marker marker = MarkerFactory.getMarker("marker");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Конфигурация ищется в <strong>classpath</strong> в следующем порядке:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Пытается найти <code>logback.groovy</code></p>
</li>
<li>
<p>Иначе пытается найти <code>logback-test.xml</code></p>
</li>
<li>
<p>Иначе пытается найти <code>logback.xml</code></p>
</li>
<li>
<p>Иначе использует базовую конфигурацию — выводим сообщения на консоль</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Основными элементами конфигурации являются loggers, appenders, layout, и фильтры.</p>
</div>
<div class="paragraph">
<p><strong>Logback-classic</strong> предлагает два типа фильтров:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>обычные фильтры</p>
</li>
<li>
<p>турбофильтры</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Имеются следующие фильтры:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Regular filters</strong></p>
</li>
<li>
<p><strong>LevelFilter</strong> - фильтрует события на основе точного соответствия уровней.</p>
</li>
<li>
<p><strong>ThresholdFilter</strong> - фильтрует события ниже указанного порогового значения.</p>
</li>
<li>
<p><strong>EvaluatorFilter</strong> - это универсальный фильтр, инкапсулирующий. Как следует из названия, <strong>EventEvaluator</strong> оценивает, соответствует ли заданный критерий для данного события.</p>
</li>
<li>
<p><strong>Matchers</strong></p>
</li>
<li>
<p><strong>CountingFilter</strong></p>
</li>
<li>
<p><strong>TurboFilters</strong> - предназначены для высокопроизводительной фильтрации регистрирования событий еще до их создания.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Имеются следующие appenders:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OutputStreamAppender</strong></p>
</li>
<li>
<p><strong>ConsoleAppender</strong></p>
</li>
<li>
<p><strong>FileAppender</strong></p>
</li>
<li>
<p><strong>RollingFileAppender</strong></p>
</li>
<li>
<p><strong>SocketAppender</strong> и <strong>SSLSocketAppender</strong></p>
</li>
<li>
<p><strong>ServerSocketAppender</strong> и <strong>SSLServerSocketAppender</strong></p>
</li>
<li>
<p><strong>SMTPAppender</strong></p>
</li>
<li>
<p><strong>SyslogAppender</strong></p>
</li>
<li>
<p><strong>SiftingAppender</strong></p>
</li>
<li>
<p><strong>AsyncAppender</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Encoders</strong> (кодировщики) отвечают за преобразование входящего события в массив байтов и запись результирующего массива байтов в соответствующий массив. Таким образом, кодировщики имеют полный контроль над тем, что и когда записываются в <strong>appender</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Layouts</strong>  — это компоненты, отвечающие за преобразование входящего события в строку. Метод в интерфейсе <strong>Layout</strong> принимает объект, представляющий событие (любого типа), и возвращает объект <code>String</code>.</p>
</div>
<div class="listingblock">
<div class="title">Простой пример файла <code>logback.xml</code>:</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;!--Аппендеры --&gt;
    &lt;!--Файловый appender --&gt;
    &lt;appender name="file" class="ch.qos.logback.core.FileAppender"&gt;
        &lt;file&gt;log.log&lt;/file&gt;
        &lt;layout class="ch.qos.logback.classic.PatternLayout"&gt;
            &lt;Pattern&gt;%date %level [%thread] %logger{10} [%file:%line] %msg%n&lt;/Pattern&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;!--Консольный appender --&gt;
    &lt;appender name="sout" class="ch.qos.logback.core.ConsoleAppender"&gt;
        &lt;layout class="ch.qos.logback.classic.PatternLayout"&gt;
            &lt;Pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/Pattern&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;!-- Фильтры --&gt;
    &lt;!-- Фильтр по маркеру --&gt;
    &lt;turboFilter class="ch.qos.logback.classic.turbo.MarkerFilter"&gt;
        &lt;Marker&gt;marker&lt;/Marker&gt;
        &lt;OnMatch&gt;DENY&lt;/OnMatch&gt;
    &lt;/turboFilter&gt;
    &lt;!-- Loggers --&gt;
    &lt;!-- Корневой logger --&gt;
    &lt;root level="info"&gt;
        &lt;appender-ref ref="file" /&gt;
    &lt;/root&gt;
    &lt;!-- Logger нашего класса --&gt;
    &lt;logger name="logging.logback.LoggingLogback" level="info" &gt;
        &lt;appender-ref ref="sout" /&gt;
    &lt;/logger&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_slf4j">SLF4J</h4>
<div class="paragraph">
<p><strong>SLF4J</strong> является оберткой над <strong>logback</strong>, а также над <strong>JUL</strong>, <strong>log4j</strong>, или <strong>JCL</strong>, а также над любым logger, который реализует ее интерфейс. Для работы с <strong>SLF4J</strong> нужны библиотека <code>slf4j-api-1.x.x</code> и реализация одного из loggers либо заглушка. Как правило, реализации всех loggers (кроме <strong>logback</strong>) поставляются вместе с SLF4J и имеют названия на подобии <code>slf4j-jcl-1.x</code>, <code>slf4j-log4j12-1.x</code>, <code>slf4j-nop-1.x</code> и т.п. Если в <strong>classpath</strong> не будет найдена реализация logger (или заглушка <strong>nop</strong>) <strong>SLF4J</strong> гневно ругнется и работать откажется. Конфигурация соответственно будет искаться в зависимости от положенной в <strong>classpath</strong> реализации.</p>
</div>
<div class="paragraph">
<p>Вся обертка делится на две части:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>API</strong><br>
Используется приложениями</p>
</li>
<li>
<p><strong>Реализация logger</strong>
Представлена отдельными jar-файлами для каждого вида логирования. Такие реализации для <strong>slf4j</strong> называются <strong>binding</strong>. Например, <code>slf4j-log4j12</code> или <code>logback-classic</code>. Достаточно только положить в <strong>CLASSPATH</strong> нужный <strong>binding</strong> и весь код проекта и все используемые библиотеки (при условии, что они обращаются к <strong>SLF4J</strong>) будут выполнять logging в нужном направлении.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>API SLF4J</strong> было рассмотрено в реализации <strong>logback</strong>.</p>
</div>
<div class="paragraph">
<p>Чтобы использовать <strong>SLF4J</strong> вместе с <strong>log4j 2</strong> необходимо подключить зависимость:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_links_3">Links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://javarush.ru/groups/posts/2388-logirovanie-chto-kak-gde-i-chem">Логирование: что, как, где и чем?</a></p>
</li>
<li>
<p><a href="https://javarush.ru/groups/posts/2293-zachem-nuzhno-logirovanie">Зачем нужно логирование</a></p>
</li>
<li>
<p><a href="https://javarush.ru/quests/lectures/questcollections.level04.lecture09">Logger</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/113145/">Java Logging: история кошмара</a></p>
</li>
<li>
<p><a href="https://habr.com/ru/post/247647/">Java logging. Hello World</a></p>
</li>
<li>
<p><a href="https://github.com/qcha/JBook/blob/master/other/logging.md">Логирование в Java</a></p>
</li>
<li>
<p><a href="https://codernet.ru/articles/drugoe/logirovanie_java_terminologiya_urovni_logirovaniya_log-fajlyi/">Логирование Java: терминология, уровни логирования, log-файлы</a></p>
</li>
<li>
<p><a href="https://coderlessons.com/tutorials/java-tekhnologii/vyuchi-slf4j/slf4j-kratkoe-rukovodstvo">SLF4J — Краткое руководство</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=j-i3NQiKbcc&amp;t=2052s&amp;ab_channel=JUG.ru">Владимир Красильщик — Что надо знать о логировании прагматичному Java-программисту</a></p>
</li>
<li>
<p><a href="http://logging.apache.org/log4j/2.x/">Apache Log4j 2</a></p>
</li>
<li>
<p><a href="http://logback.qos.ch/">Logback</a></p>
</li>
<li>
<p><a href="http://www.slf4j.org//">Simple Logging Facade for Java (SLF4J)</a></p>
</li>
<li>
<p><a href="http://skipy.ru/useful/logging.html#log4j_fa">Ведение лога приложения</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-12-04 06:19:22 UTC
</div>
</div>
</body>
</html>